import{r as i,j as e,u as S,M as E,C as A,s as x}from"./index-Da96yiop.js";const D=({courses:n,onAdd:g,onEdit:p,onDelete:f})=>{const[m,c]=i.useState(""),[l,s]=i.useState(""),u=d=>{d.preventDefault(),m.trim()&&(g(m),c(""))},t=n.filter(d=>d.name.toLowerCase().includes(l.toLowerCase()));return e.jsxs("div",{className:"bg-white dark:bg-darkcard shadow rounded-lg p-4 sm:p-6 border border-gray-200 dark:border-gray-700 h-full flex flex-col",children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:["üìö Cursos",e.jsx("span",{className:"bg-indigo-100 text-indigo-800 text-xs px-2 py-0.5 rounded-full dark:bg-indigo-900/30 dark:text-indigo-300",children:n.length})]}),e.jsxs("form",{onSubmit:u,className:"flex gap-2 mb-4",children:[e.jsx("input",{type:"text",placeholder:"Novo Curso...",className:"flex-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm py-2 px-3 focus:ring-primary focus:border-primary bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm",value:m,onChange:d=>c(d.target.value)}),e.jsx("button",{type:"submit",disabled:!m.trim(),className:"bg-primary text-white px-4 py-2 rounded-md hover:bg-indigo-700 font-medium text-sm disabled:opacity-50",children:"Adicionar"})]}),e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Filtrar cursos...",className:"w-full border border-gray-300 dark:border-gray-600 rounded-md py-1.5 px-3 bg-gray-50 dark:bg-gray-900/50 text-gray-900 dark:text-white text-xs",value:l,onChange:d=>s(d.target.value)})}),e.jsx("div",{className:"flex-1 overflow-y-auto min-h-[300px] pr-1 space-y-2",children:t.length===0?e.jsx("p",{className:"text-center text-gray-400 text-sm py-8",children:"Nenhum curso encontrado."}):t.map(d=>e.jsxs("div",{className:"group border border-gray-100 dark:border-gray-700 rounded-md p-3 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsx("span",{className:"font-medium text-gray-800 dark:text-gray-200 text-sm",children:d.name}),e.jsxs("div",{className:"flex space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>p(d.id,d.name),className:"text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/30 p-1.5 rounded",title:"Editar",children:"‚úèÔ∏è"}),e.jsx("button",{onClick:()=>f(d.id),className:"text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/30 p-1.5 rounded",title:"Excluir",children:"üóëÔ∏è"})]})]},d.id))})]})},T=({classes:n,courses:g,onAdd:p,onEdit:f,onDelete:m})=>{const[c,l]=i.useState(""),[s,u]=i.useState(""),[t,d]=i.useState(""),v=r=>{r.preventDefault(),c.trim()&&s&&(p(s,c),l(""))},b=i.useMemo(()=>{let r=n;return t&&(r=r.filter(y=>y.courseId===t)),r},[n,t]),h=r=>{var y;return((y=g.find(j=>j.id===r))==null?void 0:y.name)||"N/A"};return e.jsxs("div",{className:"bg-white dark:bg-darkcard shadow rounded-lg p-4 sm:p-6 border border-gray-200 dark:border-gray-700 h-full flex flex-col",children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:["üéì Turmas",e.jsx("span",{className:"bg-emerald-100 text-emerald-800 text-xs px-2 py-0.5 rounded-full dark:bg-emerald-900/30 dark:text-emerald-300",children:n.length})]}),e.jsxs("form",{onSubmit:v,className:"flex flex-col gap-2 mb-4 p-3 bg-gray-50 dark:bg-gray-800/50 rounded-md border border-gray-200 dark:border-gray-700",children:[e.jsxs("select",{className:"w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm py-1.5 px-3 focus:ring-primary focus:border-primary bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm",value:s,onChange:r=>u(r.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Vincular ao Curso..."}),g.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"Nome (ex: 2024-A)",className:"flex-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm py-1.5 px-3 focus:ring-primary focus:border-primary bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm",value:c,onChange:r=>l(r.target.value),required:!0}),e.jsx("button",{type:"submit",className:"bg-secondary text-white px-3 py-1.5 rounded-md hover:bg-emerald-700 font-medium text-sm",children:"+"})]})]}),e.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500 uppercase font-bold",children:"Filtro:"}),e.jsxs("select",{className:"flex-1 border border-gray-300 dark:border-gray-600 rounded-md py-1 px-2 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-xs",value:t,onChange:r=>d(r.target.value),children:[e.jsx("option",{value:"",children:"Todas as Turmas"}),g.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto min-h-[300px] pr-1 space-y-2",children:b.length===0?e.jsx("p",{className:"text-center text-gray-400 text-sm py-8",children:"Nenhuma turma encontrada."}):b.map(r=>e.jsx("div",{className:"group border border-gray-100 dark:border-gray-700 rounded-md p-3 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-gray-800 dark:text-gray-200 text-sm",children:r.name}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:h(r.courseId)})]}),e.jsxs("div",{className:"flex space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>f(r.id,r.name),className:"text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/30 p-1 rounded",children:"‚úèÔ∏è"}),e.jsx("button",{onClick:()=>m(r.id),className:"text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/30 p-1 rounded",children:"üóëÔ∏è"})]})]})},r.id))})]})},I=()=>{const[n,g]=i.useState([]),[p,f]=i.useState([]),[m,c]=i.useState(!1),{addToast:l}=S(),[s,u]=i.useState(null),[t,d]=i.useState(null),[v,b]=i.useState(!1),h=async()=>{c(!0);const[a,o]=await Promise.all([x.getCourses(),x.getClasses()]);g(a),f(o),c(!1)};i.useEffect(()=>{h()},[]);const r=async a=>{try{await x.addCourse(a),l("success","Curso adicionado."),h()}catch{l("error","Erro ao adicionar curso.")}},y=async(a,o)=>{try{await x.addClass(a,o),l("success","Turma adicionada."),h()}catch{l("error","Erro ao adicionar turma.")}},j=(a,o,N)=>{u({type:a,id:o,name:N})},k=(a,o)=>{d({type:a,id:o})},w=async()=>{if(t){b(!0);try{t.type==="course"?await x.deleteCourse(t.id):await x.deleteClass(t.id),l("success","Item removido com sucesso."),d(null),h()}catch{l("error","Erro ao remover item.")}finally{b(!1)}}},C=async a=>{if(a.preventDefault(),!(!s||!s.name)){b(!0);try{s.type==="course"?await x.updateCourse(s.id,s.name):await x.updateClass(s.id,s.name),l("success","Atualizado com sucesso."),u(null),h()}catch{l("error","Erro ao atualizar.")}finally{b(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Gest√£o Acad√™mica"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Gerencie a estrutura de cursos e turmas da institui√ß√£o."})]})}),m?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 animate-pulse",children:[e.jsx("div",{className:"h-64 bg-gray-200 dark:bg-gray-800 rounded-lg"}),e.jsx("div",{className:"h-64 bg-gray-200 dark:bg-gray-800 rounded-lg"})]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[e.jsx(D,{courses:n,onAdd:r,onEdit:(a,o)=>j("course",a,o),onDelete:a=>k("course",a)}),e.jsx(T,{classes:p,courses:n,onAdd:y,onEdit:(a,o)=>j("class",a,o),onDelete:a=>k("class",a)})]}),e.jsx(E,{isOpen:!!s,onClose:()=>u(null),title:(s==null?void 0:s.type)==="course"?"Editar Curso":"Editar Turma",children:e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Nome"}),e.jsx("input",{type:"text",className:"w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm py-2 px-3 focus:ring-primary focus:border-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-white",value:(s==null?void 0:s.name)||"",onChange:a=>u(o=>o?{...o,name:a.target.value}:null),required:!0,autoFocus:!0})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>u(null),className:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:v,className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-indigo-700 disabled:opacity-50",children:v?"Salvando...":"Salvar"})]})]})}),e.jsx(A,{isOpen:!!t,onClose:()=>d(null),onConfirm:w,title:"Confirmar Exclus√£o",message:e.jsxs("div",{children:[e.jsxs("p",{className:"text-gray-700 dark:text-gray-300",children:["Tem certeza que deseja excluir ",(t==null?void 0:t.type)==="course"?"este curso":"esta turma","?"]}),(t==null?void 0:t.type)==="course"&&e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 font-bold mt-3 bg-red-50 dark:bg-red-900/20 p-2 rounded border border-red-100 dark:border-red-900/30",children:"‚ö†Ô∏è Aten√ß√£o Cr√≠tica: Excluir um curso remover√° permanentemente todas as turmas e desvincular√° todos os alunos associados a ele."})]}),isProcessing:v})]})};export{I as AdminCourses};
