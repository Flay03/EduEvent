const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AdminEvents-BzTiGQSf.js","assets/react-vendor-D50s_Cdy.js","assets/vendor-CM3Ti3st.js","assets/qr-utils-B8AONaXL.js","assets/firebase-VtiSgn-P.js","assets/AdminUsers-miXlvd_b.js","assets/AdminCourses-BmGe6fv-.js","assets/AdminEventEnrollments-BDc05iQl.js","assets/xlsx-SQR8kOWN.js","assets/AdminScanner-DZvNYzhM.js","assets/DevTools-D-kQhvVm.js"])))=>i.map(i=>d[i]);
import{r as p,j as e,L as $,u as Ne,a as Fe,R as ie,b as st,c as Et,Q as St,H as It,d as Ct,e as K,N as Se,f as Tt}from"./react-vendor-D50s_Cdy.js";import{i as At,g as Mt,a as Lt,b as Dt,c as Rt,s as Qe,d as Ke,e as Ot,G as Pt,f as Ut,h as L,j as de,k as $t,o as Ft,l as U,q as F,w as P,m as q,n as rt,p as ae,r as ge,t as qt,u as je,v as Oe,x as fe,y as Pe,z as _t,A as at,B as zt,C as nt,D as he}from"./firebase-VtiSgn-P.js";import"./vendor-CM3Ti3st.js";import"./qr-utils-B8AONaXL.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function s(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(a){if(a.ep)return;a.ep=!0;const n=s(a);fetch(a.href,n)}})();const Bt="modulepreload",Vt=function(o){return"/EduEvent/"+o},Ye={},pe=function(t,s,r){let a=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),d=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(s.map(l=>{if(l=Vt(l),l in Ye)return;Ye[l]=!0;const c=l.endsWith(".css"),m=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${m}`))return;const u=document.createElement("link");if(u.rel=c?"stylesheet":Bt,c||(u.as="script"),u.crossOrigin="",u.href=l,d&&u.setAttribute("nonce",d),document.head.appendChild(u),c)return new Promise((g,x)=>{u.addEventListener("load",g),u.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${l}`)))})}))}function n(i){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=i,window.dispatchEvent(d),!d.defaultPrevented)throw i}return a.then(i=>{for(const d of i||[])d.status==="rejected"&&n(d.reason);return t().catch(n)})};var H=(o=>(o.ADMIN="admin",o.USER="user",o))(H||{}),J=(o=>(o.CONFIRMED="confirmed",o.CANCELED="canceled",o.WAITLIST="waitlist",o))(J||{});const X=o=>{if(!o)return"";if(o.match(/^\d{4}-\d{2}-\d{2}$/)){const[t,s,r]=o.split("-");return`${r}/${s}/${t}`}try{const t=new Date(o);return isNaN(t.getTime())?o:new Intl.DateTimeFormat("pt-BR").format(t)}catch{return o}},Xe=o=>{if(!o)return"";try{let t;if(o.match(/^\d{4}-\d{2}-\d{2}$/)){const[s,r,a]=o.split("-").map(Number);t=new Date(s,r-1,a)}else t=new Date(o);return isNaN(t.getTime())?o:new Intl.DateTimeFormat("pt-BR",{weekday:"short",day:"2-digit",month:"2-digit"}).format(t)}catch{return o}},Re={},Wt=o=>o&&o.apiKey&&o.projectId&&o.appId,Ze={apiKey:"AIzaSyBOUAqkPhqFhsIkZVh97OJau-SzQug1PBE",authDomain:"eduevent-e50f4.firebaseapp.com",projectId:"eduevent-e50f4",storageBucket:"eduevent-e50f4.appspot.com",messagingSenderId:"964945250582",appId:"1:964945250582:web:3ce9fcdad019132561a837",measurementId:"G-KCLHFXEEML",vapidKey:(Re==null?void 0:Re.VITE_FIREBASE_VAPID_KEY)||""},se={useFirebase:Wt(Ze),firebase:Ze},Ie=se.firebase;let Ee,W,f,et;const it=o=>o&&o.apiKey&&o.projectId&&o.appId,Gt=async()=>{if("serviceWorker"in navigator&&it(Ie))try{const t=`/EduEvent/firebase-messaging-sw.js?${new URLSearchParams(Ie).toString()}`;return await navigator.serviceWorker.register(t,{scope:"/EduEvent/"})}catch(o){console.error("Service Worker registration failed:",o)}};try{se.useFirebase&&it(Ie)?(Ee=At(Ie),W=Mt(Ee),f=Lt(Ee),typeof window<"u"&&Gt().then(o=>{try{et=Dt(Ee),o&&se.firebase.vapidKey&&Rt(et,{vapidKey:se.firebase.vapidKey,serviceWorkerRegistration:o}).catch(t=>console.log("Push token flow needs user interaction.")),console.log("Firebase Messaging initialized.")}catch(t){console.warn("Failed to initialize Firebase Messaging:",t)}}),console.log("Firebase initialized successfully.")):se.useFirebase?console.warn("Firebase `useFirebase` is true, but config keys are missing. Please check your .env.local file. Skipping Firebase Init."):console.log("`useFirebase` is false. Skipping Firebase Init.")}catch(o){console.error("Error initializing Firebase:",o)}class Ht{mapAuthError(t){switch(t){case"auth/invalid-credential":case"auth/user-not-found":case"auth/wrong-password":return"E-mail ou senha incorretos.";case"auth/email-already-in-use":return"Este e-mail jÃ¡ estÃ¡ em uso.";case"auth/weak-password":return"A senha Ã© muito fraca.";case"auth/invalid-email":return"E-mail invÃ¡lido.";case"auth/popup-closed-by-user":return"Login cancelado.";default:return"Erro na autenticaÃ§Ã£o. Tente novamente."}}async login(t,s){if(!W)throw new Error("ServiÃ§o de autenticaÃ§Ã£o nÃ£o inicializado.");if(!s)throw new Error("A senha Ã© obrigatÃ³ria.");try{await Qe(W,Ke);const r=await Ot(W,t,s);return this._fetchUserProfile(r.user)}catch(r){throw console.error("Erro no Login Firebase:",r),new Error(this.mapAuthError(r.code))}}async loginWithGoogle(){if(!W)throw new Error("ServiÃ§o de autenticaÃ§Ã£o nÃ£o inicializado.");try{await Qe(W,Ke);const t=new Pt;await Ut(W,t)}catch(t){throw console.error("Erro ao iniciar Login com Google:",t),new Error(this.mapAuthError(t.code))}}async _fetchUserProfile(t){if(!f)throw new Error("Banco de dados nÃ£o inicializado.");const s=L(f,"users",t.uid);let r;try{r=await de(s)}catch(a){if(console.error("Erro ao acessar Firestore:",a),a.code==="permission-denied")return{uid:t.uid,email:t.email||"",role:H.USER,isOnboarded:!1};throw new Error("Erro de conexÃ£o ao buscar perfil do usuÃ¡rio.")}if(r.exists()){const a=r.data();return{uid:t.uid,email:t.email||"",name:a.name||t.displayName,role:a.role||H.USER,rm:a.rm,courseId:a.courseId,classId:a.classId,isOnboarded:a.isOnboarded||!1}}else return{uid:t.uid,email:t.email||"",name:t.displayName||"",role:H.USER,isOnboarded:!1}}async logout(){W&&await $t(W)}onAuthStateChanged(t){return W?Ft(W,async s=>{if(s)try{const r=await this._fetchUserProfile(s);t(r)}catch{t({uid:s.uid,email:s.email||"",role:H.USER,isOnboarded:!1})}else t(null)}):(console.warn("Firebase Auth not initialized correctly. Defaulting to logged out state."),t(null),()=>{})}async updateUserProfile(t,s){if(!f)throw new Error("Banco de dados nÃ£o inicializado.");if(s.rm)try{const n=U(f,"users"),i=F(n,P("rm","==",s.rm));if((await q(i)).docs.find(c=>c.id!==t))throw new Error("Este RM jÃ¡ estÃ¡ cadastrado para outro usuÃ¡rio.")}catch(n){if(n.code!=="permission-denied")throw n}const r=L(f,"users",t),a={...s,updatedAt:new Date().toISOString()};s.name&&s.rm&&(a.isOnboarded=!0);try{await rt(r,a,{merge:!0})}catch{throw new Error("NÃ£o foi possÃ­vel salvar seus dados.")}return{...s,uid:t,email:"",role:H.USER,isOnboarded:!0}}async getUserProfile(t){if(!f)throw new Error("ServiÃ§o nÃ£o inicializado.");try{const s=L(f,"users",t),r=await de(s);if(r.exists()){const a=r.data();return{uid:t,email:a.email||"",name:a.name||"UsuÃ¡rio",role:a.role||H.USER,rm:a.rm,courseId:a.courseId,classId:a.classId,isOnboarded:a.isOnboarded}}}catch{console.warn(`Could not fetch profile for ${t} from DB.`)}return W&&W.currentUser&&W.currentUser.uid===t?this._fetchUserProfile(W.currentUser):null}async getUsers(t){if(!f)return{data:[],nextCursor:void 0};const{limit:s,cursor:r,filters:a}=t,{searchTerm:n,role:i,courseId:d,classId:l}=a;try{const c=[ae("email"),ge(s)];i&&c.push(P("role","==",i)),d&&c.push(P("courseId","==",d)),l&&c.push(P("classId","==",l)),r&&c.push(qt(r));const m=F(U(f,"users"),...c),u=await q(m);let g=u.docs.map(w=>({uid:w.id,...w.data()}));if(n){const w=n.toLowerCase();g=g.filter(v=>{var k,y;return((k=v.name)==null?void 0:k.toLowerCase().includes(w))||v.email.toLowerCase().includes(w)||((y=v.rm)==null?void 0:y.includes(w))})}const x=u.docs.length===s?u.docs[u.docs.length-1]:void 0;return{data:g,nextCursor:x}}catch(c){return console.error("Erro ao buscar usuÃ¡rios:",c),c.code==="failed-precondition"&&console.warn("Falta Ã­ndice composto. Crie no link do console."),{data:[],nextCursor:void 0}}}async deleteUser(t){if(!f)return;const s=je(f),r=F(U(f,"enrollments"),P("userId","==",t)),n=(await q(r)).docs.map(g=>({id:g.id,...g.data()})),i=Array.from(new Set(n.map(g=>g.eventId))),l=await(async g=>{const x=[];for(let w=0;w<g.length;w+=30){const v=g.slice(w,w+30),k=F(U(f,"events"),P(at(),"in",v)),y=await q(k);x.push(...y.docs.map(S=>({id:S.id,...S.data()})))}return x})(i),c=new Map(l.map(g=>[g.id,g]));n.forEach(g=>{if(g.status===J.CONFIRMED){const x=c.get(g.eventId);if(x){const w=x.sessions.findIndex(v=>v.id===g.sessionId);if(w!==-1&&x.sessions[w].filled>0){const v=[...x.sessions];v[w]={...v[w],filled:Math.max(0,v[w].filled-1)},x.sessions=v,s.update(L(f,"events",x.id),{sessions:v})}}}s.delete(L(f,"enrollments",g.id))});const m=F(U(f,"teams"),P("members","array-contains",t));(await q(m)).forEach(g=>{g.data().captainId===t?s.delete(g.ref):s.update(g.ref,{members:Oe(t)})}),s.delete(L(f,"users",t)),await s.commit()}async updateUserRole(t,s){f&&await fe(L(f,"users",t),{role:s})}}class Jt{async getCourses(){return f?(await q(U(f,"courses"))).docs.map(s=>({id:s.id,...s.data()})):[]}async addCourse(t){if(!f)throw new Error("DB not init");return{id:(await Pe(U(f,"courses"),{name:t})).id,name:t}}async updateCourse(t,s){f&&await fe(L(f,"courses",t),{name:s})}async deleteCourse(t){if(!f)return;const s=je(f);s.delete(L(f,"courses",t));const r=F(U(f,"classes"),P("courseId","==",t));(await q(r)).forEach(d=>s.delete(d.ref));const n=F(U(f,"users"),P("courseId","==",t));(await q(n)).forEach(d=>s.update(d.ref,{courseId:""})),await s.commit()}async getClasses(t){if(!f)return[];let s=t?F(U(f,"classes"),P("courseId","==",t)):U(f,"classes");return(await q(s)).docs.map(a=>({id:a.id,...a.data()}))}async addClass(t,s){if(!f)throw new Error("DB not init");return{id:(await Pe(U(f,"classes"),{courseId:t,name:s})).id,courseId:t,name:s}}async updateClass(t,s){f&&await fe(L(f,"classes",t),{name:s})}async deleteClass(t){if(!f)return;const s=je(f);await _t(L(f,"classes",t));const r=F(U(f,"users"),P("classId","==",t));(await q(r)).forEach(n=>s.update(n.ref,{classId:""})),await s.commit()}async getEvents(t){if(!f)return{data:[],nextCursor:void 0};const{limit:s,cursor:r,filters:a}=t,{searchTerm:n,visibility:i,course:d}=a,l=50;try{const c=F(U(f,"events"),ae("createdAt","desc"),ge(l)),u=(await q(c)).docs.map(y=>({id:y.id,...y.data()}));let g=[];i==="class"&&d&&(g=(await q(U(f,"classes"))).docs.map(S=>({id:S.id,...S.data()})));const x=u.filter(y=>{var E,C;const S=n?y.name.toLowerCase().includes(n.toLowerCase())||y.description.toLowerCase().includes(n.toLowerCase()):!0,j=i?y.visibility===i:!0;let T=!0;return d&&(y.visibility==="public"?T=!1:y.visibility==="course"?T=((E=y.allowedCourses)==null?void 0:E.includes(d))||!1:y.visibility==="class"&&(g.length>0?T=((C=y.allowedClasses)==null?void 0:C.some(A=>{const N=g.find(M=>M.id===A);return(N==null?void 0:N.courseId)===d}))||!1:T=!1)),S&&j&&T}),w=typeof r=="number"?r:0,v=x.slice(w,w+s),k=w+v.length<x.length?w+v.length:void 0;return{data:v,nextCursor:k}}catch{return{data:[],nextCursor:void 0}}}async getEventById(t){if(!f)return;const s=L(f,"events",t),r=await de(s);return r.exists()?{id:r.id,...r.data()}:void 0}async getEventsByIds(t){if(!f||t.length===0)return[];const s=30,r=[];for(let a=0;a<t.length;a+=s){const n=t.slice(a,a+s),i=F(U(f,"events"),P(at(),"in",n)),d=await q(i);r.push(...d.docs.map(l=>({id:l.id,...l.data()})))}return r}async getEventsByParentId(t){if(!f)return[];const s=F(U(f,"events"),P("parentId","==",t));return(await q(s)).docs.map(a=>({id:a.id,...a.data()}))}async getAvailableEventsForUser(t){if(!f)return[];try{const s=U(f,"events"),r=ge(50),n=[F(s,P("visibility","==","public"),ae("createdAt","desc"),r)];if(t.courseId){const l=F(s,P("allowedCourses","array-contains",t.courseId),ae("createdAt","desc"),r);n.push(l)}if(t.classId){const l=F(s,P("allowedClasses","array-contains",t.classId),ae("createdAt","desc"),r);n.push(l)}const i=await Promise.all(n.map(l=>q(l).catch(c=>(console.warn("Query falhou (verifique Ã­ndices):",c.message),{docs:[]})))),d=new Map;return i.forEach(l=>{l.docs.forEach(c=>{d.has(c.id)||d.set(c.id,{id:c.id,...c.data()})})}),Array.from(d.values()).sort((l,c)=>(c.createdAt||"").localeCompare(l.createdAt||""))}catch(s){return console.error("Erro crÃ­tico ao buscar eventos:",s),[]}}async getPublicEvents(){if(!f)return[];const t=F(U(f,"events"),P("visibility","==","public"),ae("createdAt","desc"),ge(10));return(await q(t)).docs.map(r=>({id:r.id,...r.data()}))}async createEvent(t){if(!f)return;const{id:s,...r}=t;await rt(L(f,"events",s),JSON.parse(JSON.stringify(r)))}async updateEvent(t){if(!f)return;const{id:s,...r}=t;await fe(L(f,"events",s),JSON.parse(JSON.stringify(r)))}async deleteEvent(t){if(!f)return;const s=je(f),r=[t],a=F(U(f,"events"),P("parentId","==",t));(await q(a)).forEach(l=>r.push(l.id));const i=[],d=[];for(let l=0;l<r.length;l+=10)d.push(r.slice(l,l+10));for(const l of d){const c=F(U(f,"enrollments"),P("eventId","in",l));(await q(c)).forEach(x=>i.push(x.ref));const u=F(U(f,"teams"),P("eventId","in",l));(await q(u)).forEach(x=>s.delete(x.ref))}r.forEach(l=>s.delete(L(f,"events",l))),i.forEach(l=>s.delete(l)),await s.commit()}}class Qt{constructor(t,s){this.notificationService=t,this.eventService=s}async getTeamsForEvent(t){if(!f)return[];const s=F(U(f,"teams"),P("eventId","==",t));return(await q(s)).docs.map(a=>({id:a.id,...a.data()}))}async createTeam(t,s,r){if(!f)throw new Error("DB not init");const a=Math.random().toString(36).substring(2,6).toUpperCase(),n=`Equipe #${Math.floor(Math.random()*1e3)}`,i=`team_${Date.now()}`,d={id:i,eventId:t,sessionId:s,name:n,code:a,captainId:r.uid,members:[r.uid],createdAt:new Date().toISOString()};return await he(f,async l=>{const c=L(f,"events",t),m=await l.get(c);if(!m.exists())throw new Error("Evento nÃ£o encontrado.");const u=`${r.uid}_${t}`,g=L(f,"enrollments",u),x=await l.get(g);if(x.exists()&&x.data().status===J.CONFIRMED)throw new Error("VocÃª jÃ¡ estÃ¡ inscrito neste evento.");const w=m.data(),v=w.sessions.findIndex(S=>S.id===s);if(v===-1)throw new Error("SessÃ£o invÃ¡lida.");if(w.sessions[v].filled>=w.sessions[v].capacity)throw new Error("A sessÃ£o estÃ¡ lotada (limite de equipes atingido).");const k=[...w.sessions];k[v]={...k[v],filled:k[v].filled+1},l.update(c,{sessions:k}),l.set(g,{userId:r.uid,eventId:t,sessionId:s,teamId:i,status:J.CONFIRMED,enrolledAt:new Date().toISOString(),attended:!1});const y=L(f,"teams",i);l.set(y,d)}),d}async joinTeam(t,s,r){if(!f)throw new Error("DB not init");const a=L(f,"teams",t);await he(f,async n=>{const i=await n.get(a);if(!i.exists())throw new Error("Equipe nÃ£o encontrada.");const d=i.data();if(d.code!==r)throw new Error("CÃ³digo da equipe invÃ¡lido.");if(d.members.includes(s.uid))throw new Error("VocÃª jÃ¡ faz parte desta equipe.");const l=`${s.uid}_${d.eventId}`,c=L(f,"enrollments",l),m=await n.get(c);if(m.exists()&&m.data().status===J.CONFIRMED)throw new Error("VocÃª jÃ¡ estÃ¡ inscrito neste evento.");n.set(c,{userId:s.uid,eventId:d.eventId,sessionId:d.sessionId,teamId:t,status:J.CONFIRMED,enrolledAt:new Date().toISOString(),attended:!1}),n.update(a,{members:nt(s.uid)})});try{const n=await de(a);if(n.exists()){const i=n.data();i.captainId!==s.uid&&await this.notificationService.createNotification({userId:i.captainId,title:"Novo membro na equipe! ðŸ›¡ï¸",message:`${s.name||"Um usuÃ¡rio"} entrou na sua equipe ${i.name}.`,type:"success",createdAt:new Date().toISOString(),read:!1,link:`/event/${i.eventId}`})}}catch(n){console.error("Error creating notification",n)}}async leaveTeam(t,s){if(!f||!W||!W.currentUser)return;const r=W.currentUser.uid,a=L(f,"teams",t);let n=null,i=null,d=!1,l=!1;try{const c=await de(L(f,"users",s));c.exists()&&(i=c.data())}catch{}if(await he(f,async c=>{const m=await c.get(a);if(!m.exists())throw new Error("Equipe nÃ£o encontrada.");n=m.data();const u=L(f,"events",n.eventId),g=await c.get(u);if(n.captainId===s){d=!0;for(const x of n.members){const w=`${x}_${n.eventId}`,v=L(f,"enrollments",w);c.delete(v)}if(g.exists()){const x=g.data(),w=x.sessions.findIndex(v=>v.id===n.sessionId);if(w!==-1){const v=[...x.sessions];v[w].filled=Math.max(0,v[w].filled-1),c.update(u,{sessions:v})}}c.delete(a)}else{r!==s&&(l=!0),c.update(a,{members:Oe(s)});const x=`${s}_${n.eventId}`,w=L(f,"enrollments",x);c.delete(w)}}),n){const c=n.name,m=(i==null?void 0:i.name)||"Um membro";if(d){const u=n.members.filter(g=>g!==(n==null?void 0:n.captainId));for(const g of u)await this.notificationService.createNotification({userId:g,title:"Equipe Desfeita âš ï¸",message:`A equipe "${c}" foi desfeita pelo capitÃ£o. Sua inscriÃ§Ã£o foi cancelada.`,type:"warning",read:!1,createdAt:new Date().toISOString(),link:"/dashboard"})}else l?await this.notificationService.createNotification({userId:s,title:"Removido da Equipe ðŸš«",message:`VocÃª foi removido da equipe "${c}" pelo capitÃ£o.`,type:"warning",read:!1,createdAt:new Date().toISOString(),link:"/dashboard"}):n.captainId!==s&&await this.notificationService.createNotification({userId:n.captainId,title:"Membro Saiu ðŸƒ",message:`${m} saiu da sua equipe "${c}".`,type:"info",read:!1,createdAt:new Date().toISOString(),link:`/event/${n.eventId}`})}}async kickMember(t,s){return this.leaveTeam(t,s)}async getEnrollmentsForUser(t){if(!f)return[];try{const s=F(U(f,"enrollments"),P("userId","==",t));return(await q(s)).docs.map(n=>({id:n.id,...n.data()})).filter(n=>n.status!==J.CANCELED)}catch(s){return console.error("Error fetching enrollments",s),[]}}async getUserEnrollmentsDetails(t){if(!f)return[];try{const s=F(U(f,"enrollments"),P("userId","==",t),P("status","==",J.CONFIRMED)),a=(await q(s)).docs.map(l=>({id:l.id,...l.data()}));if(a.length===0)return[];const n=Array.from(new Set(a.map(l=>l.eventId))),i=await this.eventService.getEventsByIds(n),d=new Map(i.map(l=>[l.id,l]));return a.map(l=>{const c=d.get(l.eventId);if(!c)return null;const m=c.sessions.find(u=>u.id===l.sessionId);return m?{enrollmentId:l.id,eventName:c.name,eventLocation:c.location,sessionDate:m.date,sessionTime:`${m.startTime} - ${m.endTime}`,enrolledAt:l.enrolledAt}:null}).filter(Boolean)}catch{return[]}}async getEnrichedEnrollments(t){if(!f)return[];const s=F(U(f,"enrollments"),P("eventId","==",t),P("status","==",J.CONFIRMED)),a=(await q(s)).docs.map(c=>({id:c.id,...c.data()}));if(a.length===0)return[];const n=a.map(c=>de(L(f,"users",c.userId))),d=(await Promise.all(n)).map(c=>c.exists()?{uid:c.id,...c.data()}:null),l=await this.eventService.getEventById(t);return l?a.map((c,m)=>{const u=d[m],g=l.sessions.find(x=>x.id===c.sessionId);return{id:c.id,user:{uid:(u==null?void 0:u.uid)||c.userId,name:(u==null?void 0:u.name)||"Desconhecido",email:(u==null?void 0:u.email)||"",rm:(u==null?void 0:u.rm)||"",courseId:u==null?void 0:u.courseId,classId:u==null?void 0:u.classId},session:{id:g.id,date:g.date,startTime:g.startTime,endTime:g.endTime},status:c.status,enrolledAt:c.enrolledAt,teamId:c.teamId,attended:c.attended,checkInAt:c.checkInAt}}):[]}async getEnrollmentDetailsForEvent(t){return(await this.getEnrichedEnrollments(t)).map(r=>({Nome:r.user.name,Email:r.user.email,RM:r.user.rm,SessaoData:X(r.session.date),SessaoHora:`${r.session.startTime}`,Status:r.status,DataInscricao:new Date(r.enrolledAt).toLocaleString("pt-BR"),Presenca:r.attended?"Sim":"NÃ£o"}))}async createEnrollment(t,s,r,a=!1){if(!f)throw new Error("DB not init");const n=await de(L(f,"events",s));if(!n.exists())throw new Error("Evento nÃ£o encontrado");const d=n.data().sessions.find(x=>x.id===r);if(!d)throw new Error("SessÃ£o nÃ£o encontrada");const l=F(U(f,"enrollments"),P("userId","==",t),P("status","==",J.CONFIRMED)),m=(await q(l)).docs.map(x=>x.data());if(m.some(x=>x.eventId===s))throw new Error("VocÃª jÃ¡ estÃ¡ inscrito neste evento");if(m.length>0){const x=[...new Set(m.map(v=>v.eventId))],w=await this.eventService.getEventsByIds(x);for(const v of m){const k=w.find(S=>S.id===v.eventId),y=k==null?void 0:k.sessions.find(S=>S.id===v.sessionId);if(k&&y&&y.date===d.date&&d.startTime<y.endTime&&d.endTime>y.startTime)throw new Error(`CONFLICT|${k.name}|${y.startTime}|${y.endTime}`)}}const u=`enr_${Date.now()}_${t}`,g={id:u,userId:t,eventId:s,sessionId:r,status:J.CONFIRMED,enrolledAt:new Date().toISOString(),attended:!1};return await he(f,async x=>{const w=L(f,"events",s),v=await x.get(w);if(!v.exists())throw new Error("Evento nÃ£o encontrado");const k=v.data(),y=k.sessions.findIndex(j=>j.id===r);if(y===-1)throw new Error("SessÃ£o nÃ£o encontrada");if(!a){if(k.sessions[y].filled>=k.sessions[y].capacity)throw new Error("A sessÃ£o estÃ¡ lotada");const j=[...k.sessions];j[y].filled+=1,x.update(w,{sessions:j})}const S=L(f,"enrollments",u);x.set(S,g)}),g}async cancelEnrollment(t){if(!f||!W||!W.currentUser)return;const s=W.currentUser.uid;let r=null,a="um evento";await he(f,async n=>{const i=L(f,"enrollments",t),d=await n.get(i);if(!d.exists())throw new Error("InscriÃ§Ã£o nÃ£o encontrada");r=d.data();const l=L(f,"events",r.eventId),c=await n.get(l);let m=null,u=null;r.teamId&&(m=L(f,"teams",r.teamId),u=await n.get(m));let g=!0;if(r.teamId&&u&&u.exists()&&(u.data().captainId===r.userId?(n.delete(m),g=!0):(n.update(m,{members:Oe(r.userId)}),g=!1)),c.exists()){const x=c.data();if(a=x.name,g){const w=x.sessions.findIndex(v=>v.id===r.sessionId);if(w!==-1){const v=[...x.sessions];v[w].filled=Math.max(0,v[w].filled-1),n.update(l,{sessions:v})}}}n.delete(i)}),r&&r.userId!==s&&await this.notificationService.createNotification({userId:r.userId,title:"InscriÃ§Ã£o Cancelada âš ï¸",message:`Sua inscriÃ§Ã£o no evento "${a}" foi cancelada pela administraÃ§Ã£o.`,type:"warning",read:!1,createdAt:new Date().toISOString(),link:"/dashboard"})}async markAttendance(t){if(!f)throw new Error("DB not init");return await he(f,async s=>{const r=L(f,"enrollments",t),a=await s.get(r);if(!a.exists())return{success:!1,message:"InscriÃ§Ã£o nÃ£o encontrada."};const n=a.data(),i=await s.get(L(f,"users",n.userId)),d=await s.get(L(f,"events",n.eventId)),l=i.exists()?i.data().name:"Desconhecido",c=d.exists()?d.data().name:"Evento";return n.attended?{success:!1,message:"Check-in jÃ¡ realizado anteriormente.",alreadyAttended:!0,userName:l,eventName:c}:(s.update(r,{attended:!0,checkInAt:new Date().toISOString()}),{success:!0,message:"Check-in realizado com sucesso!",userName:l,eventName:c})})}}class Kt{async getNotifications(t){if(!f)return[];const s=F(U(f,"notifications"),P("userId","==",t),ae("createdAt","desc"),ge(20));return(await q(s)).docs.map(a=>({id:a.id,...a.data()}))}subscribeToNotifications(t,s){if(!f)return()=>{};const r=F(U(f,"notifications"),P("userId","==",t),ae("createdAt","desc"),ge(20));return zt(r,n=>{const i=n.docs.map(d=>({id:d.id,...d.data()}));s(i)})}async markNotificationAsRead(t){f&&await fe(L(f,"notifications",t),{read:!0})}async markAllNotificationsAsRead(t){if(!f)return;const s=F(U(f,"notifications"),P("userId","==",t),P("read","==",!1)),r=await q(s),a=je(f);r.forEach(n=>a.update(n.ref,{read:!0})),await a.commit()}async createNotification(t){f&&await Pe(U(f,"notifications"),t)}async saveDeviceToken(t,s){if(!f)return;const r=L(f,"users",t);await fe(r,{pushTokens:nt(s)})}}class Yt{async resetAndSeedData(){console.log("Reset not supported in Firebase from client.")}async exportData(){return"{}"}async importData(t){}}class Xt{constructor(){this.authService=new Ht,this.eventService=new Jt,this.notificationService=new Kt,this.enrollmentService=new Qt(this.notificationService,this.eventService),this.devService=new Yt}login(t,s){return this.authService.login(t,s)}loginWithGoogle(){return this.authService.loginWithGoogle()}logout(){return this.authService.logout()}onAuthStateChanged(t){return this.authService.onAuthStateChanged(t)}updateUserProfile(t,s){return this.authService.updateUserProfile(t,s)}getUserProfile(t){return this.authService.getUserProfile(t)}getUsers(t){return this.authService.getUsers(t)}deleteUser(t){return this.authService.deleteUser(t)}updateUserRole(t,s){return this.authService.updateUserRole(t,s)}getCourses(){return this.eventService.getCourses()}addCourse(t){return this.eventService.addCourse(t)}updateCourse(t,s){return this.eventService.updateCourse(t,s)}deleteCourse(t){return this.eventService.deleteCourse(t)}getClasses(t){return this.eventService.getClasses(t)}addClass(t,s){return this.eventService.addClass(t,s)}updateClass(t,s){return this.eventService.updateClass(t,s)}deleteClass(t){return this.eventService.deleteClass(t)}getEvents(t){return this.eventService.getEvents(t)}getEventById(t){return this.eventService.getEventById(t)}getEventsByIds(t){return this.eventService.getEventsByIds(t)}getAvailableEventsForUser(t){return this.eventService.getAvailableEventsForUser(t)}getPublicEvents(){return this.eventService.getPublicEvents()}getEventsByParentId(t){return this.eventService.getEventsByParentId(t)}createEvent(t){return this.eventService.createEvent(t)}updateEvent(t){return this.eventService.updateEvent(t)}deleteEvent(t){return this.eventService.deleteEvent(t)}getTeamsForEvent(t){return this.enrollmentService.getTeamsForEvent(t)}createTeam(t,s,r){return this.enrollmentService.createTeam(t,s,r)}joinTeam(t,s,r){return this.enrollmentService.joinTeam(t,s,r)}leaveTeam(t,s){return this.enrollmentService.leaveTeam(t,s)}kickMember(t,s){return this.enrollmentService.kickMember(t,s)}getEnrollmentsForUser(t){return this.enrollmentService.getEnrollmentsForUser(t)}getUserEnrollmentsDetails(t){return this.enrollmentService.getUserEnrollmentsDetails(t)}getEnrichedEnrollments(t){return this.enrollmentService.getEnrichedEnrollments(t)}getEnrollmentDetailsForEvent(t){return this.enrollmentService.getEnrollmentDetailsForEvent(t)}createEnrollment(t,s,r,a){return this.enrollmentService.createEnrollment(t,s,r,a)}cancelEnrollment(t){return this.enrollmentService.cancelEnrollment(t)}markAttendance(t){return this.enrollmentService.markAttendance(t)}getNotifications(t){return this.notificationService.getNotifications(t)}subscribeToNotifications(t,s){return this.notificationService.subscribeToNotifications(t,s)}markNotificationAsRead(t){return this.notificationService.markNotificationAsRead(t)}markAllNotificationsAsRead(t){return this.notificationService.markAllNotificationsAsRead(t)}createNotification(t){return this.notificationService.createNotification(t)}saveDeviceToken(t,s){return this.notificationService.saveDeviceToken(t,s)}resetAndSeedData(){return this.devService.resetAndSeedData()}exportData(){return this.devService.exportData()}importData(t){return this.devService.importData(t)}}const Zt=[{id:"c1",name:"CiÃªncia da ComputaÃ§Ã£o"},{id:"c2",name:"Design Digital"},{id:"c3",name:"AdministraÃ§Ã£o"}],es=[{id:"t1",courseId:"c1",name:"CC-2024-A"},{id:"t2",courseId:"c1",name:"CC-2024-B"},{id:"t3",courseId:"c2",name:"DD-2024-A"},{id:"t4",courseId:"c3",name:"ADM-2024-A"}],h={USERS:"eduevent_users",EVENTS:"eduevent_events",ENROLLMENTS:"eduevent_enrollments",TEAMS:"eduevent_teams",NOTIFICATIONS:"eduevent_notifications",CURRENT_USER:"eduevent_current_user",COURSES:"eduevent_courses",CLASSES:"eduevent_classes"},z=o=>new Promise(t=>setTimeout(t,o));class ke{getItems(t){const s=localStorage.getItem(t);return s?JSON.parse(s):[]}saveItems(t,s){localStorage.setItem(t,JSON.stringify(s))}addItem(t,s){const r=this.getItems(t);r.push(s),this.saveItems(t,r)}}class Ue extends ke{constructor(){super(...arguments),this.authListeners=[]}notifyAuthListeners(t){this.authListeners.forEach(s=>s(t))}async login(t,s){await z(500);let a=this.getItems(h.USERS).find(n=>n.email===t);return a||(a={uid:`user_${Date.now()}`,email:t,role:t.includes("admin")?H.ADMIN:H.USER,isOnboarded:!1},this.addItem(h.USERS,a)),localStorage.setItem(h.CURRENT_USER,JSON.stringify(a)),this.notifyAuthListeners(a),a}async loginWithGoogle(){await z(800);const t="google.mock@example.com";let r=this.getItems(h.USERS).find(a=>a.email===t);r||(r={uid:`user_google_${Date.now()}`,email:t,name:"Google Mock User",role:H.USER,isOnboarded:!1},this.addItem(h.USERS,r)),localStorage.setItem(h.CURRENT_USER,JSON.stringify(r)),this.notifyAuthListeners(r)}async logout(){localStorage.removeItem(h.CURRENT_USER),this.notifyAuthListeners(null)}onAuthStateChanged(t){this.authListeners.push(t);const s=localStorage.getItem(h.CURRENT_USER),r=s?JSON.parse(s):null;return t(r),()=>{this.authListeners=this.authListeners.filter(a=>a!==t)}}async updateUserProfile(t,s){await z(600);const r=this.getItems(h.USERS),a=r.findIndex(l=>l.uid===t);if(a===-1)throw new Error("UsuÃ¡rio nÃ£o encontrado");if(s.rm&&r.some(c=>c.rm===s.rm&&c.uid!==t))throw new Error("Este RM jÃ¡ estÃ¡ cadastrado para outro usuÃ¡rio.");const n={...r[a],...s,isOnboarded:!0};r[a]=n,this.saveItems(h.USERS,r);const i=localStorage.getItem(h.CURRENT_USER),d=i?JSON.parse(i):null;return d&&d.uid===t&&(localStorage.setItem(h.CURRENT_USER,JSON.stringify(n)),this.notifyAuthListeners(n)),n}async getUserProfile(t){return await z(100),this.getItems(h.USERS).find(a=>a.uid===t)||null}async getUsers(t){await z(500);const s=this.getItems(h.USERS),{searchTerm:r,role:a,courseId:n,classId:i}=t.filters,d=s.filter(u=>{var k,y;const g=r?((k=u.name)==null?void 0:k.toLowerCase().includes(r.toLowerCase()))||u.email.toLowerCase().includes(r.toLowerCase())||((y=u.rm)==null?void 0:y.includes(r)):!0,x=a?u.role===a:!0,w=n?u.courseId===n:!0,v=i?u.classId===i:!0;return g&&x&&w&&v}),l=t.cursor||0,c=d.slice(l,l+t.limit),m=l+c.length;return{data:c,nextCursor:m<d.length?m:void 0}}async deleteUser(t){await z(500);let s=this.getItems(h.USERS);s=s.filter(r=>r.uid!==t),this.saveItems(h.USERS,s)}async updateUserRole(t,s){await z(300);const r=this.getItems(h.USERS),a=r.findIndex(n=>n.uid===t);a!==-1&&(r[a].role=s,this.saveItems(h.USERS,r))}}class $e extends ke{constructor(){super(),localStorage.getItem(h.COURSES)||localStorage.setItem(h.COURSES,JSON.stringify(Zt)),localStorage.getItem(h.CLASSES)||localStorage.setItem(h.CLASSES,JSON.stringify(es))}async getCourses(){return this.getItems(h.COURSES)}async addCourse(t){const s=this.getItems(h.COURSES),r={id:`c_${Date.now()}`,name:t};return s.push(r),this.saveItems(h.COURSES,s),r}async updateCourse(t,s){const r=this.getItems(h.COURSES),a=r.findIndex(n=>n.id===t);a!==-1&&(r[a].name=s,this.saveItems(h.COURSES,r))}async deleteCourse(t){let s=this.getItems(h.COURSES);s=s.filter(a=>a.id!==t),this.saveItems(h.COURSES,s);let r=this.getItems(h.CLASSES);r=r.filter(a=>a.courseId!==t),this.saveItems(h.CLASSES,r)}async getClasses(t){const s=this.getItems(h.CLASSES);return t?s.filter(r=>r.courseId===t):s}async addClass(t,s){const r=this.getItems(h.CLASSES),a={id:`t_${Date.now()}`,courseId:t,name:s};return r.push(a),this.saveItems(h.CLASSES,r),a}async updateClass(t,s){const r=this.getItems(h.CLASSES),a=r.findIndex(n=>n.id===t);a!==-1&&(r[a].name=s,this.saveItems(h.CLASSES,r))}async deleteClass(t){let s=this.getItems(h.CLASSES);s=s.filter(r=>r.id!==t),this.saveItems(h.CLASSES,s)}async getEvents(t){await z(400);const s=this.getItems(h.EVENTS),{searchTerm:r,visibility:a,course:n}=t.filters,i=this.getItems(h.CLASSES),d=s.filter(u=>{var v,k;const g=r?u.name.toLowerCase().includes(r.toLowerCase())||u.description.toLowerCase().includes(r.toLowerCase()):!0,x=a?u.visibility===a:!0;let w=!0;return n&&(u.visibility==="public"?w=!1:u.visibility==="course"?w=((v=u.allowedCourses)==null?void 0:v.includes(n))||!1:u.visibility==="class"&&(w=((k=u.allowedClasses)==null?void 0:k.some(y=>{const S=i.find(j=>j.id===y);return(S==null?void 0:S.courseId)===n}))||!1)),g&&x&&w}),l=t.cursor||0,c=d.slice(l,l+t.limit),m=l+c.length;return{data:c,nextCursor:m<d.length?m:void 0}}async getEventById(t){return await z(200),this.getItems(h.EVENTS).find(r=>r.id===t)}async getEventsByIds(t){return await z(200),this.getItems(h.EVENTS).filter(r=>t.includes(r.id))}async getEventsByParentId(t){return await z(200),this.getItems(h.EVENTS).filter(r=>r.parentId===t)}async getAvailableEventsForUser(t){return await z(400),this.getItems(h.EVENTS).filter(r=>{var a,n;return r.visibility==="public"?!0:r.visibility==="course"?t.courseId?(a=r.allowedCourses)==null?void 0:a.includes(t.courseId):!1:r.visibility==="class"&&t.classId?(n=r.allowedClasses)==null?void 0:n.includes(t.classId):!1})}async getPublicEvents(){return await z(400),this.getItems(h.EVENTS).filter(s=>s.visibility==="public")}async createEvent(t){await z(600),this.addItem(h.EVENTS,t)}async updateEvent(t){await z(500);const s=this.getItems(h.EVENTS),r=s.findIndex(a=>a.id===t.id);if(r!==-1)s[r]=t,this.saveItems(h.EVENTS,s);else throw new Error("Evento nÃ£o encontrado para atualizaÃ§Ã£o")}async deleteEvent(t){await z(400);let s=this.getItems(h.EVENTS);const r=s.filter(i=>i.id===t||i.parentId===t).map(i=>i.id);s=s.filter(i=>!r.includes(i.id)),this.saveItems(h.EVENTS,s);let a=this.getItems(h.ENROLLMENTS);a=a.filter(i=>!r.includes(i.eventId)),this.saveItems(h.ENROLLMENTS,a);let n=this.getItems(h.TEAMS);n=n.filter(i=>!r.includes(i.eventId)),this.saveItems(h.TEAMS,n)}}class ts extends ke{constructor(t){super(),this.notificationService=t}async getTeamsForEvent(t){return await z(300),this.getItems(h.TEAMS).filter(r=>r.eventId===t)}async createTeam(t,s,r){await z(500);const a=this.getItems(h.EVENTS),n=a.findIndex(v=>v.id===t);if(n===-1)throw new Error("Evento nÃ£o encontrado.");const i=a[n].sessions.findIndex(v=>v.id===s);if(i===-1)throw new Error("SessÃ£o nÃ£o encontrada.");const d=a[n].sessions[i];if(d.filled>=d.capacity)throw new Error("A sessÃ£o estÃ¡ lotada.");const l=this.getItems(h.TEAMS),c=`team_${Date.now()}`,m=Math.random().toString(36).substring(2,6).toUpperCase(),u=`Equipe #${Math.floor(Math.random()*1e3)}`,g={id:c,eventId:t,sessionId:s,name:u,code:m,captainId:r.uid,members:[r.uid],createdAt:new Date().toISOString()};await this.createEnrollment(r.uid,t,s,!0);const x=this.getItems(h.ENROLLMENTS),w=x.findIndex(v=>v.userId===r.uid&&v.eventId===t);return w!==-1&&(x[w].teamId=c,this.saveItems(h.ENROLLMENTS,x)),a[n].sessions[i].filled+=1,this.saveItems(h.EVENTS,a),l.push(g),this.saveItems(h.TEAMS,l),g}async joinTeam(t,s,r){await z(500);const a=this.getItems(h.TEAMS),n=a.findIndex(l=>l.id===t);if(n===-1)throw new Error("Equipe nÃ£o encontrada.");if(a[n].code!==r)throw new Error("CÃ³digo de equipe invÃ¡lido.");if(a[n].members.includes(s.uid))throw new Error("VocÃª jÃ¡ faz parte desta equipe.");await this.createEnrollment(s.uid,a[n].eventId,a[n].sessionId,!0);const i=this.getItems(h.ENROLLMENTS),d=i.findIndex(l=>l.userId===s.uid&&l.eventId===a[n].eventId);d!==-1&&(i[d].teamId=t,this.saveItems(h.ENROLLMENTS,i)),a[n].members.push(s.uid),this.saveItems(h.TEAMS,a),await this.notificationService.createNotification({userId:a[n].captainId,title:"Novo membro na equipe! ðŸ›¡ï¸",message:`${s.name||"Um usuÃ¡rio"} entrou na sua equipe ${a[n].name}.`,type:"success",createdAt:new Date().toISOString(),read:!1,link:`/event/${a[n].eventId}`})}async leaveTeam(t,s){var u;await z(500);const r=this.getItems(h.TEAMS),a=r.findIndex(g=>g.id===t);if(a===-1)throw new Error("Equipe nÃ£o encontrada.");const n=r[a],i=this.getItems(h.EVENTS),d=i.findIndex(g=>g.id===n.eventId),l=localStorage.getItem(h.CURRENT_USER),c=l?JSON.parse(l):null,m=c==null?void 0:c.uid;if(n.captainId===s){for(const g of n.members){const w=this.getItems(h.ENROLLMENTS).find(v=>v.userId===g&&v.eventId===n.eventId);w&&await this.cancelEnrollment(w.id),g!==s&&await this.notificationService.createNotification({userId:g,title:"Equipe Desfeita âš ï¸",message:`A equipe "${n.name}" foi desfeita pelo capitÃ£o. Sua inscriÃ§Ã£o foi cancelada.`,type:"warning",read:!1,createdAt:new Date().toISOString(),link:"/dashboard"})}if(r.splice(a,1),d!==-1){const g=i[d].sessions.findIndex(x=>x.id===n.sessionId);g!==-1&&(i[d].sessions[g].filled=Math.max(0,i[d].sessions[g].filled-1),this.saveItems(h.EVENTS,i))}}else{n.members=n.members.filter(k=>k!==s);const x=this.getItems(h.ENROLLMENTS).find(k=>k.userId===s&&k.eventId===n.eventId);x&&await this.cancelEnrollment(x.id);const v=((u=this.getItems(h.USERS).find(k=>k.uid===s))==null?void 0:u.name)||"Um membro";m!==s?await this.notificationService.createNotification({userId:s,title:"Removido da Equipe ðŸš«",message:`VocÃª foi removido da equipe "${n.name}" pelo capitÃ£o.`,type:"warning",read:!1,createdAt:new Date().toISOString(),link:"/dashboard"}):await this.notificationService.createNotification({userId:n.captainId,title:"Membro Saiu ðŸƒ",message:`${v} saiu da sua equipe "${n.name}".`,type:"info",read:!1,createdAt:new Date().toISOString(),link:`/event/${n.eventId}`})}this.saveItems(h.TEAMS,r)}async kickMember(t,s){return this.leaveTeam(t,s)}async getEnrollmentsForUser(t){return await z(300),this.getItems(h.ENROLLMENTS).filter(r=>r.userId===t&&r.status!==J.CANCELED)}async getUserEnrollmentsDetails(t){const s=this.getItems(h.ENROLLMENTS).filter(a=>a.userId===t&&a.status===J.CONFIRMED),r=this.getItems(h.EVENTS);return s.map(a=>{const n=r.find(d=>d.id===a.eventId),i=n==null?void 0:n.sessions.find(d=>d.id===a.sessionId);return!n||!i?null:{enrollmentId:a.id,eventName:n.name,eventLocation:n.location,sessionDate:i.date,sessionTime:`${i.startTime} - ${i.endTime}`,enrolledAt:a.enrolledAt}}).filter(Boolean)}async getEnrichedEnrollments(t){const s=this.getItems(h.ENROLLMENTS).filter(n=>n.eventId===t&&n.status===J.CONFIRMED),r=this.getItems(h.USERS),a=this.getItems(h.EVENTS).find(n=>n.id===t);return s.map(n=>{const i=r.find(l=>l.uid===n.userId),d=a==null?void 0:a.sessions.find(l=>l.id===n.sessionId);return{id:n.id,user:{uid:i==null?void 0:i.uid,name:(i==null?void 0:i.name)||"Desconhecido",email:(i==null?void 0:i.email)||"",rm:(i==null?void 0:i.rm)||"",courseId:i==null?void 0:i.courseId,classId:i==null?void 0:i.classId},session:{id:d==null?void 0:d.id,date:d==null?void 0:d.date,startTime:d==null?void 0:d.startTime,endTime:d==null?void 0:d.endTime},status:n.status,enrolledAt:n.enrolledAt,teamId:n.teamId,attended:n.attended,checkInAt:n.checkInAt}})}async getEnrollmentDetailsForEvent(t){const s=this.getItems(h.ENROLLMENTS).filter(n=>n.eventId===t&&n.status===J.CONFIRMED),r=this.getItems(h.USERS),a=this.getItems(h.EVENTS).find(n=>n.id===t);return s.map(n=>{const i=r.find(l=>l.uid===n.userId),d=a==null?void 0:a.sessions.find(l=>l.id===n.sessionId);return{Nome:(i==null?void 0:i.name)||"Desconhecido",Email:(i==null?void 0:i.email)||"",RM:(i==null?void 0:i.rm)||"",SessaoData:X(d==null?void 0:d.date),SessaoHora:(d==null?void 0:d.startTime)||"",Status:n.status,DataInscricao:new Date(n.enrolledAt).toLocaleString("pt-BR"),Presenca:n.attended?"Sim":"NÃ£o"}})}async createEnrollment(t,s,r,a=!1){await z(800);const n=this.getItems(h.EVENTS),i=n.findIndex(x=>x.id===s);if(i===-1)throw new Error("Evento nÃ£o encontrado");const d=n[i].sessions.findIndex(x=>x.id===r);if(d===-1)throw new Error("SessÃ£o nÃ£o encontrada");const l=n[i].sessions[d];if(!a&&l.filled>=l.capacity)throw new Error("A sessÃ£o estÃ¡ lotada");const c=this.getItems(h.ENROLLMENTS),m=c.filter(x=>x.userId===t&&x.status===J.CONFIRMED);if(m.find(x=>x.eventId===s))throw new Error("VocÃª jÃ¡ estÃ¡ inscrito neste evento");for(const x of m){const w=n.find(k=>k.id===x.eventId),v=w==null?void 0:w.sessions.find(k=>k.id===x.sessionId);if(w&&v&&v.date===l.date&&l.startTime<v.endTime&&l.endTime>v.startTime)throw new Error(`CONFLICT|${w.name}|${v.startTime}|${v.endTime}`)}const g={id:`enr_${Date.now()}`,userId:t,eventId:s,sessionId:r,status:J.CONFIRMED,enrolledAt:new Date().toISOString(),attended:!1};return c.push(g),this.saveItems(h.ENROLLMENTS,c),a||(n[i].sessions[d].filled+=1,this.saveItems(h.EVENTS,n)),g}async cancelEnrollment(t){await z(500);const s=localStorage.getItem(h.CURRENT_USER),r=s?JSON.parse(s):null,a=r==null?void 0:r.uid,n=this.getItems(h.ENROLLMENTS),i=n.findIndex(c=>c.id===t);if(i===-1)throw new Error("InscriÃ§Ã£o nÃ£o encontrada");const d=n[i];let l=!0;if(d.teamId){const c=this.getItems(h.TEAMS),m=c.findIndex(u=>u.id===d.teamId);if(m!==-1){const u=c[m];u.members=u.members.filter(g=>g!==d.userId),u.captainId===d.userId?(c.splice(m,1),l=!0):l=!1,this.saveItems(h.TEAMS,c)}}if(l){const c=this.getItems(h.EVENTS),m=c.findIndex(u=>u.id===d.eventId);if(m!==-1){const u=c[m].sessions.findIndex(g=>g.id===d.sessionId);u!==-1&&(c[m].sessions[u].filled=Math.max(0,c[m].sessions[u].filled-1),this.saveItems(h.EVENTS,c))}}n.splice(i,1),this.saveItems(h.ENROLLMENTS,n),a&&d.userId!==a&&await this.notificationService.createNotification({userId:d.userId,title:"InscriÃ§Ã£o Cancelada âš ï¸",message:"Sua inscriÃ§Ã£o foi cancelada pela administraÃ§Ã£o.",type:"warning",read:!1,createdAt:new Date().toISOString(),link:"/dashboard"})}async markAttendance(t){await z(500);const s=this.getItems(h.ENROLLMENTS),r=s.findIndex(i=>i.id===t);if(r===-1)return{success:!1,message:"InscriÃ§Ã£o nÃ£o encontrada."};if(s[r].attended){const i=await new Ue().getUserProfile(s[r].userId),d=await new $e().getEventById(s[r].eventId);return{success:!1,message:"Check-in jÃ¡ realizado anteriormente.",alreadyAttended:!0,userName:(i==null?void 0:i.name)||"Desconhecido",eventName:(d==null?void 0:d.name)||"Evento"}}s[r].attended=!0,s[r].checkInAt=new Date().toISOString(),this.saveItems(h.ENROLLMENTS,s);const a=await new Ue().getUserProfile(s[r].userId),n=await new $e().getEventById(s[r].eventId);return{success:!0,message:"Check-in realizado com sucesso!",userName:a==null?void 0:a.name,eventName:n==null?void 0:n.name}}}class ss extends ke{async getNotifications(t){return this.getItems(h.NOTIFICATIONS).filter(r=>r.userId===t).sort((r,a)=>a.createdAt.localeCompare(r.createdAt))}subscribeToNotifications(t,s){s(this.getItems(h.NOTIFICATIONS).filter(a=>a.userId===t).sort((a,n)=>n.createdAt.localeCompare(a.createdAt)));const r=setInterval(()=>{const a=this.getItems(h.NOTIFICATIONS).filter(n=>n.userId===t).sort((n,i)=>i.createdAt.localeCompare(n.createdAt));s(a)},3e3);return()=>clearInterval(r)}async markNotificationAsRead(t){const s=this.getItems(h.NOTIFICATIONS),r=s.findIndex(a=>a.id===t);r!==-1&&(s[r].read=!0,this.saveItems(h.NOTIFICATIONS,s))}async markAllNotificationsAsRead(t){const s=this.getItems(h.NOTIFICATIONS);s.forEach(r=>{r.userId===t&&(r.read=!0)}),this.saveItems(h.NOTIFICATIONS,s)}async createNotification(t){const s=this.getItems(h.NOTIFICATIONS),r={...t,id:`notif_${Date.now()}`};s.push(r),this.saveItems(h.NOTIFICATIONS,s)}async saveDeviceToken(t,s){console.log(`[Mock] Saving device token for user ${t}: ${s}`)}}class rs extends ke{async resetAndSeedData(){localStorage.clear(),await z(500);const t=[{id:"c1",name:"CiÃªncia da ComputaÃ§Ã£o"},{id:"c2",name:"Direito"},{id:"c3",name:"Medicina"}];this.saveItems(h.COURSES,t);const s=[{id:"t1",courseId:"c1",name:"CC-2024-A"}];this.saveItems(h.CLASSES,s);const r=[{uid:"u_admin",email:"admin@school.com",name:"Admin",role:H.ADMIN,isOnboarded:!0}];this.saveItems(h.USERS,r)}async exportData(){const t={};return[h.USERS,h.EVENTS,h.ENROLLMENTS,h.COURSES,h.CLASSES,h.TEAMS,h.NOTIFICATIONS].forEach(r=>{t[r]=this.getItems(r)}),JSON.stringify(t,null,2)}async importData(t){try{const s=JSON.parse(t);localStorage.clear();const r={users:h.USERS,events:h.EVENTS,enrollments:h.ENROLLMENTS,courses:h.COURSES,classes:h.CLASSES,teams:h.TEAMS,notifications:h.NOTIFICATIONS,[h.TEAMS]:h.TEAMS};Object.keys(s).forEach(a=>{const n=r[a]||a;if(Array.isArray(s[a])){const i=s[a].map(d=>{const{_id:l,...c}=d;return c});this.saveItems(n,i)}})}catch{throw new Error("Formato de JSON invÃ¡lido.")}}}class as{constructor(){this.authService=new Ue,this.eventService=new $e,this.notificationService=new ss,this.enrollmentService=new ts(this.notificationService),this.devService=new rs}login(t,s){return this.authService.login(t,s)}loginWithGoogle(){return this.authService.loginWithGoogle()}logout(){return this.authService.logout()}onAuthStateChanged(t){return this.authService.onAuthStateChanged(t)}updateUserProfile(t,s){return this.authService.updateUserProfile(t,s)}getUserProfile(t){return this.authService.getUserProfile(t)}getUsers(t){return this.authService.getUsers(t)}deleteUser(t){return this.authService.deleteUser(t)}updateUserRole(t,s){return this.authService.updateUserRole(t,s)}getCourses(){return this.eventService.getCourses()}addCourse(t){return this.eventService.addCourse(t)}updateCourse(t,s){return this.eventService.updateCourse(t,s)}deleteCourse(t){return this.eventService.deleteCourse(t)}getClasses(t){return this.eventService.getClasses(t)}addClass(t,s){return this.eventService.addClass(t,s)}updateClass(t,s){return this.eventService.updateClass(t,s)}deleteClass(t){return this.eventService.deleteClass(t)}getEvents(t){return this.eventService.getEvents(t)}getEventById(t){return this.eventService.getEventById(t)}getEventsByIds(t){return this.eventService.getEventsByIds(t)}getAvailableEventsForUser(t){return this.eventService.getAvailableEventsForUser(t)}getPublicEvents(){return this.eventService.getPublicEvents()}getEventsByParentId(t){return this.eventService.getEventsByParentId(t)}createEvent(t){return this.eventService.createEvent(t)}updateEvent(t){return this.eventService.updateEvent(t)}deleteEvent(t){return this.eventService.deleteEvent(t)}getTeamsForEvent(t){return this.enrollmentService.getTeamsForEvent(t)}createTeam(t,s,r){return this.enrollmentService.createTeam(t,s,r)}joinTeam(t,s,r){return this.enrollmentService.joinTeam(t,s,r)}leaveTeam(t,s){return this.enrollmentService.leaveTeam(t,s)}kickMember(t,s){return this.enrollmentService.kickMember(t,s)}getEnrollmentsForUser(t){return this.enrollmentService.getEnrollmentsForUser(t)}getUserEnrollmentsDetails(t){return this.enrollmentService.getUserEnrollmentsDetails(t)}getEnrichedEnrollments(t){return this.enrollmentService.getEnrichedEnrollments(t)}getEnrollmentDetailsForEvent(t){return this.enrollmentService.getEnrollmentDetailsForEvent(t)}createEnrollment(t,s,r,a){return this.enrollmentService.createEnrollment(t,s,r,a)}cancelEnrollment(t){return this.enrollmentService.cancelEnrollment(t)}markAttendance(t){return this.enrollmentService.markAttendance(t)}getNotifications(t){return this.notificationService.getNotifications(t)}subscribeToNotifications(t,s){return this.notificationService.subscribeToNotifications(t,s)}markNotificationAsRead(t){return this.notificationService.markNotificationAsRead(t)}markAllNotificationsAsRead(t){return this.notificationService.markAllNotificationsAsRead(t)}createNotification(t){return this.notificationService.createNotification(t)}saveDeviceToken(t,s){return this.notificationService.saveDeviceToken(t,s)}resetAndSeedData(){return this.devService.resetAndSeedData()}exportData(){return this.devService.exportData()}importData(t){return this.devService.importData(t)}}const ns=()=>se.useFirebase?new Xt:new as,D=ns(),ot=p.createContext(void 0),is=({children:o})=>{const[t,s]=p.useState(null),[r,a]=p.useState(!0);p.useEffect(()=>{const c=D.onAuthStateChanged(m=>{s(m),a(!1)});return()=>c()},[]);const n=async(c,m)=>{a(!0);try{await D.login(c,m)}catch(u){throw console.error(u),a(!1),u}},i=async()=>{a(!0);try{await D.loginWithGoogle()}catch(c){throw console.error(c),a(!1),c}},d=async()=>{a(!0),await D.logout()},l=async()=>{if(t){a(!0);try{const c=await D.getUserProfile(t.uid);s(c)}catch(c){console.error("Falha ao atualizar o perfil",c)}finally{a(!1)}}};return e.jsx(ot.Provider,{value:{user:t,loading:r,login:n,loginWithGoogle:i,logout:d,refreshProfile:l},children:o})},re=()=>{const o=p.useContext(ot);if(!o)throw new Error("useAuth must be used within an AuthProvider");return o},dt=p.createContext(void 0),os=({children:o})=>{const[t,s]=p.useState([]),r=p.useCallback(n=>{s(i=>i.filter(d=>d.id!==n))},[]),a=p.useCallback((n,i)=>{const d=Math.random().toString(36).substr(2,9);s(l=>[...l,{id:d,type:n,message:i}]),setTimeout(()=>{r(d)},4e3)},[r]);return e.jsxs(dt.Provider,{value:{addToast:a,removeToast:r},children:[o,e.jsx("div",{className:"fixed bottom-4 right-4 z-[9999] flex flex-col gap-2 pointer-events-none",children:t.map(n=>e.jsxs("div",{className:`pointer-events-auto transform transition-all duration-300 ease-in-out translate-y-0 opacity-100 min-w-[300px] max-w-md p-4 rounded-lg shadow-lg border-l-4 flex items-start justify-between bg-white dark:bg-darkcard dark:border-gray-600
              ${n.type==="success"?"border-green-500":""}
              ${n.type==="error"?"border-red-500":""}
              ${n.type==="warning"?"border-amber-500":""}
              ${n.type==="info"?"border-blue-500":""}
            `,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("span",{className:"text-xl mr-3",children:[n.type==="success"&&"âœ…",n.type==="error"&&"âŒ",n.type==="warning"&&"âš ï¸",n.type==="info"&&"â„¹ï¸"]}),e.jsx("p",{className:"text-sm font-medium text-gray-800 dark:text-gray-200",children:n.message})]}),e.jsx("button",{onClick:()=>r(n.id),className:"ml-4 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 focus:outline-none",children:"Ã—"})]},n.id))})]})},ve=()=>{const o=p.useContext(dt);if(!o)throw new Error("useToast must be used within a ToastProvider");return o},lt=p.createContext(void 0),ds=({children:o})=>{const[t,s]=p.useState(()=>{const a=localStorage.getItem("eduevent_theme");return a==="dark"||a==="light"?a:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"});p.useEffect(()=>{const a=window.document.documentElement;t==="dark"?a.classList.add("dark"):a.classList.remove("dark"),localStorage.setItem("eduevent_theme",t)},[t]);const r=()=>{s(a=>a==="light"?"dark":"light")};return e.jsx(lt.Provider,{value:{theme:t,toggleTheme:r},children:o})},ls=()=>{const o=p.useContext(lt);if(!o)throw new Error("useTheme must be used within a ThemeProvider");return o},cs=()=>{const{user:o}=re(),[t,s]=p.useState([]),[r,a]=p.useState(0),[n,i]=p.useState(!1),[d,l]=p.useState(!0),[c,m]=p.useState(typeof Notification<"u"?Notification.permission:"denied"),u=p.useCallback(async()=>{if(!(typeof Notification>"u"))try{const v=await Notification.requestPermission();m(v),v==="granted"&&new Notification("EduEvent",{body:"NotificaÃ§Ãµes ativadas com sucesso!",icon:"https://cdn-icons-png.flaticon.com/512/2995/2995458.png"})}catch(v){console.error("Error requesting notification permission:",v)}},[]);p.useEffect(()=>{if(!o)return;const v=D.subscribeToNotifications(o.uid,k=>{if(k.length>0&&t.length>0){const y=k[0],S=t[0];y.id!==S.id&&!y.read&&Notification.permission==="granted"&&new Notification(y.title,{body:y.message,icon:"https://cdn-icons-png.flaticon.com/512/2995/2995458.png"})}s(k),a(k.filter(y=>!y.read).length),l(!1)});return()=>v()},[o]);const g=p.useCallback(async()=>{if(!o)return;const v=localStorage.getItem(`last_event_check_${o.uid}`),y=new Date().toISOString().split("T")[0];if(v!==y)try{const S=await D.getEnrollmentsForUser(o.uid);if(S.length===0)return;const j=[...new Set(S.map(A=>A.eventId))],T=await D.getEventsByIds(j),E=new Date;E.setDate(E.getDate()+1);const C=E.toISOString().split("T")[0];for(const A of S){const N=T.find(R=>R.id===A.eventId);if(!N)continue;const M=N.sessions.find(R=>R.id===A.sessionId);if(M&&(M.date===y||M.date===C)){const R=M.date===y,V=R?"Evento Hoje! ðŸ“…":"Evento AmanhÃ£! â³",B=`NÃ£o esqueÃ§a: "${N.name}" acontece ${R?"hoje":"amanhÃ£"} Ã s ${M.startTime}.`;t.some(me=>me.type==="reminder"&&me.message===B)||await D.createNotification({userId:o.uid,title:V,message:B,type:"reminder",read:!1,createdAt:new Date().toISOString(),link:`/event/${N.id}`})}}localStorage.setItem(`last_event_check_${o.uid}`,y)}catch(S){console.error("Error checking upcoming events",S)}},[o,t]);return p.useEffect(()=>{g()},[g]),{notifications:t,unreadCount:r,isOpen:n,setIsOpen:i,markAsRead:async v=>{s(k=>k.map(y=>y.id===v?{...y,read:!0}:y)),a(k=>Math.max(0,k-1)),await D.markNotificationAsRead(v)},markAllAsRead:async()=>{o&&(s(v=>v.map(k=>({...k,read:!0}))),a(0),await D.markAllNotificationsAsRead(o.uid))},loading:d,permission:c,requestPermission:u}},tt=()=>{const{notifications:o,unreadCount:t,isOpen:s,setIsOpen:r,markAsRead:a,markAllAsRead:n,permission:i,requestPermission:d}=cs(),l=p.useRef(null);p.useEffect(()=>{const m=u=>{l.current&&!l.current.contains(u.target)&&r(!1)};return document.addEventListener("mousedown",m),()=>document.removeEventListener("mousedown",m)},[r]);const c=m=>{switch(m){case"success":return"âœ…";case"warning":return"âš ï¸";case"reminder":return"â°";default:return"â„¹ï¸"}};return e.jsxs("div",{className:"relative",ref:l,children:[e.jsxs("button",{onClick:()=>r(!s),className:"relative p-2 text-gray-400 hover:text-gray-500 dark:text-gray-400 dark:hover:text-gray-300 focus:outline-none",children:[e.jsx("span",{className:"sr-only",children:"NotificaÃ§Ãµes"}),e.jsx("svg",{className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),t>0&&e.jsx("span",{className:"absolute top-1.5 right-1.5 block h-2.5 w-2.5 rounded-full ring-2 ring-white dark:ring-gray-800 bg-red-500 animate-pulse"})]}),s&&e.jsxs("div",{className:"origin-top-right absolute right-0 mt-2 w-80 rounded-md shadow-lg bg-white dark:bg-darkcard ring-1 ring-black ring-opacity-5 focus:outline-none z-50 overflow-hidden border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"py-2 px-4 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-gray-800",children:[e.jsx("span",{className:"text-sm font-bold text-gray-700 dark:text-gray-200",children:"NotificaÃ§Ãµes"}),t>0&&e.jsx("button",{onClick:n,className:"text-xs text-primary hover:text-indigo-600 dark:text-indigo-400",children:"Marcar todas como lidas"})]}),i==="default"&&e.jsxs("div",{className:"p-3 bg-indigo-50 dark:bg-indigo-900/20 border-b border-indigo-100 dark:border-indigo-800/30",children:[e.jsx("p",{className:"text-xs text-indigo-700 dark:text-indigo-300 mb-2",children:"Receba alertas sobre eventos e mudanÃ§as na sua equipe."}),e.jsx("button",{onClick:d,className:"w-full py-1.5 px-3 bg-white dark:bg-indigo-700 border border-indigo-200 dark:border-indigo-600 rounded text-xs font-bold text-indigo-600 dark:text-white hover:bg-indigo-50 dark:hover:bg-indigo-600 transition-colors shadow-sm",children:"Ativar notificaÃ§Ãµes no desktop ðŸ””"})]}),e.jsx("div",{className:"max-h-80 overflow-y-auto",children:o.length===0?e.jsx("div",{className:"py-8 text-center text-gray-500 dark:text-gray-400 text-sm",children:"Nenhuma notificaÃ§Ã£o."}):e.jsx("ul",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:o.map(m=>e.jsx("li",{className:`p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors ${m.read?"":"bg-indigo-50/50 dark:bg-indigo-900/10"}`,onClick:()=>a(m.id),children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-shrink-0 text-xl pt-1",children:c(m.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`text-sm font-medium ${m.read?"text-gray-600 dark:text-gray-400":"text-gray-900 dark:text-white"}`,children:m.title}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:m.message}),e.jsxs("div",{className:"mt-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] text-gray-400",children:new Date(m.createdAt).toLocaleDateString()}),m.link&&e.jsx($,{to:m.link,className:"text-xs text-primary font-bold hover:underline",onClick:()=>r(!1),children:"Ver Detalhes"})]})]}),!m.read&&e.jsx("div",{className:"flex-shrink-0 self-center",children:e.jsx("span",{className:"block h-2 w-2 rounded-full bg-primary"})})]})},m.id))})})]})]})},te=({children:o})=>{const{user:t,logout:s}=re(),{theme:r,toggleTheme:a}=ls(),n=Ne(),i=Fe(),[d,l]=p.useState(!1),c=async()=>{await s(),n("/")},m=g=>i.pathname===g?"bg-indigo-50 border-primary text-primary dark:bg-indigo-900/50 dark:text-indigo-200":"border-transparent text-gray-500 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-gray-200",u=g=>i.pathname===g?"border-primary text-gray-900 dark:text-white dark:border-indigo-400":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200";return t?e.jsxs("div",{className:"min-h-screen flex flex-col bg-gray-50 dark:bg-darkbg transition-colors duration-200",children:[e.jsxs("nav",{className:"bg-white dark:bg-darkcard shadow-sm sticky top-0 z-50 transition-colors duration-200",children:[e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between h-16",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0 flex items-center",children:e.jsx($,{to:"/dashboard",className:"text-primary font-bold text-xl tracking-tight dark:text-indigo-400",children:"EduEvent"})}),e.jsxs("div",{className:"hidden sm:ml-6 sm:flex sm:space-x-8",children:[e.jsx($,{to:"/dashboard",className:`inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium transition-colors ${u("/dashboard")}`,children:"Eventos"}),e.jsx($,{to:"/my-enrollments",className:`inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium transition-colors ${u("/my-enrollments")}`,children:"Minhas InscriÃ§Ãµes"}),t.role===H.ADMIN&&e.jsxs(e.Fragment,{children:[e.jsx($,{to:"/admin/scanner",className:`inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium transition-colors ${u("/admin/scanner")}`,children:"Scanner"}),e.jsx($,{to:"/admin/events",className:`inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium transition-colors ${u("/admin/events")}`,children:"Admin Eventos"}),e.jsx($,{to:"/admin/courses",className:`inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium transition-colors ${u("/admin/courses")}`,children:"Admin Cursos"}),e.jsx($,{to:"/admin/users",className:`inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium transition-colors ${u("/admin/users")}`,children:"Admin UsuÃ¡rios"}),e.jsx($,{to:"/admin/dev",className:`inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium text-amber-600 dark:text-amber-400 ${u("/admin/dev")}`,children:"Dev"})]})]})]}),e.jsxs("div",{className:"hidden sm:flex items-center gap-4",children:[e.jsx(tt,{}),e.jsx("button",{onClick:a,className:"p-2 rounded-full text-gray-500 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700 transition-colors",title:r==="dark"?"Mudar para modo claro":"Mudar para modo escuro",children:r==="dark"?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}),e.jsxs("div",{className:"flex-shrink-0 flex items-center",children:[e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400 mr-4",children:t.name||t.email}),e.jsx("button",{onClick:c,className:"relative inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary hover:bg-indigo-700 shadow-sm focus:outline-none transition-colors",children:"Sair"})]})]}),e.jsxs("div",{className:"-mr-2 flex items-center sm:hidden gap-2",children:[e.jsx(tt,{}),e.jsx("button",{onClick:a,className:"p-3 rounded-full text-gray-500 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700 transition-colors",children:r==="dark"?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}),e.jsxs("button",{onClick:()=>l(!d),type:"button",className:"bg-white dark:bg-gray-800 inline-flex items-center justify-center p-3 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary","aria-controls":"mobile-menu","aria-expanded":"false",children:[e.jsx("span",{className:"sr-only",children:"Abrir menu principal"}),d?e.jsx("svg",{className:"block h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}):e.jsx("svg",{className:"block h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})]})]})]})}),d&&e.jsxs("div",{className:"sm:hidden border-t border-gray-200 dark:border-gray-700",id:"mobile-menu",children:[e.jsxs("div",{className:"pt-2 pb-3 space-y-1",children:[e.jsx($,{to:"/dashboard",onClick:()=>l(!1),className:`block pl-3 pr-4 py-3 border-l-4 text-base font-medium transition-colors ${m("/dashboard")}`,children:"Eventos"}),e.jsx($,{to:"/my-enrollments",onClick:()=>l(!1),className:`block pl-3 pr-4 py-3 border-l-4 text-base font-medium transition-colors ${m("/my-enrollments")}`,children:"Minhas InscriÃ§Ãµes"}),t.role===H.ADMIN&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pt-4 pb-2",children:e.jsx("span",{className:"px-4 text-xs font-bold text-gray-400 uppercase tracking-wider",children:"AdministraÃ§Ã£o"})}),e.jsx($,{to:"/admin/scanner",onClick:()=>l(!1),className:`block pl-3 pr-4 py-3 border-l-4 text-base font-medium transition-colors ${m("/admin/scanner")}`,children:"Scanner Check-in"}),e.jsx($,{to:"/admin/events",onClick:()=>l(!1),className:`block pl-3 pr-4 py-3 border-l-4 text-base font-medium transition-colors ${m("/admin/events")}`,children:"Gerenciar Eventos"}),e.jsx($,{to:"/admin/courses",onClick:()=>l(!1),className:`block pl-3 pr-4 py-3 border-l-4 text-base font-medium transition-colors ${m("/admin/courses")}`,children:"Gerenciar Cursos"}),e.jsx($,{to:"/admin/users",onClick:()=>l(!1),className:`block pl-3 pr-4 py-3 border-l-4 text-base font-medium transition-colors ${m("/admin/users")}`,children:"Gerenciar UsuÃ¡rios"}),e.jsx($,{to:"/admin/dev",onClick:()=>l(!1),className:"block pl-3 pr-4 py-3 border-l-4 text-base font-medium text-amber-600 bg-amber-50 border-amber-300 dark:bg-amber-900/20 dark:border-amber-700 dark:text-amber-500",children:"Dev"})]})]}),e.jsxs("div",{className:"pt-4 pb-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center px-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center text-primary dark:text-indigo-200 font-bold text-lg",children:t.name?t.name.charAt(0):t.email.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("div",{className:"text-base font-medium text-gray-800 dark:text-gray-200",children:t.name||"UsuÃ¡rio"}),e.jsx("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:t.email})]})]}),e.jsx("div",{className:"mt-3 space-y-1",children:e.jsx("button",{onClick:c,className:"block w-full text-left px-4 py-3 text-base font-medium text-gray-500 hover:text-gray-800 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-200 dark:hover:bg-gray-700",children:"Sair do Sistema"})})]})]})]}),e.jsx("main",{className:"flex-1 py-6",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o})})]}):e.jsx(e.Fragment,{children:o})},ne=({children:o,isLoading:t=!1,variant:s="primary",className:r="",disabled:a,...n})=>{const i="relative inline-flex items-center justify-center px-4 py-2 border text-sm font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",d={primary:"border-transparent text-white bg-primary hover:bg-indigo-700 focus:ring-primary",secondary:"border-transparent text-white bg-secondary hover:bg-emerald-700 focus:ring-secondary",danger:"border-transparent text-white bg-red-600 hover:bg-red-700 focus:ring-red-500",outline:"border-gray-300 text-gray-700 bg-white hover:bg-gray-50 focus:ring-primary"};return e.jsxs("button",{disabled:t||a,className:`${i} ${d[s]} ${r}`,...n,children:[e.jsx("span",{className:t?"invisible":"",children:o}),t&&e.jsx("span",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})]})},Ce=o=>{const t=(o==null?void 0:o.code)||"",s=(o==null?void 0:o.message)||"";if(typeof s=="string"&&s.startsWith("CONFLICT|")){const r=s.split("|");return r.length>=4?`Conflito de horÃ¡rio! VocÃª jÃ¡ possui o evento "${r[1]}" agendado entre ${r[2]} e ${r[3]}.`:"Conflito de horÃ¡rio com outro evento jÃ¡ agendado."}if(s==="A sessÃ£o estÃ¡ lotada"||s.includes("capacidade mÃ¡xima"))return"Que pena! Esta sessÃ£o acabou de lotar.";if(s.includes("jÃ¡ estÃ¡ inscrito"))return"VocÃª jÃ¡ garantiu sua vaga neste evento!";if(s.includes("Evento nÃ£o encontrado"))return"O evento que vocÃª procura nÃ£o estÃ¡ mais disponÃ­vel.";switch(t){case"auth/invalid-credential":case"auth/user-not-found":case"auth/wrong-password":return"E-mail ou senha incorretos. Verifique e tente novamente.";case"auth/email-already-in-use":return"Este e-mail jÃ¡ estÃ¡ sendo usado por outra conta.";case"auth/weak-password":return"Sua senha Ã© muito fraca. Escolha uma senha mais forte.";case"auth/invalid-email":return"O formato do e-mail Ã© invÃ¡lido.";case"auth/user-disabled":return"Esta conta foi desativada. Contate o administrador.";case"auth/too-many-requests":return"Muitas tentativas consecutivas. Aguarde alguns instantes.";case"auth/network-request-failed":return"Erro de conexÃ£o. Verifique sua internet.";case"auth/popup-closed-by-user":return"O login foi cancelado.";case"permission-denied":return"VocÃª nÃ£o tem permissÃ£o para realizar esta aÃ§Ã£o.";default:return s||"Ocorreu um erro inesperado. Tente novamente mais tarde."}},le=({label:o,error:t,helperText:s,as:r="input",className:a="",children:n,id:i,...d})=>{const l=i||d.name||Math.random().toString(36).substr(2,9),c=`${l}-error`,m=`${l}-helper`,u=`
    appearance-none 
    block 
    w-full 
    px-4 
    py-3 
    text-base 
    rounded-lg 
    border 
    bg-white dark:bg-gray-800 
    text-gray-900 dark:text-white 
    placeholder-gray-400 
    focus:outline-none 
    focus:ring-2 
    focus:ring-offset-0
    transition-shadow 
    duration-200
  `,g=t?"border-red-300 focus:border-red-500 focus:ring-red-200 dark:border-red-800 dark:focus:ring-red-900/30":"border-gray-300 dark:border-gray-600 focus:border-primary focus:ring-indigo-100 dark:focus:ring-indigo-900/30",x=[t?c:void 0,s?m:void 0].filter(Boolean).join(" ")||void 0;return e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:l,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5 ml-1",children:o}),e.jsx("div",{className:"relative",children:r==="select"?e.jsx("select",{id:l,className:`${u} ${g} ${a} pr-10`,"aria-invalid":!!t,"aria-describedby":x,...d,children:n}):e.jsx("input",{id:l,className:`${u} ${g} ${a}`,"aria-invalid":!!t,"aria-describedby":x,...d})}),t?e.jsxs("p",{id:c,className:"mt-1.5 text-sm text-red-600 dark:text-red-400 flex items-center animate-fade-in ml-1",role:"alert",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),t]}):s?e.jsx("p",{id:m,className:"mt-1.5 text-sm text-gray-500 dark:text-gray-400 ml-1",children:s}):null]})},ms=()=>{var k,y;const[o,t]=p.useState(""),[s,r]=p.useState(""),{user:a,loading:n,login:i,loginWithGoogle:d}=re(),l=Ne(),c=Fe(),{addToast:m}=ve(),[u,g]=p.useState(!1),x=(y=(k=c.state)==null?void 0:k.from)!=null&&y.pathname?c.state.from.pathname+(c.state.from.search||""):"/dashboard";p.useEffect(()=>{!n&&a&&l(x,{replace:!0})},[a,n,l,x]);const w=async S=>{S.preventDefault(),g(!0);try{await i(o,s),m("success","Login realizado com sucesso!")}catch(j){const T=Ce(j);m("error",T)}finally{g(!1)}},v=async()=>{g(!0);try{await d(),m("success","Autenticado com Google!")}catch(S){const j=Ce(S);m("error",j),g(!1)}};return n||!n&&a?e.jsx("div",{className:"h-screen flex items-center justify-center bg-gray-50 dark:bg-darkbg text-primary font-medium",children:"Verificando sessÃ£o..."}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-darkbg py-12 px-4 sm:px-6 lg:px-8 transition-colors duration-300",children:e.jsxs("div",{className:"max-w-md w-full space-y-8 text-center",children:[e.jsx("div",{className:"flex justify-start",children:e.jsxs($,{to:"/",className:"flex items-center text-sm text-gray-500 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors font-medium p-2 -ml-2 rounded-lg active:bg-gray-100 dark:active:bg-gray-800",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Voltar para o inÃ­cio"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-primary dark:text-indigo-400",children:"EduEvent"}),e.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900 dark:text-white",children:"Acesse sua conta"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:se.useFirebase?"Gerencie suas inscriÃ§Ãµes e eventos em um sÃ³ lugar.":"Ambiente de DemonstraÃ§Ã£o (Mock)"})]}),e.jsxs("form",{className:"mt-8 space-y-2",onSubmit:w,children:[e.jsx(le,{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,label:"E-mail",placeholder:"seu@email.com",value:o,onChange:S=>t(S.target.value),inputMode:"email"}),e.jsx(le,{id:"password",name:"password",type:"password",autoComplete:"current-password",required:se.useFirebase,label:"Senha",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",value:s,onChange:S=>r(S.target.value),enterKeyHint:"go"}),e.jsx("div",{className:"pt-4",children:e.jsx(ne,{type:"submit",isLoading:u,className:"w-full h-12 text-base shadow-lg shadow-indigo-200 dark:shadow-none",children:"Acessar Plataforma"})}),e.jsxs("div",{className:"relative my-6",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-700"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-gray-50 dark:bg-darkbg text-gray-500 dark:text-gray-400",children:"Ou entre rapidamente com"})})]}),e.jsxs("button",{type:"button",onClick:v,disabled:u,className:"w-full h-12 flex items-center justify-center px-4 border border-gray-300 dark:border-gray-600 shadow-sm text-base font-medium rounded-lg text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-70 transition-colors active:scale-[0.98]",children:[e.jsxs("svg",{className:"h-5 w-5 mr-3","aria-hidden":"true",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),e.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),e.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.84z",fill:"#FBBC05"}),e.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Google"]})]}),!se.useFirebase&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-4 p-4 border border-dashed border-gray-300 dark:border-gray-700 rounded-lg",children:[e.jsx("p",{className:"font-bold mb-2",children:"Ambiente de Teste (Mock):"}),e.jsxs("ul",{className:"space-y-2",children:[e.jsx("li",{onClick:()=>t("student@school.com"),className:"cursor-pointer hover:text-primary transition-colors p-2 bg-white dark:bg-gray-800 rounded shadow-sm border border-gray-100 dark:border-gray-700",children:"ðŸ‘¤ student@school.com"}),e.jsx("li",{onClick:()=>t("admin@school.com"),className:"cursor-pointer hover:text-primary transition-colors p-2 bg-white dark:bg-gray-800 rounded shadow-sm border border-gray-100 dark:border-gray-700",children:"ðŸ›¡ï¸ admin@school.com"})]})]})]})})},us=()=>{const{user:o,refreshProfile:t}=re(),s=Ne(),{addToast:r}=ve(),[a,n]=p.useState([]),[i,d]=p.useState([]),[l,c]=p.useState(!1),[m,u]=p.useState({name:(o==null?void 0:o.name)||"",rm:"",courseId:"",classId:""});p.useEffect(()=>{if(o!=null&&o.isOnboarded){s("/dashboard");return}D.getCourses().then(n)},[o,s]),p.useEffect(()=>{m.courseId&&(D.getClasses(m.courseId).then(d),u(x=>({...x,classId:""})))},[m.courseId]);const g=async x=>{if(x.preventDefault(),!!o){c(!0);try{const w={...m,email:o.email,role:o.role};await D.updateUserProfile(o.uid,w),await t(),r("success","Perfil completado com sucesso! Bem-vindo."),s("/dashboard")}catch(w){const v=Ce(w);r("error",v)}finally{c(!1)}}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-darkbg py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900 dark:text-white",children:"Complete seu perfil"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600 dark:text-gray-400",children:"Precisamos de mais alguns detalhes antes de comeÃ§ar."})]}),e.jsxs("form",{className:"mt-8 space-y-4",onSubmit:g,children:[e.jsx(le,{id:"name",name:"name",type:"text",required:!0,label:"Nome Completo",placeholder:"Ex: JoÃ£o da Silva",value:m.name,onChange:x=>u({...m,name:x.target.value}),autoComplete:"name"}),e.jsx(le,{id:"rm",name:"rm",type:"text",required:!0,label:"Registro de MatrÃ­cula (RM)",placeholder:"Ex: 12345",value:m.rm,onChange:x=>u({...m,rm:x.target.value}),inputMode:"numeric"}),e.jsxs(le,{as:"select",label:"Curso",required:!0,value:m.courseId,onChange:x=>u({...m,courseId:x.target.value}),children:[e.jsx("option",{value:"",children:"Selecione o Curso"}),a.map(x=>e.jsx("option",{value:x.id,children:x.name},x.id))]}),e.jsxs(le,{as:"select",label:"Turma",required:!0,disabled:!m.courseId,value:m.classId,onChange:x=>u({...m,classId:x.target.value}),className:"disabled:opacity-50",children:[e.jsx("option",{value:"",children:"Selecione a Turma"}),i.map(x=>e.jsx("option",{value:x.id,children:x.name},x.id))]}),e.jsx("div",{className:"pt-4",children:e.jsx(ne,{type:"submit",isLoading:l,className:"w-full h-12 text-base shadow-lg",children:"Concluir Cadastro"})})]})]})})},xs=(o,t={})=>{const[s,r]=p.useState(null),[a,n]=p.useState(null),i=t.minSwipeDistance||50;return{onTouchStart:m=>{n(null),r({x:m.targetTouches[0].clientX,y:m.targetTouches[0].clientY})},onTouchMove:m=>{n({x:m.targetTouches[0].clientX,y:m.targetTouches[0].clientY})},onTouchEnd:()=>{if(!s||!a)return;const m=s.x-a.x,u=s.y-a.y;if(Math.abs(m)>Math.abs(u)){if(Math.abs(m)<i)return;m>0?o.onSwipeLeft&&o.onSwipeLeft():o.onSwipeRight&&o.onSwipeRight()}else{if(Math.abs(u)<i)return;u>0?o.onSwipeUp&&o.onSwipeUp():o.onSwipeDown&&o.onSwipeDown()}}}},ce=({isOpen:o,onClose:t,title:s,children:r})=>{const a=p.useRef(null),n=p.useRef(null),i=xs({onSwipeDown:t});return p.useEffect(()=>(o?(n.current=document.activeElement,document.body.style.overflow="hidden",setTimeout(()=>{a.current&&a.current.focus()},50)):(document.body.style.overflow="unset",n.current&&n.current.focus()),()=>{document.body.style.overflow="unset"}),[o]),p.useEffect(()=>{const d=l=>{l.key==="Escape"&&t()};return o&&window.addEventListener("keydown",d),()=>{window.removeEventListener("keydown",d)}},[o,t]),o?e.jsx("div",{className:"fixed inset-0 z-[100] overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 dark:bg-gray-900 bg-opacity-75 dark:bg-opacity-80 transition-opacity animate-fade-in","aria-hidden":"true",onClick:t}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"â€‹"}),e.jsxs("div",{ref:a,tabIndex:-1,className:`
              inline-block align-bottom bg-white dark:bg-darkcard 
              rounded-t-2xl sm:rounded-lg 
              text-left overflow-hidden shadow-xl 
              transform transition-all 
              w-full sm:my-8 sm:align-middle sm:max-w-lg 
              animate-slide-in outline-none
              relative
            `,...i,children:[e.jsx("div",{className:"sm:hidden w-full flex justify-center pt-3 pb-1",onClick:t,children:e.jsx("div",{className:"w-12 h-1.5 bg-gray-300 dark:bg-gray-600 rounded-full"})}),e.jsx("div",{className:"bg-white dark:bg-darkcard px-4 pt-2 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 text-center sm:mt-0 sm:text-left w-full",children:[e.jsx("h3",{className:"text-lg leading-6 font-bold text-gray-900 dark:text-white",id:"modal-title",children:s}),e.jsx("div",{className:"mt-4 text-gray-600 dark:text-gray-300",children:r})]})})}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800/50 px-4 py-4 sm:px-6 sm:flex sm:flex-row-reverse border-t border-gray-100 dark:border-gray-700",children:e.jsx("button",{type:"button",className:"w-full inline-flex justify-center rounded-lg border border-gray-300 dark:border-gray-600 shadow-sm px-4 py-3 bg-white dark:bg-gray-700 text-base font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm sm:py-2 transition-colors active:scale-[0.98]",onClick:t,children:"Fechar"})})]})]})}):null},hs=({currentPage:o,totalItems:t,itemsPerPage:s,onPageChange:r})=>{const a=Math.ceil(t/s);if(a<=1)return null;const n=()=>{const i=[];if(a<=7)for(let d=1;d<=a;d++)i.push(d);else o<=4?i.push(1,2,3,4,5,"...",a):o>=a-3?i.push(1,"...",a-4,a-3,a-2,a-1,a):i.push(1,"...",o-1,o,o+1,"...",a);return i};return e.jsxs("div",{className:"flex items-center justify-between border-t border-gray-200 bg-white px-4 py-3 sm:px-6 mt-4 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex flex-1 justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>r(Math.max(1,o-1)),disabled:o===1,className:"relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Anterior"}),e.jsx("button",{onClick:()=>r(Math.min(a,o+1)),disabled:o===a,className:"relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"PrÃ³ximo"})]}),e.jsxs("div",{className:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Mostrando ",e.jsx("span",{className:"font-medium",children:(o-1)*s+1})," a ",e.jsx("span",{className:"font-medium",children:Math.min(o*s,t)})," de ",e.jsx("span",{className:"font-medium",children:t})," resultados"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination",children:[e.jsxs("button",{onClick:()=>r(Math.max(1,o-1)),disabled:o===1,className:"relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50",children:[e.jsx("span",{className:"sr-only",children:"Anterior"}),e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z",clipRule:"evenodd"})})]}),n().map((i,d)=>typeof i=="number"?e.jsx("button",{onClick:()=>r(i),"aria-current":o===i?"page":void 0,className:`relative inline-flex items-center px-4 py-2 text-sm font-semibold ${o===i?"z-10 bg-primary text-white focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0"}`,children:i},d):e.jsx("span",{className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700 ring-1 ring-inset ring-gray-300 focus:outline-offset-0",children:"..."},d)),e.jsxs("button",{onClick:()=>r(Math.min(a,o+1)),disabled:o===a,className:"relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50",children:[e.jsx("span",{className:"sr-only",children:"PrÃ³ximo"}),e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z",clipRule:"evenodd"})})]})]})})]})]})},ct=(o,t)=>{const[s,r]=p.useState(null),[a,n]=p.useState(!1),{addToast:i}=ve(),d=p.useCallback(()=>{r(null)},[]),l=p.useCallback(async(m,u)=>{if(o){d(),n(!0);try{await D.createEnrollment(o.uid,m.id,u),i("success",`InscriÃ§Ã£o confirmada em ${m.name}!`),setTimeout(()=>t(),500)}catch(g){const x=g.message||"";if(x.startsWith("CONFLICT|")){const[w,v,k,y]=x.split("|");r({name:v,time:`${k} - ${y}`}),i("warning","Conflito de horÃ¡rio detectado.")}else{const w=Ce(g);i("error",w)}}finally{n(!1)}}},[o,t,d,i]),c=p.useCallback(async m=>{if(o){n(!0);try{await D.cancelEnrollment(m),i("success","InscriÃ§Ã£o cancelada com sucesso."),setTimeout(()=>t(),500)}catch(u){i("error","Erro ao cancelar inscriÃ§Ã£o."),console.error(u)}finally{n(!1)}}},[o,t,i]);return{handleEnroll:l,handleCancel:c,isProcessing:a,isEnrolling:a,conflictData:s,clearState:d}};function gs(o,t=300){const[s,r]=p.useState(o);return p.useEffect(()=>{const a=setTimeout(()=>{r(o)},t);return()=>{clearTimeout(a)}},[o,t]),s}const fs=o=>{const[t,s]=p.useState([]),[r,a]=p.useState([]),[n,i]=p.useState(!0),[d,l]=p.useState(""),[c,m]=p.useState(""),[u,g]=p.useState(!1),[x,w]=p.useState(1),v=9,k=gs(d,300),y=p.useCallback(async(C=!0)=>{if(o){C&&i(!0);try{const[A,N]=await Promise.all([D.getAvailableEventsForUser(o),D.getEnrollmentsForUser(o.uid)]);s(A),a(N)}catch(A){console.error(A)}finally{C&&i(!1)}}},[o]);p.useEffect(()=>{y()},[y]);const S=p.useMemo(()=>{const C=new Set;return t.forEach(A=>{A.parentId&&C.add(A.parentId)}),C},[t]),j=p.useMemo(()=>{const C=new Date().toISOString().split("T")[0];return t.filter(A=>{if(A.parentId)return!1;const N=A.name.toLowerCase().includes(k.toLowerCase())||A.description.toLowerCase().includes(k.toLowerCase()),M=t.filter(_=>_.parentId===A.id),R=[...A.sessions,...M.flatMap(_=>_.sessions)],V=c?R.some(_=>_.date===c):!0,B=u||R.some(_=>_.date>=C);return N&&V&&B})},[t,k,c,u]);p.useEffect(()=>{w(1)},[k,c,u]);const T=p.useMemo(()=>{const C=(x-1)*v;return j.slice(C,C+v)},[j,x]),E=(C,A)=>r.find(N=>N.eventId===C&&N.sessionId===A);return{events:t,filteredEvents:j,paginatedEvents:T,parentIds:S,loading:n,filters:{searchTerm:d,setSearchTerm:l,filterDate:c,setFilterDate:m,showPastEvents:u,setShowPastEvents:g},pagination:{currentPage:x,setCurrentPage:w,totalItems:j.length,itemsPerPage:v},helpers:{getEnrollment:E},refresh:()=>y(!1)}},ps=()=>e.jsx("li",{className:"px-6 py-4 animate-pulse",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/5"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/5"})]}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-24"})]})}),vs=()=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 flex flex-col h-full animate-pulse",children:[e.jsxs("div",{className:"p-5 flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded-full w-1/3"})]}),e.jsx("div",{className:"h-5 bg-gray-200 rounded w-4/5 mb-2"}),e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-5/6"})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/3"})]}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"h-2 bg-gray-200 rounded-full"})})]}),e.jsx("div",{className:"w-full h-12 bg-gray-100 border-t border-gray-200"})]}),Bs=()=>e.jsxs("tr",{className:"animate-pulse",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200"}),e.jsxs("div",{className:"ml-4 space-y-2",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-24"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-32"})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap space-y-2",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-20"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-16"})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"h-3 bg-gray-200 rounded w-12"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"h-5 bg-gray-200 rounded-full w-16"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2",children:e.jsx("div",{className:"h-5 bg-gray-200 rounded w-36 inline-block"})})]}),Vs=()=>e.jsxs("div",{className:"bg-white shadow rounded-lg p-4 flex flex-col space-y-3 animate-pulse",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-24"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-32"})]})]}),e.jsx("div",{className:"h-5 bg-gray-200 rounded-full w-16"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 border-t border-b border-gray-100 py-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"h-2 bg-gray-200 rounded w-10"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-20"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"h-2 bg-gray-200 rounded w-10"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-16"})]})]}),e.jsx("div",{className:"flex justify-end pt-1",children:e.jsx("div",{className:"h-6 bg-gray-200 rounded w-48"})})]}),mt=({icon:o,title:t,description:s,action:r})=>e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 text-center bg-white dark:bg-darkcard rounded-lg border-2 border-dashed border-gray-200 dark:border-gray-700 transition-colors duration-200",children:[e.jsx("div",{className:"text-5xl text-gray-300 dark:text-gray-600 mb-4 transition-colors duration-200",children:o||"ðŸ“­"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-1",children:t}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 max-w-sm mb-6",children:s}),r&&e.jsx("button",{onClick:r.onClick,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-primary dark:text-indigo-300 bg-indigo-50 dark:bg-indigo-900/30 hover:bg-indigo-100 dark:hover:bg-indigo-900/50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition-colors duration-200",children:r.label})]}),qe=({isOpen:o,onClose:t,onConfirm:s,title:r,message:a,confirmText:n="Confirmar",cancelText:i="Cancelar",isProcessing:d=!1,variant:l="danger"})=>e.jsx(ce,{isOpen:o,onClose:()=>!d&&t(),title:r,children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-gray-700",children:a}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:t,disabled:d,className:"px-4 py-2 bg-gray-100 rounded-md hover:bg-gray-200 text-gray-800 text-sm font-medium disabled:opacity-50",children:i}),e.jsx(ne,{onClick:s,isLoading:d,variant:l,children:n})]})]})}),bs=({isOpen:o,onClose:t})=>{const[s,r]=p.useState(0),[a,n]=p.useState(!1);if(!o)return null;const i=[{title:"Bem-vindo ao EduEvent! ðŸŽ“",description:"Sua nova central para descobrir, gerenciar e participar dos melhores eventos acadÃªmicos e escolares da sua instituiÃ§Ã£o.",color:"bg-indigo-500",image:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",className:"w-32 h-32 text-indigo-600 dark:text-indigo-400",children:[e.jsx("path",{d:"M22 10v6M2 10l10-5 10 5-10 5z"}),e.jsx("path",{d:"M6 12v5c3 3 9 3 12 0v-5"})]})},{title:"Explore Eventos IncrÃ­veis ðŸŒ",description:"Navegue pelo Dashboard para encontrar eventos. Use os filtros inteligentes para buscar por data, nome ou ver apenas o que Ã© relevante para seu curso.",color:"bg-emerald-500",image:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",className:"w-32 h-32 text-emerald-600 dark:text-emerald-400",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}),e.jsx("path",{d:"M11 8v6M8 11h6"})]})},{title:"InscriÃ§Ã£o em 1 Clique ðŸ‘†",description:"Gostou de um evento? Clique em 'Garantir Vaga' ou 'Inscrever'. O sistema verifica conflitos de horÃ¡rio automaticamente para vocÃª.",color:"bg-amber-500",image:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",className:"w-32 h-32 text-amber-600 dark:text-amber-400",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("path",{d:"M9 15l2 2 4-4"})]})},{title:"Sua Agenda Organizada ðŸ“…",description:"Acesse 'Minhas InscriÃ§Ãµes' para ver todos os seus compromissos confirmados. VocÃª pode cancelar inscriÃ§Ãµes se mudar de ideia.",color:"bg-purple-500",image:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",className:"w-32 h-32 text-purple-600 dark:text-purple-400",children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),e.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),e.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"}),e.jsx("path",{d:"M8 14h.01"}),e.jsx("path",{d:"M12 14h.01"}),e.jsx("path",{d:"M16 14h.01"}),e.jsx("path",{d:"M8 18h.01"}),e.jsx("path",{d:"M12 18h.01"}),e.jsx("path",{d:"M16 18h.01"})]})},{title:"Tudo Pronto! ðŸš€",description:"VocÃª jÃ¡ sabe o bÃ¡sico. Agora Ã© com vocÃª! Explore, aprenda e aproveite ao mÃ¡ximo os eventos da sua escola.",color:"bg-primary",image:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",className:"w-32 h-32 text-primary dark:text-indigo-400",children:[e.jsx("path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"}),e.jsx("path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"}),e.jsx("path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"}),e.jsx("path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"})]})}],d=()=>{s<i.length-1?(n(!0),setTimeout(()=>{r(m=>m+1),n(!1)},300)):t()},l=()=>{t()},c=i[s];return e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-gray-900/60 backdrop-blur-sm transition-opacity",onClick:l}),e.jsxs("div",{className:"relative bg-white dark:bg-darkcard w-full max-w-md rounded-2xl shadow-2xl overflow-hidden flex flex-col min-h-[500px] animate-fade-in border border-gray-100 dark:border-gray-700",children:[e.jsx("div",{className:`h-2 w-full ${c.color} transition-colors duration-500`}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-8 text-center",children:[e.jsx("div",{className:`mb-8 p-6 bg-gray-50 dark:bg-gray-800 rounded-full transition-all duration-300 transform ${a?"opacity-0 scale-90 translate-x-4":"opacity-100 scale-100 translate-x-0"}`,children:c.image}),e.jsxs("div",{className:`transition-all duration-300 ${a?"opacity-0 translate-y-4":"opacity-100 translate-y-0"}`,children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-3",children:c.title}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 leading-relaxed",children:c.description})]})]}),e.jsxs("div",{className:"p-6 bg-gray-50 dark:bg-gray-800/50 border-t border-gray-100 dark:border-gray-700",children:[e.jsx("div",{className:"flex justify-center space-x-2 mb-6",children:i.map((m,u)=>e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${u===s?`w-6 ${c.color}`:"w-2 bg-gray-300 dark:bg-gray-600"}`},u))}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:l,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 font-medium text-sm px-4 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:"Pular Tutorial"}),e.jsxs("button",{onClick:d,className:`px-6 py-2.5 rounded-xl text-white font-bold shadow-lg shadow-indigo-500/20 transform transition active:scale-95 flex items-center ${c.color} hover:brightness-110`,children:[s===i.length-1?"ComeÃ§ar Agora":"PrÃ³ximo",s<i.length-1&&e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})]})]})},ys=ie.memo(({event:o,hasChildren:t,onAction:s})=>{const r=!t&&o.sessions.length===1?o.sessions[0]:null,a=r?r.capacity:0,n=r?r.filled:0,i=a>0?n/a*100:0,d=a>0&&n>=a;let l="bg-indigo-500",c="PÃºblico";return o.visibility==="course"&&(l="bg-emerald-500",c="Meu Curso"),o.visibility==="class"&&(l="bg-purple-500",c="Minha Turma"),e.jsxs("div",{className:"group bg-white dark:bg-darkcard rounded-xl shadow-sm hover:shadow-xl transition-all duration-300 overflow-hidden border border-gray-100 dark:border-gray-700 flex flex-col h-full relative animate-fade-in hover:-translate-y-1",children:[e.jsx("div",{className:`absolute top-0 left-0 w-1.5 h-full ${l} opacity-80`}),e.jsxs("div",{className:"p-5 flex-1 flex flex-col ml-2",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx("span",{className:`text-[10px] uppercase tracking-wider font-bold px-2 py-1 rounded-md ${l} bg-opacity-10 dark:bg-opacity-20 text-gray-700 dark:text-gray-200`,children:c}),o.isTeamEvent&&e.jsxs("span",{className:"text-[10px] uppercase tracking-wider font-bold px-2 py-1 rounded-md bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 border border-purple-200 dark:border-purple-800 flex items-center gap-1",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"})}),"Equipe"]})]}),t?e.jsx("span",{className:"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 text-xs px-2 py-1 rounded-full font-medium border border-gray-200 dark:border-gray-600",children:"Evento Principal"}):d&&r?e.jsxs("span",{className:"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 text-xs px-2 py-1 rounded-full font-bold flex items-center",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-red-500 rounded-full mr-1.5"}),"Esgotado"]}):e.jsxs("span",{className:"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 text-xs px-2 py-1 rounded-full font-bold flex items-center",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-green-500 rounded-full mr-1.5"}),"Aberto"]})]}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white leading-tight mb-2 group-hover:text-primary dark:group-hover:text-indigo-400 transition-colors",children:o.name}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm line-clamp-2 mb-4 flex-1",children:o.description}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-300 mt-auto",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 flex justify-center text-gray-400 dark:text-gray-500 mr-2",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),e.jsx("span",{className:"font-medium",children:o.location})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 flex justify-center text-gray-400 dark:text-gray-500 mr-2",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("span",{className:"font-medium",children:t?"Ver programaÃ§Ã£o completa":o.sessions.length>1?`${o.sessions.length} horÃ¡rios disponÃ­veis`:`${X(r==null?void 0:r.date)} â€¢ ${r==null?void 0:r.startTime}`})]})]}),!t&&r&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1 font-medium",children:[e.jsx("span",{className:d?"text-red-600 dark:text-red-400":"text-gray-500 dark:text-gray-400",children:d?"Sem vagas":o.isTeamEvent?`${a-n} equipes restantes`:`${a-n} vagas restantes`}),e.jsxs("span",{className:"text-gray-400 dark:text-gray-500",children:[Math.round(i),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-100 dark:bg-gray-700 rounded-full h-1.5 overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${d?"bg-red-500":i>80?"bg-amber-400":"bg-emerald-500"}`,style:{width:`${i}%`}})})]})]}),e.jsxs("button",{onClick:()=>s(o),className:"w-full py-3 text-sm font-bold text-primary dark:text-indigo-300 bg-indigo-50 dark:bg-gray-800/50 hover:bg-primary hover:text-white dark:hover:bg-indigo-600 dark:hover:text-white transition-colors border-t border-indigo-100 dark:border-gray-700 flex justify-center items-center",children:[t||o.isTeamEvent?"Ver Detalhes":"Ver Detalhes e Inscrever",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})}),ws=({searchTerm:o,onSearchChange:t,filterDate:s,onDateChange:r,showPastEvents:a,onTogglePast:n})=>e.jsxs("div",{className:"bg-white dark:bg-darkcard p-5 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col lg:flex-row gap-4 items-end transition-colors duration-200",children:[e.jsxs("div",{className:"flex-1 w-full",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 mb-1 uppercase tracking-wider",children:"Buscar Evento"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400 dark:text-gray-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})})}),e.jsx("input",{type:"text",placeholder:"Nome, descriÃ§Ã£o, local...",className:"pl-10 w-full border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:ring-primary focus:border-primary sm:text-sm bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white py-2.5 transition-colors",value:o,onChange:i=>t(i.target.value)})]})]}),e.jsxs("div",{className:"w-full lg:w-48",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 mb-1 uppercase tracking-wider",children:"Data EspecÃ­fica"}),e.jsx("input",{type:"date",className:"w-full border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:ring-primary focus:border-primary sm:text-sm bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white py-2.5 transition-colors",value:s,onChange:i=>r(i.target.value)})]}),e.jsx("div",{className:"w-full lg:w-auto pb-2",children:e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsxs("div",{className:"relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in",children:[e.jsx("input",{type:"checkbox",className:"toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer",checked:a,onChange:i=>n(i.target.checked),style:{right:a?"0":"auto",left:a?"auto":"0",borderColor:a?"#4F46E5":"#E5E7EB"}}),e.jsx("label",{className:`toggle-label block overflow-hidden h-6 rounded-full cursor-pointer ${a?"bg-primary":"bg-gray-300 dark:bg-gray-600"}`})]}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Mostrar Passados"})]})})]}),js=()=>{const{user:o}=re(),t=Ne(),{events:s,paginatedEvents:r,parentIds:a,loading:n,filters:i,pagination:d,helpers:l,refresh:c}=fs(o),[m,u]=p.useState(null),[g,x]=p.useState(null),[w,v]=p.useState(!1);p.useEffect(()=>{if(!localStorage.getItem("eduevent_tutorial_completed")){const M=setTimeout(()=>v(!0),1e3);return()=>clearTimeout(M)}},[]);const k=()=>{v(!1),localStorage.setItem("eduevent_tutorial_completed","true")},y=p.useCallback(()=>{c(),x(null)},[c]),{handleEnroll:S,handleCancel:j,isProcessing:T,conflictData:E,clearState:C}=ct(o,y);p.useEffect(()=>{if(m){const N=s.find(M=>M.id===m.id);N&&JSON.stringify(N)!==JSON.stringify(m)&&u(N)}},[s,m]);const A=p.useCallback(N=>{a.has(N.id)||N.isTeamEvent?t(`/event/${N.id}`):(C(),u(N))},[a,t,C]);return e.jsxs("div",{className:"space-y-8 animate-fade-in relative",children:[e.jsx(bs,{isOpen:w,onClose:k}),e.jsx("header",{className:"flex flex-col md:flex-row md:justify-between md:items-end gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-extrabold text-gray-900 dark:text-white tracking-tight",children:"Dashboard de Eventos"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Explore e inscreva-se nas atividades disponÃ­veis para seu perfil."})]})}),e.jsx(ws,{searchTerm:i.searchTerm,onSearchChange:i.setSearchTerm,filterDate:i.filterDate,onDateChange:i.setFilterDate,showPastEvents:i.showPastEvents,onTogglePast:i.setShowPastEvents}),n?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((N,M)=>e.jsx(vs,{},M))}):r.length===0?e.jsx(mt,{title:"Nenhum evento encontrado",description:s.length===0?"NÃ£o hÃ¡ eventos disponÃ­veis para o seu curso ou turma no momento.":i.showPastEvents?"Nenhum evento corresponde aos filtros de busca.":"NÃ£o hÃ¡ eventos futuros correspondentes. Tente ativar 'Mostrar Passados'.",action:!i.showPastEvents&&s.length>0?{label:"Ver histÃ³rico de eventos",onClick:()=>i.setShowPastEvents(!0)}:void 0}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(N=>e.jsx(ys,{event:N,hasChildren:a.has(N.id),onAction:A},N.id))}),e.jsx(hs,{currentPage:d.currentPage,totalItems:d.totalItems,itemsPerPage:d.itemsPerPage,onPageChange:d.setCurrentPage})]}),e.jsx(ce,{isOpen:!!m,onClose:()=>u(null),title:m?m.name:"",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:e.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed",children:m==null?void 0:m.description})}),E&&e.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/30 border-l-4 border-amber-400 p-4 rounded-r-md animate-slide-in",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-amber-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-bold text-amber-800 dark:text-amber-300",children:"Conflito de HorÃ¡rio"}),e.jsxs("div",{className:"mt-2 text-sm text-amber-700 dark:text-amber-200",children:[e.jsx("p",{className:"mb-2",children:"VocÃª jÃ¡ possui compromisso neste horÃ¡rio:"}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 bg-opacity-50 p-2 rounded border border-amber-200 dark:border-amber-700",children:[e.jsx("p",{className:"font-semibold",children:E.name}),e.jsx("p",{className:"text-xs",children:E.time})]})]})]})]})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-bold text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx("span",{className:"bg-primary h-6 w-1 rounded mr-2"}),"Selecione uma SessÃ£o"]}),e.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto pr-1",children:m==null?void 0:m.sessions.map(N=>{const M=l.getEnrollment(m.id,N.id),R=!!M,V=N.filled>=N.capacity,B=N.filled/N.capacity*100,_=N.date<new Date().toISOString().split("T")[0];return e.jsx("div",{className:`relative border rounded-lg p-4 transition-all duration-200 
                                ${R?"border-green-500 bg-green-50 dark:bg-green-900/20 ring-1 ring-green-500":V||_?"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 opacity-70":"border-gray-200 dark:border-gray-700 hover:border-primary hover:shadow-md bg-white dark:bg-darkcard"}`,children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-bold text-gray-900 dark:text-white text-lg",children:X(N.date)}),R&&e.jsx("span",{className:"bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200 text-[10px] font-bold px-2 py-0.5 rounded-full uppercase",children:"Inscrito"}),_&&!R&&e.jsx("span",{className:"bg-gray-200 dark:bg-gray-600 text-gray-600 dark:text-gray-300 text-[10px] font-bold px-2 py-0.5 rounded-full uppercase",children:"Encerrado"})]}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 flex items-center gap-4",children:e.jsxs("span",{className:"flex items-center",children:["ðŸ•’ ",N.startTime," - ",N.endTime]})}),e.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${V?"bg-red-500":B>80?"bg-amber-400":"bg-emerald-500"}`,style:{width:`${Math.min(B,100)}%`}})}),e.jsx("span",{className:`text-xs font-bold w-24 text-right ${V?"text-red-600 dark:text-red-400":"text-gray-500 dark:text-gray-400"}`,children:V?"ESGOTADO":m.isTeamEvent?`${N.capacity-N.filled} equipes`:`${N.capacity-N.filled} vagas`})]})]}),e.jsx("div",{className:"flex items-center",children:R?e.jsx("button",{onClick:()=>M&&x(M.id),className:"w-full sm:w-auto bg-white dark:bg-gray-800 border border-red-300 text-red-600 dark:text-red-400 font-bold py-2 px-4 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/30 transition-colors text-sm",children:"Cancelar"}):e.jsx(ne,{onClick:()=>m&&S(m,N.id),isLoading:T,disabled:V||_,className:`w-full sm:w-auto ${V||_?"bg-gray-300 dark:bg-gray-700 text-gray-500 dark:text-gray-400 cursor-not-allowed hover:bg-gray-300":""}`,children:_?"Encerrado":V?"Lotado":"Garantir Vaga"})})]})},N.id)})})]})]})}),e.jsx(qe,{isOpen:!!g,onClose:()=>x(null),onConfirm:()=>g&&j(g),title:"Cancelar InscriÃ§Ã£o",message:"Tem certeza que deseja cancelar sua inscriÃ§Ã£o? A vaga serÃ¡ liberada imediatamente.",confirmText:"Sim, Cancelar",isProcessing:T})]})},Ns=()=>{const[o,t]=p.useState([]),[s,r]=p.useState([]),[a,n]=p.useState(!0);return p.useEffect(()=>{(async()=>{n(!0);const d=await D.getPublicEvents(),l=d.filter(m=>m.hasDedicatedPage).slice(0,3),c=d.filter(m=>!m.hasDedicatedPage).slice(0,8);t(l),r(c),n(!1)})()},[]),e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-darkbg flex flex-col font-sans transition-colors duration-300",children:[e.jsx("nav",{className:"bg-white/80 dark:bg-darkcard/80 backdrop-blur-md border-b border-gray-100 dark:border-gray-700 sticky top-0 z-50 transition-colors",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between h-20 items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-primary/10 dark:bg-primary/20 p-2 rounded-lg",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-primary dark:text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("span",{className:"text-gray-900 dark:text-white font-extrabold text-2xl tracking-tight",children:"EduEvent"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx($,{to:"/login",className:"text-gray-500 dark:text-gray-300 hover:text-primary dark:hover:text-indigo-400 font-medium px-3 py-2 transition-colors",children:"Acessar Painel"})})]})})}),e.jsxs("main",{className:"flex-1 max-w-7xl w-full mx-auto px-4 sm:px-6 lg:px-8 py-12 space-y-16",children:[o.length>0&&e.jsxs("section",{className:"animate-fade-in",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 dark:text-white",children:"Eventos em Destaque"}),e.jsx("p",{className:"mt-2 text-gray-500 dark:text-gray-400",children:"Confira as pÃ¡ginas exclusivas dos nossos principais eventos."})]}),e.jsx("div",{className:"grid gap-8 lg:grid-cols-2",children:o.map(i=>{var d,l,c,m,u;return e.jsxs($,{to:`/special/${i.id}`,className:"group relative bg-white dark:bg-darkcard rounded-2xl shadow-md hover:shadow-2xl transition-all duration-300 overflow-hidden flex flex-col min-h-[300px] border border-gray-100 dark:border-gray-700",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 to-transparent dark:from-primary/20 opacity-50"}),((c=(l=(d=i.dedicatedPageConfig)==null?void 0:d.gallery)==null?void 0:l[0])==null?void 0:c.url)&&e.jsxs("div",{className:"h-48 w-full overflow-hidden relative",children:[e.jsx("img",{src:i.dedicatedPageConfig.gallery[0].url,alt:i.name,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"}),e.jsx("div",{className:"absolute inset-0 bg-black/20 group-hover:bg-black/10 transition-colors"})]}),e.jsxs("div",{className:"p-8 relative z-10 flex flex-col flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-bold bg-amber-100 text-amber-800 dark:bg-amber-900/30 dark:text-amber-300 uppercase tracking-wide",children:"â­ Especial"}),e.jsx("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:X((m=i.sessions[0])==null?void 0:m.date)})]}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2 group-hover:text-primary dark:group-hover:text-indigo-400 transition-colors",children:i.name}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 line-clamp-2 mb-6",children:((u=i.dedicatedPageConfig)==null?void 0:u.presentationText)||i.description}),e.jsxs("div",{className:"mt-auto flex items-center font-bold text-primary dark:text-indigo-400 group-hover:translate-x-1 transition-transform",children:["Ver PÃ¡gina Exclusiva ",e.jsx("span",{className:"ml-2",children:"â†’"})]})]})]},i.id)})})]}),e.jsxs("section",{children:[e.jsxs("div",{className:"mb-6 flex items-end justify-between border-b border-gray-200 dark:border-gray-700 pb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Agenda PÃºblica"}),e.jsx("p",{className:"mt-1 text-gray-500 dark:text-gray-400",children:"PrÃ³ximas atividades abertas Ã  comunidade."})]}),e.jsx($,{to:"/login",className:"hidden sm:block text-primary dark:text-indigo-400 hover:text-indigo-600 font-medium text-sm",children:"Ver todos no painel â†’"})]}),a?e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(i=>e.jsx("div",{className:"bg-white dark:bg-darkcard h-40 rounded-xl animate-pulse"},i))}):s.length===0?e.jsx("div",{className:"text-center py-16 bg-white dark:bg-darkcard rounded-xl border border-dashed border-gray-300 dark:border-gray-700",children:e.jsx("p",{className:"text-gray-400",children:"Nenhum outro evento pÃºblico agendado no momento."})}):e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:s.map(i=>{var m,u;const d=(m=i.sessions[0])!=null&&m.date?new Date(i.sessions[0].date):new Date,l=d.getDate(),c=d.toLocaleString("pt-BR",{month:"short"}).toUpperCase();return e.jsxs("div",{className:"bg-white dark:bg-darkcard rounded-xl shadow-sm hover:shadow-md transition-shadow p-5 border border-gray-100 dark:border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 rounded-lg p-2 text-center min-w-[50px]",children:[e.jsx("span",{className:"block text-xs font-bold",children:c}),e.jsx("span",{className:"block text-lg font-extrabold leading-none",children:l})]}),e.jsx($,{to:"/login",className:"bg-primary/10 text-primary hover:bg-primary hover:text-white dark:text-indigo-400 dark:hover:bg-indigo-600 dark:hover:text-white px-3 py-1 rounded-full text-xs font-bold transition-colors",children:"Inscrever"})]}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2 line-clamp-2",children:i.name}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm line-clamp-2 mb-4 flex-1",children:i.description}),e.jsxs("div",{className:"text-xs text-gray-400 dark:text-gray-500 flex items-center",children:[e.jsxs("span",{className:"mr-2",children:["ðŸ“ ",i.location]}),e.jsxs("span",{children:["ðŸ•’ ",(u=i.sessions[0])==null?void 0:u.startTime]})]})]},i.id)})})]})]}),e.jsx("footer",{className:"bg-white dark:bg-darkcard border-t border-gray-200 dark:border-gray-700 mt-auto",children:e.jsxs("div",{className:"max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8 flex flex-col md:flex-row justify-between items-center",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Â© 2024 EduEvent. Todos os direitos reservados."}),e.jsxs("div",{className:"flex space-x-6 mt-4 md:mt-0",children:[e.jsx("a",{href:"#",className:"text-gray-400 hover:text-gray-500",children:"Contato"}),e.jsx("a",{href:"#",className:"text-gray-400 hover:text-gray-500",children:"Privacidade"}),e.jsx($,{to:"/login",className:"text-gray-400 hover:text-primary",children:"Ãrea do Aluno"})]})]})})]})},ks=()=>{var w,v,k,y,S,j,T;const{id:o}=st(),[t,s]=p.useState(null),[r,a]=p.useState([]),[n,i]=p.useState(!0),[d,l]=p.useState("about");p.useEffect(()=>{(async()=>{if(o)try{const[C,A]=await Promise.all([D.getEventById(o),D.getEventsByParentId(o)]);s(C||null),a(A)}catch(C){console.error("Failed to load dedicated page data",C)}finally{i(!1)}})()},[o]);const c=p.useMemo(()=>{var R,V;if(!t)return[];const E=((R=t.dedicatedPageConfig)==null?void 0:R.schedule)||[],C=[];r.forEach(B=>{B.sessions.forEach(_=>{C.push({id:`sub_${B.id}_${_.id}`,time:_.startTime,title:B.name,description:`${B.description||""} â€¢ Local: ${B.location||"NÃ£o informado"}`,dateLabel:Xe(_.date)})})});const A=(V=t.sessions[0])!=null&&V.date?Xe(t.sessions[0].date):"";return[...E.map(B=>({...B,dateLabel:B.id.startsWith("sub_")?void 0:A})),...C].sort((B,_)=>B.dateLabel!==_.dateLabel?(B.dateLabel||"").localeCompare(_.dateLabel||""):B.time.localeCompare(_.time))},[t,r]),m=p.useMemo(()=>{const E={};return c.forEach(C=>{const A=C.dateLabel||"Data a definir";E[A]||(E[A]=[]),E[A].push(C)}),E},[c]);if(n)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-darkbg text-gray-500",children:"Carregando evento..."});if(!t||!t.hasDedicatedPage)return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-50 dark:bg-darkbg px-4 text-center",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-800 dark:text-white mb-4",children:"PÃ¡gina nÃ£o encontrada"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"Este evento nÃ£o possui uma pÃ¡gina dedicada ou nÃ£o existe."}),e.jsx($,{to:"/",className:"text-primary hover:underline",children:"Voltar para Home"})]});const u=t.dedicatedPageConfig||{gallery:[]},g=u.themeColor||"#4F46E5",x={"--theme-color":g};return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-darkbg text-gray-900 dark:text-gray-100 font-sans selection:bg-opacity-30 selection:bg-[var(--theme-color)]",style:x,children:[e.jsxs("header",{className:"relative bg-darkbg text-white overflow-hidden min-h-[55vh] flex flex-col justify-end pb-12",children:[((v=(w=u.gallery)==null?void 0:w[0])==null?void 0:v.url)&&e.jsxs("div",{className:"absolute inset-0 z-0",children:[e.jsx("img",{src:u.gallery[0].url,alt:"Background",className:"w-full h-full object-cover opacity-40 blur-sm scale-105 transform origin-center animate-fade-in"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-darkbg via-darkbg/60 to-transparent"})]}),e.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-6 w-full animate-slide-in",children:[e.jsxs($,{to:"/",className:"inline-flex items-center mb-8 text-white/70 hover:text-white transition-colors text-sm font-medium group",children:[e.jsx("span",{className:"mr-2 group-hover:-translate-x-1 transition-transform",children:"â†"})," Voltar para Eventos"]}),e.jsx("div",{className:"flex flex-col lg:flex-row lg:items-end lg:justify-between gap-6",children:e.jsxs("div",{className:"max-w-4xl",children:[e.jsx("span",{className:"inline-block py-1 px-3 rounded text-[10px] font-bold tracking-widest mb-4 uppercase text-white bg-[var(--theme-color)] shadow-lg shadow-[var(--theme-color)]/20",children:"Evento em Destaque"}),e.jsx("h1",{className:"text-4xl md:text-6xl lg:text-7xl font-extrabold tracking-tight mb-4 leading-tight text-white drop-shadow-sm",children:t.name}),e.jsx("p",{className:"text-lg md:text-xl text-white/80 font-light max-w-2xl leading-relaxed",children:t.description})]})})]})]}),e.jsx("div",{className:"sticky top-0 z-40 bg-white/90 dark:bg-darkcard/90 backdrop-blur-md shadow-sm border-b border-gray-200 dark:border-gray-700",children:e.jsx("div",{className:"max-w-7xl mx-auto px-6",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsx("nav",{className:"flex space-x-1 h-full overflow-x-auto no-scrollbar",children:["about","schedule","gallery"].map(E=>e.jsxs("button",{onClick:()=>l(E),className:`relative px-5 inline-flex items-center h-full text-xs font-bold uppercase tracking-widest transition-all whitespace-nowrap
                                        ${d===E?"text-[var(--theme-color)]":"text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200"}`,children:[E==="about"&&"VisÃ£o Geral",E==="schedule"&&"Cronograma",E==="gallery"&&"Galeria",d===E&&e.jsx("span",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-[var(--theme-color)] shadow-[0_0_10px_var(--theme-color)]"})]},E))}),e.jsx("div",{className:"hidden md:flex items-center pl-6 border-l border-gray-200 dark:border-gray-700",children:e.jsx($,{to:"/login",className:"inline-flex items-center justify-center px-6 py-2 rounded-full font-bold text-white text-sm shadow-lg transform transition hover:-translate-y-0.5 active:translate-y-0 hover:shadow-xl",style:{backgroundColor:g},children:"Garantir Vaga"})})]})})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-6 py-12 animate-fade-in min-h-[40vh]",children:[d==="about"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-12",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-12",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-3xl font-bold mb-6 text-gray-900 dark:text-white",children:"Sobre o Evento"}),e.jsx("div",{className:"prose dark:prose-invert prose-lg max-w-none text-gray-600 dark:text-gray-300 leading-relaxed",children:e.jsx("p",{className:"whitespace-pre-line",children:u.presentationText||"Junte-se a nÃ³s para uma experiÃªncia inesquecÃ­vel. Este evento foi cuidadosamente planejado para oferecer o melhor conteÃºdo e oportunidades de networking."})})]}),r.length>0&&e.jsxs("section",{className:"pt-8 border-t border-gray-100 dark:border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Destaques da ProgramaÃ§Ã£o"}),e.jsx("button",{onClick:()=>l("schedule"),className:"text-sm font-bold text-[var(--theme-color)] hover:underline hidden sm:block",children:"Ver tudo â†’"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:r.map(E=>e.jsxs("div",{className:"group relative bg-white dark:bg-darkcard rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-gray-700 hover:shadow-xl hover:border-transparent transition-all duration-300 flex flex-col justify-between overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-[var(--theme-color)] to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("span",{className:"inline-block px-2 py-1 rounded bg-gray-50 dark:bg-gray-800 text-[10px] font-bold uppercase tracking-wider text-gray-500 dark:text-gray-400",children:"Atividade"}),e.jsx("span",{className:"text-[var(--theme-color)] opacity-0 group-hover:opacity-100 transform translate-x-2 group-hover:translate-x-0 transition-all duration-300",children:"â†—"})]}),e.jsx("h4",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2 leading-tight group-hover:text-[var(--theme-color)] transition-colors",children:E.name}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 line-clamp-3 mb-4 leading-relaxed",children:E.description})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-50 dark:border-gray-800 flex items-center justify-between text-xs font-medium text-gray-400 dark:text-gray-500",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),E.sessions.length>0?E.sessions[0].startTime:"TBA"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("svg",{className:"w-4 h-4 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),E.location]})]})]},E.id))})]})]}),e.jsx("div",{className:"lg:col-span-4 space-y-8",children:e.jsxs("div",{className:"bg-white dark:bg-darkcard rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 p-8 sticky top-24",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-6 pb-4 border-b border-gray-100 dark:border-gray-700",children:"InformaÃ§Ãµes do Evento"}),e.jsxs("ul",{className:"space-y-6",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-gray-50 dark:bg-gray-800 flex items-center justify-center text-xl mr-4",children:"ðŸ“…"}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs font-bold uppercase text-gray-400 mb-0.5",children:"Data Principal"}),e.jsx("span",{className:"block text-gray-900 dark:text-white font-medium",children:X((k=t.sessions[0])==null?void 0:k.date)})]})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-gray-50 dark:bg-gray-800 flex items-center justify-center text-xl mr-4",children:"ðŸ•’"}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs font-bold uppercase text-gray-400 mb-0.5",children:"HorÃ¡rio"}),e.jsxs("span",{className:"block text-gray-900 dark:text-white font-medium",children:[(y=t.sessions[0])==null?void 0:y.startTime," Ã s ",(S=t.sessions[0])==null?void 0:S.endTime]})]})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-gray-50 dark:bg-gray-800 flex items-center justify-center text-xl mr-4",children:"ðŸ“"}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs font-bold uppercase text-gray-400 mb-0.5",children:"LocalizaÃ§Ã£o"}),e.jsx("span",{className:"block text-gray-900 dark:text-white font-medium",children:t.location})]})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-gray-50 dark:bg-gray-800 flex items-center justify-center text-xl mr-4",children:"ðŸ‘¥"}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs font-bold uppercase text-gray-400 mb-0.5",children:"Capacidade"}),e.jsxs("span",{className:"block text-gray-900 dark:text-white font-medium",children:[t.sessions.reduce((E,C)=>E+C.capacity,0)," vagas totais"]})]})]})]}),e.jsx("div",{className:"mt-8 pt-6 border-t border-gray-100 dark:border-gray-700",children:e.jsx($,{to:"/login",className:"w-full flex items-center justify-center px-4 py-3 rounded-xl font-bold text-white shadow-lg transition transform hover:scale-[1.02]",style:{backgroundColor:g},children:"Inscrever-se"})})]})})]}),d==="schedule"&&e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Cronograma Completo"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"Acompanhe todos os horÃ¡rios e atividades."})]}),Object.keys(m).length===0?e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-12 rounded-2xl text-center border-2 border-dashed border-gray-200 dark:border-gray-700",children:e.jsx("p",{className:"text-gray-500",children:"ProgramaÃ§Ã£o detalhada em breve."})}):e.jsx("div",{className:"space-y-16",children:Object.entries(m).map(([E,C])=>{const A=C;return e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"sticky top-20 z-20 bg-gray-50/95 dark:bg-darkbg/95 backdrop-blur-sm py-4 mb-8 border-b border-gray-200 dark:border-gray-700 flex items-center",children:[e.jsxs("span",{className:"px-3 py-1 rounded bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 text-sm font-bold shadow-sm mr-3",children:[E.split(",")[0]," "]}),e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:[E.split(",")[1]," "]})]}),e.jsx("div",{className:"relative border-l-2 border-gray-200 dark:border-gray-800 ml-4 md:ml-6 space-y-12 pb-4",children:A.map((N,M)=>e.jsxs("div",{className:"relative pl-8 md:pl-12 group",children:[e.jsx("div",{className:"absolute -left-[9px] top-1.5 h-[18px] w-[18px] rounded-full border-4 border-white dark:border-darkbg shadow-sm transition-transform group-hover:scale-125",style:{backgroundColor:g}}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-baseline gap-2 md:gap-8 mb-2",children:[e.jsx("div",{className:"flex-shrink-0 w-20 pt-1",children:e.jsx("span",{className:"text-lg font-black text-gray-900 dark:text-white",children:N.time})}),e.jsxs("div",{className:"flex-1 bg-white dark:bg-darkcard p-5 rounded-xl border border-gray-100 dark:border-gray-800 shadow-sm group-hover:shadow-md transition-shadow",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-1 group-hover:text-[var(--theme-color)] transition-colors",children:N.title}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 leading-relaxed text-sm whitespace-pre-line",children:N.description})]})]})]},M))})]},E)})})]}),d==="gallery"&&e.jsxs("div",{children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Galeria de Fotos"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"Momentos marcantes."})]}),((j=u.gallery)==null?void 0:j.length)===0?e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-12 rounded-2xl text-center border-2 border-dashed border-gray-200 dark:border-gray-700",children:e.jsx("p",{className:"text-gray-500",children:"Imagens indisponÃ­veis no momento."})}):e.jsx("div",{className:"columns-1 md:columns-2 lg:columns-3 gap-6 space-y-6",children:(T=u.gallery)==null?void 0:T.map((E,C)=>e.jsxs("div",{className:"break-inside-avoid group relative rounded-2xl overflow-hidden shadow-md cursor-zoom-in",children:[e.jsx("img",{src:E.url,alt:E.caption||`Imagem ${C+1}`,className:"w-full h-auto object-cover transition-transform duration-700 group-hover:scale-105"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-6",children:E.caption&&e.jsx("p",{className:"text-white font-medium transform translate-y-4 group-hover:translate-y-0 transition-transform duration-300",children:E.caption})})]},C))})]})]}),e.jsx("div",{className:"md:hidden fixed bottom-6 right-6 z-50 animate-bounce-slow",children:e.jsx($,{to:"/login",className:"flex items-center justify-center w-14 h-14 rounded-full text-white shadow-xl shadow-indigo-900/20 hover:scale-110 transition-transform",style:{backgroundColor:g},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})})]})},Es=(o,t)=>{const{addToast:s}=ve(),[r,a]=p.useState([]),[n,i]=p.useState(null),[d,l]=p.useState(!1),[c,m]=p.useState({}),[u,g]=p.useState({}),x=p.useRef(new Set),w=p.useCallback(async j=>{if(o){l(!0);try{const[T,E]=await Promise.all([D.getTeamsForEvent(j),D.getEnrollmentsForUser(o.uid)]);a(T),t&&t();const A=[...new Set(T.map(M=>M.captainId))].filter(M=>!x.current.has(M));if(A.length>0){const M={};await Promise.all(A.map(async R=>{try{const V=await D.getUserProfile(R);V&&(M[R]=V,x.current.add(R))}catch{console.error("Error fetching captain",R)}})),Object.keys(M).length>0&&m(R=>({...R,...M}))}const N=E.find(M=>M.eventId===j&&M.status===J.CONFIRMED);if(N&&N.teamId){const M=T.find(R=>R.id===N.teamId);i(M||null)}else i(null)}catch(T){console.error(T)}finally{l(!1)}}},[o,t]);return p.useEffect(()=>{(async()=>{if(n&&n.members.length>0){const T={},E=n.members.filter(C=>!x.current.has(C));await Promise.all(E.map(async C=>{if(o&&o.uid===C){T[C]=o,x.current.add(C);return}try{const A=await D.getUserProfile(C);A&&(T[C]=A,x.current.add(C))}catch{console.error("Error fetching member",C)}})),Object.keys(T).length>0&&g(C=>({...C,...T}))}})()},[n,o]),{teams:r,myTeam:n,loading:d,captainProfiles:c,memberProfiles:u,loadTeams:w,createTeam:async(j,T)=>{if(!o)return null;l(!0);try{const E=await D.createTeam(j,T,o);return await w(j),E}catch(E){throw E}finally{l(!1)}},joinTeam:async j=>{if(o){l(!0);try{await D.joinTeam(j.id,o,j.code),await w(j.eventId)}catch(T){throw T}finally{l(!1)}}},leaveTeam:async()=>{if(!(!o||!n)){l(!0);try{const j=n.eventId;await D.leaveTeam(n.id,o.uid),await w(j)}catch(j){throw j}finally{l(!1)}}},kickMember:async j=>{if(n){l(!0);try{await D.kickMember(n.id,j),await w(n.eventId)}catch(T){throw T}finally{l(!1)}}}}},Ss=(o,t)=>{switch(t.type){case"CLOSE":return{type:"NONE"};case"OPEN_ENROLL":return{type:"ENROLL",data:t.payload};case"OPEN_TEAM_SUCCESS":return{type:"TEAM_SUCCESS",data:t.payload};case"OPEN_TEAM_INPUT":return{type:"TEAM_INPUT",data:t.payload};case"OPEN_TEAM_CONFIRM":return{type:"TEAM_CONFIRM",data:t.payload};default:return o}},Is=()=>{var We,Ge,He;const{id:o}=st(),[t,s]=Et(),r=t.get("join_code"),{user:a}=re(),n=Ne(),{addToast:i}=ve(),[d,l]=p.useState(null),[c,m]=p.useState([]),[u,g]=p.useState([]),[x,w]=p.useState([]),[v,k]=p.useState(!0),[y,S]=p.useState(null),[j,T]=p.useReducer(Ss,{type:"NONE"}),[E,C]=p.useState(""),[A,N]=p.useState("join"),M=p.useCallback(async(b=!0)=>{if(!(!o||!a)){b&&k(!0);try{const[I,O,G,ee]=await Promise.all([D.getEventById(o),D.getEventsByParentId(o),D.getEnrollmentsForUser(a.uid),D.getClasses()]);if(!I){n("/dashboard");return}l(I),m(O),g(G),w(ee)}catch(I){console.error(I)}finally{b&&k(!1)}}},[o,a,n]),R=p.useCallback(()=>{M(!1),S(null)},[M]),{handleEnroll:V,handleCancel:B,isProcessing:_,conflictData:me,clearState:xt}=ct(a,R),{teams:be,myTeam:Y,loading:Te,captainProfiles:ue,memberProfiles:_e,loadTeams:Ae,createTeam:ht,joinTeam:gt,leaveTeam:ft,kickMember:pt}=Es(a,R);p.useEffect(()=>{M()},[M]),p.useEffect(()=>{if(j.type==="ENROLL"&&j.data){const I=[d,...c].filter(Boolean).find(O=>O.id===j.data.id);I&&JSON.stringify(I)!==JSON.stringify(j.data)&&T({type:"OPEN_ENROLL",payload:I})}},[d,c,j.type,j.data]),p.useEffect(()=>{if(r&&d&&!v){let b;d.isTeamEvent?b=d:b=c.find(I=>I.isTeamEvent),b&&j.type==="NONE"&&(T({type:"OPEN_ENROLL",payload:b}),N("join"),Ae(b.id))}},[r,d,c,v,Ae,j.type]),p.useEffect(()=>{if(r&&be.length>0&&j.type==="ENROLL"){const b=be.find(I=>I.code===r);b&&(u.some(O=>O.eventId===b.eventId&&O.teamId===b.id)||(T({type:"OPEN_TEAM_CONFIRM",payload:b}),s(O=>{const G=new URLSearchParams(O);return G.delete("join_code"),G},{replace:!0})))}},[r,be,j.type,u,s]);const Me=b=>{var I;return b?((I=x.find(O=>O.id===b))==null?void 0:I.name)||"Desconhecida":"N/A"},ye=async b=>{try{await navigator.clipboard.writeText(b),i("success","CÃ³digo copiado!")}catch{i("error","Erro ao copiar.")}},ze=async b=>{const I=`${window.location.origin}/#/event/${o}?join_code=${b.code}`;if(navigator.share)try{await navigator.share({title:`Junte-se Ã  minha equipe: ${b.name}`,text:`Use o cÃ³digo ${b.code} ou clique no link para entrar:`,url:I})}catch{await ye(I),i("success","Link copiado!")}else await ye(I),i("success","Link copiado!")},vt=async b=>{const I=j.type==="ENROLL"?j.data:null;if(I)try{const O=await ht(I.id,b);O&&(T({type:"OPEN_TEAM_SUCCESS",payload:O}),i("success","Equipe criada com sucesso!"))}catch(O){i("error",O.message)}},bt=async()=>{const b=j.type==="TEAM_CONFIRM"?j.data:null;if(b)try{await gt(b),i("success","VocÃª entrou na equipe!"),T({type:"CLOSE"})}catch(I){i("error",I.message)}},yt=async()=>{try{await ft(),i("success","VocÃª saiu da equipe.")}catch(b){i("error",b.message)}},wt=async b=>{try{await pt(b),i("success","Membro removido.")}catch(I){i("error",I.message)}},jt=b=>{C(""),T({type:"OPEN_TEAM_INPUT",payload:b})},Nt=()=>{const b=j.type==="TEAM_INPUT"?j.data:null;if(b){if(E.toUpperCase()!==b.code){i("error","CÃ³digo incorreto.");return}T({type:"OPEN_TEAM_CONFIRM",payload:b})}},Be=b=>{xt(),T({type:"OPEN_ENROLL",payload:b}),b.isTeamEvent&&(N("join"),Ae(b.id))},Ve=(b,I)=>u.find(O=>O.eventId===b&&O.sessionId===I),oe=()=>T({type:"CLOSE"});if(v)return e.jsx("div",{className:"p-12 text-center text-gray-500 dark:text-gray-400 font-medium",children:"Carregando detalhes do evento..."});if(!d)return e.jsx("div",{className:"p-12 text-center text-red-500 dark:text-red-400 font-bold",children:"Evento nÃ£o encontrado."});const Q=j.type==="ENROLL"?j.data:null,we=j.type==="TEAM_SUCCESS"?j.data:null,Le=j.type==="TEAM_INPUT"?j.data:null,xe=j.type==="TEAM_CONFIRM"?j.data:null;return e.jsxs("div",{className:"space-y-8 pb-12",children:[e.jsx("nav",{className:"flex","aria-label":"Breadcrumb",children:e.jsxs("ol",{className:"flex items-center space-x-2",children:[e.jsx("li",{children:e.jsx($,{to:"/dashboard",className:"text-gray-500 dark:text-gray-400 hover:text-primary dark:hover:text-indigo-400 font-medium transition",children:"Eventos"})}),e.jsx("li",{children:e.jsx("span",{className:"text-gray-300 dark:text-gray-600",children:"/"})}),e.jsx("li",{className:"text-gray-900 dark:text-white font-semibold","aria-current":"page",children:d.name})]})}),e.jsxs("div",{className:"bg-white dark:bg-darkcard rounded-2xl shadow-md overflow-hidden border border-gray-100 dark:border-gray-700 relative",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-primary to-indigo-400"}),e.jsx("div",{className:"p-8 md:p-10",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-start gap-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("div",{className:"inline-block px-3 py-1 rounded-full bg-indigo-50 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 text-xs font-bold uppercase tracking-wide border border-indigo-100 dark:border-indigo-900/50",children:"Evento Principal"}),d.isTeamEvent&&e.jsx("div",{className:"inline-block px-3 py-1 rounded-full bg-purple-50 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 text-xs font-bold uppercase tracking-wide border border-purple-100 dark:border-purple-900/50",children:"ðŸ† Evento por Equipe"})]}),e.jsx("h1",{className:"text-3xl md:text-4xl font-extrabold text-gray-900 dark:text-white mb-4 leading-tight",children:d.name}),e.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 leading-relaxed mb-6 max-w-4xl",children:d.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-6 text-gray-500 dark:text-gray-400 text-sm font-medium",children:[e.jsxs("div",{className:"flex items-center bg-gray-50 dark:bg-gray-800 px-3 py-1.5 rounded-lg",children:[e.jsx("span",{className:"mr-2 text-xl",children:"ðŸ“"})," ",d.location]}),e.jsxs("div",{className:"flex items-center bg-gray-50 dark:bg-gray-800 px-3 py-1.5 rounded-lg",children:[e.jsx("span",{className:"mr-2 text-xl",children:"ðŸ“…"})," ",d.sessions.length," SessÃµes Principais"]})]})]}),d.sessions.length>0&&e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("button",{onClick:()=>Be(d),className:"w-full md:w-auto bg-primary hover:bg-indigo-700 text-white px-6 py-3 rounded-xl font-bold shadow-lg shadow-indigo-200 dark:shadow-none transition transform hover:-translate-y-1 flex items-center justify-center",children:["Ver ProgramaÃ§Ã£o",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7 7"})})]})})]})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Atividades & Sub-eventos"}),e.jsx("div",{className:"h-px bg-gray-200 dark:bg-gray-700 flex-1"})]}),c.length===0?e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 border-2 border-dashed border-gray-200 dark:border-gray-700 rounded-xl p-12 text-center",children:[e.jsx("div",{className:"text-4xl mb-3 opacity-30",children:"ðŸ“‚"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"Nenhuma atividade especÃ­fica cadastrada para este evento ainda."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:c.map(b=>{const I=b.sessions.length===1?b.sessions[0]:null,O=I?I.capacity:0,G=I?I.filled:0,ee=O>0?G/O*100:0,De=O>0&&G>=O,Je=b.sessions.some(kt=>Ve(b.id,kt.id));return e.jsxs("div",{className:"group bg-white dark:bg-darkcard rounded-xl shadow-sm hover:shadow-xl transition-all duration-300 overflow-hidden border border-gray-100 dark:border-gray-700 flex flex-col relative",children:[e.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-gray-200 dark:bg-gray-700 group-hover:bg-primary transition-colors"}),e.jsxs("div",{className:"p-6 flex-1 flex flex-col ml-1",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white group-hover:text-primary dark:group-hover:text-indigo-400 transition-colors",children:b.name}),b.isTeamEvent&&e.jsx("span",{className:"text-[10px] bg-purple-100 text-purple-800 px-2 py-0.5 rounded-full font-bold",children:"EQUIPE"})]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm line-clamp-3 mb-4 flex-1",children:b.description}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-300 mt-auto pt-4 border-t border-gray-50 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"w-6 text-center mr-2 text-gray-400 dark:text-gray-500",children:"ðŸ“"}),e.jsx("span",{className:"font-medium",children:b.location})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"w-6 text-center mr-2 text-gray-400 dark:text-gray-500",children:"ðŸ“…"}),e.jsx("span",{className:"font-medium",children:b.sessions.length>1?`${b.sessions.length} opÃ§Ãµes de horÃ¡rio`:`${X(I==null?void 0:I.date)} â€¢ ${I==null?void 0:I.startTime}`})]})]}),I&&e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"flex justify-between text-xs mb-1 font-bold",children:e.jsx("span",{className:De?"text-red-600 dark:text-red-400":"text-gray-500 dark:text-gray-400",children:De?"LOTADO":b.isTeamEvent?`${O-G} equipes restantes`:`${O-G} vagas`})}),e.jsx("div",{className:"w-full bg-gray-100 dark:bg-gray-700 rounded-full h-1.5",children:e.jsx("div",{className:`h-full rounded-full ${De?"bg-red-500":"bg-emerald-500"}`,style:{width:`${ee}%`}})})]})]}),e.jsx("button",{onClick:()=>Be(b),className:`w-full py-3 font-bold text-sm transition-colors border-t border-gray-100 dark:border-gray-700 ${Je?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400 hover:bg-green-100 dark:hover:bg-green-900/40":"bg-gray-50 dark:bg-gray-800/50 hover:bg-primary hover:text-white dark:hover:bg-indigo-600 dark:hover:text-white text-primary dark:text-indigo-300"}`,children:Je?"Gerenciar InscriÃ§Ã£o":"Inscrever-se Agora"})]},b.id)})}),e.jsx(ce,{isOpen:j.type==="ENROLL",onClose:oe,title:Q?Q.name:"",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:e.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed",children:Q==null?void 0:Q.description})}),me&&e.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/30 border-l-4 border-amber-400 p-4 rounded-r-md",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-amber-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-bold text-amber-800 dark:text-amber-300",children:"Conflito de HorÃ¡rio"}),e.jsxs("div",{className:"mt-2 text-sm text-amber-700 dark:text-amber-200",children:[e.jsx("p",{className:"mb-2",children:"VocÃª jÃ¡ possui compromisso neste horÃ¡rio:"}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 bg-opacity-50 p-2 rounded border border-amber-200 dark:border-amber-700",children:[e.jsx("p",{className:"font-semibold",children:me.name}),e.jsx("p",{className:"text-xs",children:me.time})]})]})]})]})}),Q!=null&&Q.isTeamEvent?e.jsx("div",{className:"animate-fade-in",children:Y?e.jsxs("div",{className:"bg-white dark:bg-darkcard border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 p-6 text-white relative",children:[e.jsx("div",{className:"absolute top-4 right-4 bg-white/20 backdrop-blur rounded-full px-3 py-1 text-xs font-bold uppercase tracking-wider",children:"Minha Equipe"}),e.jsx("h3",{className:"text-2xl md:text-3xl font-extrabold mb-1 pr-24 md:pr-0",children:Y.name}),e.jsx("div",{className:"flex items-center gap-2 opacity-90 text-sm",children:e.jsxs("span",{children:["CapitÃ£o: ",Y.captainId===(a==null?void 0:a.uid)?"VocÃª":((We=ue[Y.captainId])==null?void 0:We.name)||"Desconhecido"]})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1",children:"CÃ³digo de Acesso"}),e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 dark:bg-gray-800 px-3 py-1 rounded border border-gray-200 dark:border-gray-700",children:[e.jsx("code",{className:"text-2xl font-mono font-bold text-primary dark:text-indigo-400 tracking-wide select-all",children:Y.code}),e.jsx("button",{onClick:()=>ye(Y.code),className:"p-1.5 text-gray-500 hover:text-indigo-600 dark:text-gray-400 dark:hover:text-indigo-300 transition-colors",title:"Copiar cÃ³digo",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),e.jsx("div",{className:"h-6 w-px bg-gray-300 dark:bg-gray-600 mx-1"}),e.jsx("button",{onClick:()=>ze(Y),className:"p-1.5 text-gray-500 hover:text-indigo-600 dark:text-gray-400 dark:hover:text-indigo-300 transition-colors",title:"Compartilhar Link",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})})})]})]}),e.jsxs("div",{className:"w-full md:w-auto text-left md:text-right",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1",children:"Membros"}),e.jsx("span",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:Y.members.length})]})]}),e.jsxs("div",{className:"border-t border-gray-100 dark:border-gray-700 pt-4",children:[e.jsx("h4",{className:"font-bold text-gray-900 dark:text-white mb-3 text-sm",children:"Integrantes"}),e.jsx("ul",{className:"space-y-2 mb-6",children:Y.members.map(b=>{var I,O,G,ee;return e.jsxs("li",{className:"flex justify-between items-center text-sm p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center text-primary dark:text-indigo-300 font-bold text-xs",children:(((I=_e[b])==null?void 0:I.name)||((O=ue[b])==null?void 0:O.name)||"U").charAt(0)}),e.jsxs("span",{className:`text-gray-700 dark:text-gray-300 ${b===(a==null?void 0:a.uid)?"font-bold":""}`,children:[b===(a==null?void 0:a.uid)?"VocÃª":((G=_e[b])==null?void 0:G.name)||((ee=ue[b])==null?void 0:ee.name)||"UsuÃ¡rio...",b===Y.captainId&&" ðŸ‘‘"]})]}),Y.captainId===(a==null?void 0:a.uid)&&b!==(a==null?void 0:a.uid)&&e.jsx("button",{onClick:()=>wt(b),className:"text-red-500 hover:text-red-700 text-xs font-bold px-2 py-1 rounded hover:bg-red-50 dark:hover:bg-red-900/20",children:"Remover"})]},b)})}),e.jsx(ne,{onClick:yt,isLoading:Te,variant:"danger",className:"w-full",children:Y.captainId===(a==null?void 0:a.uid)?"Desfazer Equipe e Sair":"Sair da Equipe"})]})]})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex p-1 bg-gray-100 dark:bg-gray-800 rounded-lg mb-6",children:[e.jsx("button",{onClick:()=>N("join"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-all ${A==="join"?"bg-white dark:bg-darkcard text-primary shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,children:"Entrar em Equipe"}),e.jsx("button",{onClick:()=>N("create"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-all ${A==="create"?"bg-white dark:bg-darkcard text-primary shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,children:"Criar Nova Equipe"})]}),A==="join"&&e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 gap-3 max-h-[300px] overflow-y-auto pr-1",children:be.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[e.jsx("span",{className:"text-2xl block mb-2",children:"ðŸ›¡ï¸"}),e.jsxs("p",{children:["Nenhuma equipe criada ainda.",e.jsx("br",{}),"Seja o primeiro a criar!"]})]}):be.map(b=>{var I;return e.jsxs("div",{className:"group bg-white dark:bg-darkcard border border-gray-200 dark:border-gray-700 rounded-xl p-4 flex flex-col sm:flex-row justify-between items-start sm:items-center hover:shadow-md hover:border-primary/30 transition-all cursor-default gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 flex items-center justify-center text-lg flex-shrink-0",children:"ðŸ›¡ï¸"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("span",{className:"font-bold text-gray-900 dark:text-white block truncate",children:b.name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400 mt-0.5 flex-wrap",children:[e.jsxs("span",{children:["CapitÃ£o: ",((I=ue[b.captainId])==null?void 0:I.name)||"..."]}),e.jsx("span",{className:"w-1 h-1 bg-gray-300 rounded-full hidden sm:block"}),e.jsxs("span",{className:"flex items-center text-primary dark:text-indigo-400 font-bold bg-primary/10 dark:bg-indigo-900/30 px-1.5 py-0.5 rounded",children:[b.members.length," membros"]})]})]})]}),e.jsx("button",{onClick:()=>jt(b),className:"w-full sm:w-auto px-4 py-2 bg-gray-50 dark:bg-gray-800 text-primary dark:text-indigo-400 font-bold text-sm rounded-lg hover:bg-primary hover:text-white dark:hover:bg-indigo-600 dark:hover:text-white transition-colors",children:"Entrar"})]},b.id)})})}),A==="create"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"Escolha um horÃ¡rio disponÃ­vel para registrar sua equipe:"}),e.jsx("div",{className:"space-y-3 max-h-[300px] overflow-y-auto pr-1",children:Q.sessions.map(b=>{const I=b.filled>=b.capacity;return e.jsxs("div",{className:`p-4 border rounded-xl flex flex-col sm:flex-row justify-between items-start sm:items-center transition-all ${I?"bg-gray-50 border-gray-200 opacity-60":"bg-white dark:bg-darkcard border-gray-200 dark:border-gray-700 hover:border-primary/50 hover:shadow-sm"}`,children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx("span",{children:X(b.date)}),e.jsx("span",{className:"text-xs font-normal text-gray-400",children:"|"}),e.jsxs("span",{children:[b.startTime," - ",b.endTime]})]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:I?"Esgotado":`${b.capacity-b.filled} slots disponÃ­veis`})]}),e.jsx(ne,{onClick:()=>vt(b.id),isLoading:Te,disabled:I,className:`w-full sm:w-auto mt-3 sm:mt-0 ${I?"bg-gray-300 text-gray-500":"bg-primary"}`,variant:I?"outline":"primary",children:I?"Lotado":"Criar Aqui"})]},b.id)})})]})]})}):e.jsxs("div",{children:[e.jsxs("h4",{className:"font-bold text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx("span",{className:"bg-primary h-6 w-1 rounded mr-2"}),"Selecione uma SessÃ£o"]}),e.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto pr-1",children:Q==null?void 0:Q.sessions.map(b=>{const I=Ve(Q.id,b.id),O=!!I,G=b.filled>=b.capacity,ee=b.filled/b.capacity*100;return e.jsx("div",{className:`relative border rounded-lg p-4 transition-all ${O?"border-green-500 bg-green-50 dark:bg-green-900/20 ring-1 ring-green-500":G?"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 opacity-90":"border-gray-200 dark:border-gray-700 hover:border-primary hover:shadow-md bg-white dark:bg-darkcard"}`,children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-bold text-gray-900 dark:text-white text-lg",children:X(b.date)}),O&&e.jsx("span",{className:"bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200 text-[10px] font-bold px-2 py-0.5 rounded-full uppercase",children:"Inscrito"})]}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 flex items-center gap-4",children:e.jsxs("span",{className:"flex items-center",children:["ðŸ•’ ",b.startTime," - ",b.endTime]})}),e.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${G?"bg-red-500":ee>80?"bg-amber-500":"bg-emerald-500"}`,style:{width:`${Math.min(ee,100)}%`}})}),e.jsx("span",{className:`text-xs font-bold w-24 text-right ${G?"text-red-600 dark:text-red-400":"text-gray-500 dark:text-gray-400"}`,children:G?"ESGOTADO":Q.isTeamEvent?`${b.capacity-b.filled} equipes`:`${b.capacity-b.filled} vagas`})]})]}),e.jsx("div",{className:"flex items-center",children:O?e.jsx("button",{onClick:()=>I&&S(I.id),className:"w-full sm:w-auto bg-white dark:bg-gray-800 border border-red-300 dark:border-red-900 text-red-600 dark:text-red-400 font-bold py-2 px-4 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/30 transition-colors text-sm",children:"Cancelar"}):e.jsx(ne,{onClick:()=>Q&&V(Q,b.id),isLoading:_,disabled:G,className:`w-full sm:w-auto ${G?"bg-gray-300 dark:bg-gray-700 text-gray-500 dark:text-gray-400 cursor-not-allowed":""}`,children:G?"Lotado":"Inscrever"})})]})},b.id)})})]})]})}),e.jsx(ce,{isOpen:j.type==="TEAM_SUCCESS",onClose:oe,title:"Dados da Equipe Criada",children:we&&a&&e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border border-green-200 dark:border-green-900/50 text-center",children:[e.jsx("span",{className:"text-2xl mb-2 block",children:"ðŸŽ‰"}),e.jsx("h3",{className:"text-lg font-bold text-green-800 dark:text-green-300",children:"Equipe criada com sucesso!"}),e.jsx("p",{className:"text-sm text-green-700 dark:text-green-400",children:"Compartilhe o cÃ³digo abaixo com seus colegas."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase",children:"Nome da Equipe"}),e.jsx("div",{className:"p-3 bg-gray-100 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600 text-gray-900 dark:text-white font-medium",children:we.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase",children:"CapitÃ£o (VocÃª)"}),e.jsx("div",{className:"p-3 bg-gray-100 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600 text-gray-900 dark:text-white font-medium",children:a.name})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase",children:"RM"}),e.jsx("div",{className:"p-3 bg-gray-100 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600 text-gray-900 dark:text-white",children:a.rm||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase",children:"Turma"}),e.jsx("div",{className:"p-3 bg-gray-100 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600 text-gray-900 dark:text-white",children:Me(a.classId)})]})]}),e.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 p-4 rounded border border-indigo-200 dark:border-indigo-800 text-center",children:[e.jsx("label",{className:"block text-xs font-bold text-indigo-500 uppercase mb-1",children:"CÃ³digo de Acesso"}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("code",{className:"text-3xl font-mono font-bold text-indigo-700 dark:text-indigo-300 tracking-wider select-all",children:we.code}),e.jsx("button",{onClick:()=>ye(we.code),className:"p-1.5 text-indigo-600 hover:text-indigo-800 dark:text-indigo-400 dark:hover:text-indigo-200 transition-colors",title:"Copiar cÃ³digo",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),e.jsx("div",{className:"h-6 w-px bg-indigo-200 dark:bg-indigo-700 mx-1"}),e.jsx("button",{onClick:()=>ze(we),className:"p-1.5 text-indigo-600 hover:text-indigo-800 dark:text-indigo-400 dark:hover:text-indigo-200 transition-colors",title:"Compartilhar Link",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})})})]})]})]}),e.jsx("button",{onClick:oe,className:"w-full bg-primary hover:bg-indigo-700 text-white font-bold py-3 rounded-lg shadow-md transition-colors",children:"Confirmar"})]})}),e.jsx(ce,{isOpen:j.type==="TEAM_INPUT",onClose:oe,title:"CÃ³digo de Acesso",children:e.jsxs("div",{className:"space-y-6 pt-2",children:[e.jsxs("p",{className:"text-gray-600 dark:text-gray-300",children:["Digite o cÃ³digo fornecido pelo capitÃ£o da equipe ",e.jsx("strong",{children:Le==null?void 0:Le.name}),"."]}),e.jsx(le,{label:"CÃ³digo da Equipe",placeholder:"Ex: A1B2",value:E,onChange:b=>C(b.target.value.toUpperCase()),className:"text-center font-mono text-xl tracking-widest uppercase",autoFocus:!0}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:oe,className:"px-4 py-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:"Cancelar"}),e.jsx("button",{onClick:Nt,className:"px-6 py-2 bg-primary text-white rounded font-bold hover:bg-indigo-700",children:"Verificar"})]})]})}),e.jsx(ce,{isOpen:j.type==="TEAM_CONFIRM",onClose:oe,title:"Confirmar Entrada",children:xe&&a&&e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-100 dark:border-blue-900/30",children:[e.jsx("h4",{className:"font-bold text-blue-900 dark:text-blue-300 mb-2 border-b border-blue-200 dark:border-blue-800 pb-2",children:"Dados da Equipe"}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700 dark:text-blue-400",children:"Nome:"}),e.jsx("span",{className:"font-medium dark:text-gray-200",children:xe.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700 dark:text-blue-400",children:"CapitÃ£o:"}),e.jsx("span",{className:"font-medium dark:text-gray-200",children:((Ge=ue[xe.captainId])==null?void 0:Ge.name)||"..."})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700 dark:text-blue-400",children:"Turma do CapitÃ£o:"}),e.jsx("span",{className:"font-medium dark:text-gray-200",children:Me((He=ue[xe.captainId])==null?void 0:He.classId)})]})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("h4",{className:"font-bold text-gray-700 dark:text-gray-300 mb-2 border-b border-gray-200 dark:border-gray-600 pb-2",children:"Seus Dados (Entrando como Membro)"}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Nome:"}),e.jsx("span",{className:"font-medium dark:text-white",children:a.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"RM:"}),e.jsx("span",{className:"font-medium dark:text-white",children:a.rm})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Turma:"}),e.jsx("span",{className:"font-medium dark:text-white",children:Me(a.classId)})]})]})]}),e.jsxs("div",{className:"text-center py-2",children:[e.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase",children:"CÃ³digo Verificado"}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"font-mono font-bold text-xl text-green-600 dark:text-green-400",children:xe.code}),e.jsx("button",{onClick:()=>ye(xe.code),className:"p-1 text-gray-500 hover:text-green-600 dark:text-gray-400 dark:hover:text-green-400 transition-colors",title:"Copiar cÃ³digo",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{onClick:oe,className:"flex-1 py-3 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-600 dark:text-gray-300 font-bold hover:bg-gray-50 dark:hover:bg-gray-700",children:"Cancelar"}),e.jsx(ne,{onClick:bt,isLoading:Te,className:"flex-1 py-3 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow",children:"Confirmar Entrada"})]})]})}),e.jsx(qe,{isOpen:!!y,onClose:()=>S(null),onConfirm:()=>y&&B(y),title:"Cancelar InscriÃ§Ã£o",message:"Tem certeza que deseja cancelar sua inscriÃ§Ã£o? A vaga serÃ¡ liberada imediatamente.",confirmText:"Sim, Cancelar",isProcessing:_})]})},Cs=()=>{const{user:o}=re(),{addToast:t}=ve(),[s,r]=p.useState([]),[a,n]=p.useState(null),[i,d]=p.useState(!0),[l,c]=p.useState(!1),[m,u]=p.useState(null),g=async()=>{if(o){d(!0);try{const y=await D.getEnrollmentsForUser(o.uid);if(y.length===0){r([]),d(!1);return}const S=[...new Set(y.map(N=>N.eventId))],j=await D.getEventsByIds(S),T=new Map(j.map(N=>[N.id,N])),E=j.filter(N=>N.isTeamEvent),C=new Map;await Promise.all(E.map(async N=>{try{(await D.getTeamsForEvent(N.id)).forEach(R=>C.set(R.id,R))}catch(M){console.error(`Error loading teams for event ${N.id}`,M)}}));const A=y.map(N=>{const M=T.get(N.eventId);if(!M)return null;const R=M.sessions.find(B=>B.id===N.sessionId);if(!R)return null;const V=N.teamId?C.get(N.teamId):void 0;return{enrollment:N,event:M,session:R,team:V}}).filter(N=>N!==null);r(A)}catch(y){console.error("Failed to load enrollments data:",y),t("error","Falha ao carregar inscriÃ§Ãµes."),r([])}finally{d(!1)}}};p.useEffect(()=>{g()},[o]);const x=async()=>{if(a){c(!0);try{await D.cancelEnrollment(a),t("success","InscriÃ§Ã£o cancelada com sucesso.")}catch(y){console.error(y),t("error","Erro ao cancelar inscriÃ§Ã£o.")}finally{n(null),c(!1),g()}}},w=async y=>{try{await navigator.clipboard.writeText(y),t("success","CÃ³digo copiado!")}catch{}},v=(y,S,j)=>{o&&u({enrollmentId:y.id,event:S,sessionDate:j.date,sessionTime:`${j.startTime} - ${j.endTime}`,user:o,attended:y.attended})},k=new Date().toISOString().split("T")[0];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Minha Agenda"}),i?e.jsx("div",{className:"bg-white dark:bg-darkcard shadow overflow-hidden sm:rounded-md border border-gray-200 dark:border-gray-700",children:e.jsx("ul",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:Array.from({length:3}).map((y,S)=>e.jsx(ps,{},S))})}):s.length===0?e.jsx(mt,{title:"Agenda Vazia",description:"VocÃª ainda nÃ£o se inscreveu em nenhum evento."}):e.jsx("div",{className:"bg-white dark:bg-darkcard shadow overflow-hidden sm:rounded-md border border-gray-200 dark:border-gray-700",children:e.jsx("ul",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:s.map(({enrollment:y,event:S,session:j,team:T})=>{const E=j.date<k;return e.jsxs("li",{className:"px-6 py-4 flex flex-col sm:flex-row sm:items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 gap-4 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[S.isTeamEvent&&e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-[10px] font-bold bg-indigo-100 text-indigo-800 dark:bg-indigo-900/40 dark:text-indigo-300 uppercase tracking-wide border border-indigo-200 dark:border-indigo-800",children:"ðŸ›¡ï¸ Equipe"}),y.attended&&e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-[10px] font-bold bg-green-100 text-green-800 dark:bg-green-900/40 dark:text-green-300 uppercase tracking-wide border border-green-200 dark:border-green-800",children:"âœ… PresenÃ§a"}),e.jsx("h3",{className:"text-lg font-medium text-primary dark:text-indigo-400",children:S.name})]}),e.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1 flex flex-wrap gap-x-4 gap-y-1",children:[e.jsxs("span",{children:["ðŸ“… ",X(j.date)]}),e.jsxs("span",{children:["â° ",j.startTime," - ",j.endTime]}),e.jsxs("span",{children:["ðŸ“ ",S.location]})]}),T&&e.jsxs("div",{className:"mt-3 flex flex-col sm:flex-row sm:items-center items-start gap-3 p-3 bg-indigo-50 dark:bg-indigo-900/10 rounded-lg border border-indigo-100 dark:border-indigo-800/30 w-full sm:w-fit",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-200 dark:bg-indigo-800 flex items-center justify-center text-lg flex-shrink-0",children:"ðŸ›¡ï¸"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-bold text-gray-500 dark:text-gray-400 uppercase",children:"Sua Equipe"}),e.jsx("div",{className:"text-sm font-bold text-gray-900 dark:text-white",children:T.name})]})]}),e.jsxs("div",{className:"flex items-center gap-2 pl-0 sm:pl-3 border-t sm:border-t-0 sm:border-l border-indigo-200 dark:border-indigo-700 pt-2 sm:pt-0 w-full sm:w-auto",children:[e.jsx("div",{className:"text-xs font-bold text-gray-500 dark:text-gray-400 uppercase mr-2 sm:mr-0",children:"CÃ³digo:"}),e.jsxs("button",{onClick:()=>w(T.code),className:"text-xs font-mono font-bold text-indigo-600 dark:text-indigo-300 hover:underline flex items-center gap-1",title:"Copiar CÃ³digo",children:[T.code," ðŸ“‹"]})]})]}),E&&e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 mt-2",children:"Evento Finalizado"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 flex-shrink-0",children:[e.jsxs("button",{onClick:()=>v(y,S,j),className:"w-full sm:w-auto text-sm px-4 py-2 rounded-lg transition border font-medium bg-white dark:bg-darkcard border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-800 flex items-center justify-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4h2v-4zM6 8v4M6 16v4m12-16H6a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2z"})}),"Ver Ticket"]}),e.jsx("button",{onClick:()=>n(y.id),disabled:E||y.attended,className:`w-full sm:w-auto text-sm px-4 py-2 rounded-lg transition border font-medium
                                            ${E||y.attended?"bg-gray-100 dark:bg-gray-800 text-gray-400 dark:text-gray-500 border-gray-200 dark:border-gray-700 cursor-not-allowed":"text-red-600 dark:text-red-400 hover:text-white hover:bg-red-600 dark:hover:bg-red-500 border-red-200 dark:border-red-900/30"}`,children:E?"ConcluÃ­do":y.attended?"PresenÃ§a Confirmada":S.isTeamEvent?"Sair da Equipe":"Cancelar InscriÃ§Ã£o"})]})]},y.id)})})}),e.jsx(qe,{isOpen:!!a,onClose:()=>n(null),onConfirm:x,title:"Cancelar InscriÃ§Ã£o",message:"Tem certeza que deseja cancelar sua inscriÃ§Ã£o neste evento? Se for um evento de equipe, vocÃª sairÃ¡ do grupo e a vaga poderÃ¡ ser perdida.",confirmText:"Sim, Cancelar",cancelText:"Manter InscriÃ§Ã£o",isProcessing:l}),e.jsx(ce,{isOpen:!!m,onClose:()=>u(null),title:"Seu Ticket de Entrada",children:m&&e.jsxs("div",{className:"flex flex-col items-center justify-center p-4 space-y-6",children:[e.jsx("div",{className:`p-4 bg-white rounded-xl shadow-lg border-2 ${m.attended?"border-green-500":"border-gray-900"}`,children:e.jsx(St,{value:m.enrollmentId,size:200})}),e.jsxs("div",{className:"text-center space-y-1",children:[m.attended?e.jsx("span",{className:"inline-block px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-bold uppercase mb-2",children:"âœ… Check-in Realizado"}):e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:"Apresente este cÃ³digo na entrada"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:m.event.name}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:[X(m.sessionDate)," â€¢ ",m.sessionTime]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:m.event.location})]}),e.jsxs("div",{className:"w-full border-t border-gray-200 dark:border-gray-700 pt-4 text-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:m.user.name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["RM: ",m.user.rm||"-"]}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-2 font-mono",children:m.enrollmentId})]})]})})]})},Ts=ie.lazy(()=>pe(()=>import("./AdminEvents-BzTiGQSf.js"),__vite__mapDeps([0,1,2,3,4])).then(o=>({default:o.AdminEvents}))),As=ie.lazy(()=>pe(()=>import("./AdminUsers-miXlvd_b.js"),__vite__mapDeps([5,1,2,3,4])).then(o=>({default:o.AdminUsers}))),Ms=ie.lazy(()=>pe(()=>import("./AdminCourses-BmGe6fv-.js"),__vite__mapDeps([6,1,2,3,4])).then(o=>({default:o.AdminCourses}))),Ls=ie.lazy(()=>pe(()=>import("./AdminEventEnrollments-BDc05iQl.js"),__vite__mapDeps([7,1,2,3,8,4])).then(o=>({default:o.AdminEventEnrollments}))),Ds=ie.lazy(()=>pe(()=>import("./AdminScanner-DZvNYzhM.js"),__vite__mapDeps([9,1,2,3,4])).then(o=>({default:o.AdminScanner}))),Rs=ie.lazy(()=>pe(()=>import("./DevTools-D-kQhvVm.js"),__vite__mapDeps([10,1,2,3,4])).then(o=>({default:o.DevTools}))),Os=()=>e.jsx("div",{className:"h-full w-full flex items-center justify-center p-10",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}),Z=({children:o,roleRequired:t})=>{const{user:s,loading:r}=re(),a=Fe();return r?e.jsx("div",{className:"h-screen flex items-center justify-center text-primary font-medium dark:bg-darkbg dark:text-gray-200",children:"Carregando EduEvent..."}):s?!s.isOnboarded&&window.location.hash!=="#/complete-profile"?e.jsx(Se,{to:"/complete-profile"}):t&&s.role!==t?e.jsx(Se,{to:"/dashboard"}):e.jsx(e.Fragment,{children:o}):e.jsx(Se,{to:"/login",state:{from:a},replace:!0})},Ps=()=>{const{user:o}=re();return e.jsx(p.Suspense,{fallback:e.jsx(Os,{}),children:e.jsxs(Ct,{children:[e.jsx(K,{path:"/",element:o?e.jsx(Se,{to:"/dashboard"}):e.jsx(Ns,{})}),e.jsx(K,{path:"/special/:id",element:e.jsx(ks,{})}),e.jsx(K,{path:"/login",element:e.jsx(ms,{})}),e.jsx(K,{path:"/complete-profile",element:e.jsx(Z,{children:e.jsx(us,{})})}),e.jsx(K,{path:"/dashboard",element:e.jsx(Z,{children:e.jsx(te,{children:e.jsx(js,{})})})}),e.jsx(K,{path:"/event/:id",element:e.jsx(Z,{children:e.jsx(te,{children:e.jsx(Is,{})})})}),e.jsx(K,{path:"/my-enrollments",element:e.jsx(Z,{children:e.jsx(te,{children:e.jsx(Cs,{})})})}),e.jsx(K,{path:"/admin/events",element:e.jsx(Z,{roleRequired:H.ADMIN,children:e.jsx(te,{children:e.jsx(Ts,{})})})}),e.jsx(K,{path:"/admin/events/:id/enrollments",element:e.jsx(Z,{roleRequired:H.ADMIN,children:e.jsx(te,{children:e.jsx(Ls,{})})})}),e.jsx(K,{path:"/admin/courses",element:e.jsx(Z,{roleRequired:H.ADMIN,children:e.jsx(te,{children:e.jsx(Ms,{})})})}),e.jsx(K,{path:"/admin/users",element:e.jsx(Z,{roleRequired:H.ADMIN,children:e.jsx(te,{children:e.jsx(As,{})})})}),e.jsx(K,{path:"/admin/scanner",element:e.jsx(Z,{roleRequired:H.ADMIN,children:e.jsx(te,{children:e.jsx(Ds,{})})})}),e.jsx(K,{path:"/admin/dev",element:e.jsx(Z,{roleRequired:H.ADMIN,children:e.jsx(te,{children:e.jsx(Rs,{})})})})]})})};function Us(){return e.jsx(is,{children:e.jsx(ds,{children:e.jsx(os,{children:e.jsx(It,{children:e.jsx(Ps,{})})})})})}const ut=document.getElementById("root");if(!ut)throw new Error("Could not find root element to mount to");const $s=Tt.createRoot(ut);$s.render(e.jsx(ie.StrictMode,{children:e.jsx(Us,{})}));export{qe as C,mt as E,ne as L,ce as M,ps as S,H as U,gs as a,re as b,Bs as c,Vs as d,X as f,Ce as g,D as s,ve as u};
