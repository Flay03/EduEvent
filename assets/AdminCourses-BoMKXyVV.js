import{r as d,j as e}from"./react-vendor-D244Vx8q.js";import{u as G,C as R,M as F,s as i}from"./index-BcV99Zb4.js";import"./vendor-kkeqS5Xn.js";import"./qr-utils-B8AONaXL.js";import"./firebase-CUKyr0uK.js";const W=()=>{const[c,S]=d.useState([]),[E,T]=d.useState([]),[H,p]=d.useState(!1),{addToast:o}=G(),[g,f]=d.useState(""),[h,w]=d.useState(""),[b,A]=d.useState(""),[m,D]=d.useState(""),[s,u]=d.useState(null),[t,x]=d.useState(null),[L,v]=d.useState(!1),n=async()=>{p(!0);const r=await i.getCourses(),a=await i.getClasses();S(r),T(a),p(!1)};d.useEffect(()=>{n()},[]);const q=async r=>{if(r.preventDefault(),!!g)try{await i.addCourse(g),f(""),o("success","Curso adicionado."),n()}catch{o("error","Erro ao adicionar curso.")}},z=r=>{x({type:"course",id:r})},I=async r=>{if(r.preventDefault(),!(!h||!b))try{await i.addClass(b,h),w(""),o("success","Turma adicionada."),n()}catch{o("error","Erro ao adicionar turma.")}},M=r=>{x({type:"class",id:r})},O=async()=>{if(t){v(!0);try{t.type==="course"?await i.deleteCourse(t.id):await i.deleteClass(t.id),o("success","Item removido."),x(null),n()}catch{o("error","Erro ao remover item.")}finally{v(!1)}}},k=(r,a,l)=>{u({type:r,id:a,name:l})},P=async r=>{if(r.preventDefault(),!(!s||!s.name))try{s.type==="course"?await i.updateCourse(s.id,s.name):await i.updateClass(s.id,s.name),o("success","Atualizado com sucesso."),u(null),n()}catch{o("error","Erro ao atualizar.")}},j=c.filter(r=>r.name.toLowerCase().includes(m.toLowerCase())),N=E.filter(r=>{var C;const a=((C=c.find(B=>B.id===r.courseId))==null?void 0:C.name)||"",l=r.name.toLowerCase().includes(m.toLowerCase()),y=a.toLowerCase().includes(m.toLowerCase());return l||y});return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Gestão de Cursos e Turmas"}),e.jsx("div",{className:"w-full sm:w-72",children:e.jsx("input",{type:"text",placeholder:"Buscar Curso ou Turma...",className:"w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm py-2 px-3 focus:ring-primary focus:border-primary bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:m,onChange:r=>D(r.target.value)})})]}),e.jsxs("div",{className:"bg-white dark:bg-darkcard shadow rounded-lg p-4 sm:p-6 border border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Cursos"}),e.jsxs("form",{onSubmit:q,className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsx("input",{type:"text",placeholder:"Nome do novo curso",className:"flex-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm py-2 px-3 focus:ring-primary focus:border-primary bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:g,onChange:r=>f(r.target.value)}),e.jsx("button",{type:"submit",className:"w-full sm:w-auto bg-primary text-white px-4 py-2 rounded-md hover:bg-indigo-700 font-medium",children:"Adicionar Curso"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[j.map(r=>e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-md p-4 flex justify-between items-center bg-gray-50 dark:bg-gray-800/50 shadow-sm",children:[e.jsx("span",{className:"font-medium text-gray-800 dark:text-gray-200 break-words flex-1 pr-2",children:r.name}),e.jsxs("div",{className:"flex space-x-1 flex-shrink-0",children:[e.jsx("button",{onClick:()=>k("course",r.id,r.name),className:"text-blue-600 dark:text-blue-400 text-sm hover:text-white hover:bg-blue-600 dark:hover:bg-blue-500 font-medium px-2 py-1 rounded transition",title:"Editar",children:"✎"}),e.jsx("button",{onClick:()=>z(r.id),className:"text-red-600 dark:text-red-400 text-sm hover:text-white hover:bg-red-600 dark:hover:bg-red-500 font-medium px-2 py-1 rounded transition",title:"Excluir",children:"×"})]})]},r.id)),j.length===0&&e.jsx("div",{className:"text-gray-500 dark:text-gray-400 text-sm italic col-span-full",children:"Nenhum curso encontrado."})]})]}),e.jsxs("div",{className:"bg-white dark:bg-darkcard shadow rounded-lg p-4 sm:p-6 border border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Turmas"}),e.jsxs("form",{onSubmit:I,className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsxs("select",{className:"w-full sm:w-1/3 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm py-2 px-3 focus:ring-primary focus:border-primary bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:b,onChange:r=>A(r.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Selecione o Curso..."}),c.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]}),e.jsx("input",{type:"text",placeholder:"Nome da Turma (ex: 2024-A)",className:"flex-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm py-2 px-3 focus:ring-primary focus:border-primary bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:h,onChange:r=>w(r.target.value),required:!0}),e.jsx("button",{type:"submit",className:"w-full sm:w-auto bg-secondary text-white px-4 py-2 rounded-md hover:bg-emerald-700 font-medium",children:"Adicionar Turma"})]}),e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-md bg-white dark:bg-darkcard overflow-hidden",children:[e.jsxs("div",{className:"hidden md:grid grid-cols-3 bg-gray-50 dark:bg-gray-800 px-6 py-3 text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider border-b border-gray-200 dark:border-gray-700",children:[e.jsx("div",{children:"Turma"}),e.jsx("div",{children:"Curso Associado"}),e.jsx("div",{className:"text-right",children:"Ações"})]}),e.jsxs("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:[N.map(r=>{var l;const a=((l=c.find(y=>y.id===r.courseId))==null?void 0:l.name)||"Curso removido";return e.jsxs("div",{className:"p-4 md:px-6 md:py-4 flex flex-col md:grid md:grid-cols-3 gap-2 md:items-center hover:bg-gray-50 dark:hover:bg-gray-800/50 transition",children:[e.jsxs("div",{className:"flex justify-between items-center md:block",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:r.name}),e.jsx("span",{className:"md:hidden text-xs font-bold text-gray-400 uppercase",children:"Turma"})]}),e.jsxs("div",{className:"flex justify-between items-center md:block",children:[e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:a}),e.jsx("span",{className:"md:hidden text-xs font-bold text-gray-400 uppercase",children:"Curso"})]}),e.jsxs("div",{className:"text-right mt-3 md:mt-0 pt-3 md:pt-0 border-t md:border-0 border-gray-100 dark:border-gray-700 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>k("class",r.id,r.name),className:"text-blue-600 dark:text-blue-400 hover:text-white hover:bg-blue-600 dark:hover:bg-blue-500 text-sm font-medium border border-blue-200 dark:border-blue-900 px-3 py-1.5 rounded transition",children:"Editar"}),e.jsx("button",{onClick:()=>M(r.id),className:"text-red-600 dark:text-red-400 hover:text-white hover:bg-red-600 dark:hover:bg-red-500 text-sm font-medium border border-red-200 dark:border-red-900 px-3 py-1.5 rounded transition",children:"Excluir"})]})]},r.id)}),N.length===0&&e.jsx("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400 text-sm",children:"Nenhuma turma encontrada."})]})]})]}),e.jsx(R,{isOpen:!!t,onClose:()=>x(null),onConfirm:O,title:"Confirmar Exclusão",message:e.jsxs("div",{children:[e.jsxs("p",{children:["Tem certeza que deseja excluir ",(t==null?void 0:t.type)==="course"?"este curso":"esta turma","?"]}),(t==null?void 0:t.type)==="course"&&e.jsx("p",{className:"text-xs text-red-500 dark:text-red-400 font-bold mt-2 bg-red-50 dark:bg-red-900/20 p-2 rounded",children:"⚠️ Atenção: Todas as turmas e vínculos de usuários deste curso serão removidos automaticamente."})]}),isProcessing:L}),e.jsx(F,{isOpen:!!s,onClose:()=>u(null),title:(s==null?void 0:s.type)==="course"?"Editar Curso":"Editar Turma",children:e.jsxs("form",{onSubmit:P,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Nome"}),e.jsx("input",{type:"text",className:"w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm py-2 px-3 focus:ring-primary focus:border-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-white",value:(s==null?void 0:s.name)||"",onChange:r=>u(a=>a?{...a,name:r.target.value}:null),required:!0})]}),e.jsx("button",{type:"submit",className:"w-full bg-primary text-white py-2 rounded font-medium hover:bg-indigo-700",children:"Salvar"})]})})]})};export{W as AdminCourses};
