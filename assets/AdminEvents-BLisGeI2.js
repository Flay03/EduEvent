import{u as ce,r as i,j as e,f as w,L as me,a as be,s as I,S as ue,E as ye,b as he,M as pe,C as ke}from"./index-Da96yiop.js";const fe=({initialData:f,courses:R,classes:A,targetParentName:N,dateLimits:o,onSubmit:S,onCancel:q,isLoading:W})=>{var J,K,Z,L,ee,re,ae,te,se;const{addToast:z}=ce(),[v,C]=i.useState("details"),[P,j]=i.useState("manual"),[T,g]=i.useState(null),h=`${new Date().getFullYear()+2}-12-31`,V=50,[s,n]=i.useState({name:"",description:"",location:"",visibility:"public",allowedCourses:[],allowedClasses:[],sessions:[],parentId:void 0,isTeamEvent:!1,hasDedicatedPage:!1,dedicatedPageConfig:{schedule:[],gallery:[],themeColor:"#4F46E5",presentationText:""},...f}),[l,u]=i.useState({date:"",startTime:"",endTime:"",capacity:30}),[x,p]=i.useState({startDate:"",endDate:"",startTime:"",endTime:"",capacity:30,daysOfWeek:[]}),[c,k]=i.useState({time:"",title:"",description:""}),[y,E]=i.useState(""),[O,G]=i.useState("");i.useEffect(()=>{f&&n(r=>({...r,...f,dedicatedPageConfig:{schedule:[],gallery:[],themeColor:"#4F46E5",presentationText:"",...f.dedicatedPageConfig||{}}}))},[f]);const H=async r=>{var a,d;if(r.preventDefault(),!s.name||!((a=s.sessions)!=null&&a.length)){g("Nome e ao menos uma sess√£o s√£o obrigat√≥rios."),s.name&&!((d=s.sessions)!=null&&d.length)&&C("sessions");return}await S(s)},B=r=>n(a=>{var d;return{...a,allowedCourses:(d=a.allowedCourses)!=null&&d.includes(r)?a.allowedCourses.filter(b=>b!==r):[...a.allowedCourses||[],r]}}),Y=r=>n(a=>{var d;return{...a,allowedClasses:(d=a.allowedClasses)!=null&&d.includes(r)?a.allowedClasses.filter(b=>b!==r):[...a.allowedClasses||[],r]}}),Q=r=>p(a=>({...a,daysOfWeek:a.daysOfWeek.includes(r)?a.daysOfWeek.filter(d=>d!==r):[...a.daysOfWeek,r]})),t=()=>{if(!l.date||!l.startTime||!l.endTime)return;if(o&&(l.date<o.min||l.date>o.max)){g(`A data deve estar entre ${w(o.min)} e ${w(o.max)}.`);return}if(l.startTime>=l.endTime){g("O hor√°rio de t√©rmino deve ser ap√≥s o hor√°rio de in√≠cio.");return}const r={id:`sess_${Date.now()}`,date:l.date,startTime:l.startTime,endTime:l.endTime,capacity:l.capacity||30,filled:0};n(a=>({...a,sessions:[...a.sessions||[],r]})),u({date:"",startTime:"",endTime:"",capacity:30}),g(null)},m=()=>{g(null);const{startDate:r,endDate:a,startTime:d,endTime:b,capacity:X,daysOfWeek:de}=x;if(!r||!a||!d||!b||!de.length){g("Preencha todos os campos.");return}if(o&&(r<o.min||a>o.max)){g(`O intervalo deve estar entre ${w(o.min)} e ${w(o.max)}.`);return}if(a>h){g(`A gera√ß√£o √© limitada at√© ${w(h)}.`);return}if(d>=b){g("O hor√°rio de t√©rmino deve ser ap√≥s o hor√°rio de in√≠cio.");return}const oe=new Date(`${r}T12:00:00`),ie=new Date(`${a}T12:00:00`);if(oe>ie){g("A data de in√≠cio deve ser anterior √† de fim.");return}const D=[],$=new Date(oe);let ne=0;for(;$<=ie&&(ne++,!(ne>1e3));)de.includes($.getDay())&&D.push({id:`sess_${$.getTime()}_${D.length}`,date:$.toISOString().split("T")[0],startTime:d,endTime:b,capacity:X,filled:0}),$.setDate($.getDate()+1);if(D.length>V){g("Limite de seguran√ßa excedido.");return}if(!D.length){g("Nenhuma data encontrada no intervalo.");return}n(le=>({...le,sessions:[...le.sessions||[],...D]})),z("success",`${D.length} sess√µes geradas.`)},F=r=>{n(a=>{var d;return{...a,sessions:(d=a.sessions)==null?void 0:d.filter((b,X)=>X!==r)}})},_=()=>{if(!c.time||!c.title)return;const r={id:`sch_${Date.now()}`,time:c.time,title:c.title,description:c.description,date:c.date};n(a=>{var d;return{...a,dedicatedPageConfig:{...a.dedicatedPageConfig,schedule:[...((d=a.dedicatedPageConfig)==null?void 0:d.schedule)||[],r]}}}),k({time:"",title:"",description:"",date:""})},U=r=>{n(a=>{var d;return{...a,dedicatedPageConfig:{...a.dedicatedPageConfig,schedule:((d=a.dedicatedPageConfig)==null?void 0:d.schedule.filter(b=>b.id!==r))||[]}}})},ge=()=>{if(!y)return;const r={id:`img_${Date.now()}`,url:y,caption:O};n(a=>{var d;return{...a,dedicatedPageConfig:{...a.dedicatedPageConfig,gallery:[...((d=a.dedicatedPageConfig)==null?void 0:d.gallery)||[],r]}}}),E(""),G("")},xe=r=>{n(a=>{var d;return{...a,dedicatedPageConfig:{...a.dedicatedPageConfig,gallery:((d=a.dedicatedPageConfig)==null?void 0:d.gallery.filter(b=>b.id!==r))||[]}}})};return e.jsxs("form",{onSubmit:H,className:"flex flex-col h-[70vh] sm:h-[60vh]",children:[e.jsxs("div",{className:"flex border-b border-gray-200 dark:border-gray-600 mb-4 overflow-x-auto",children:[e.jsx("button",{type:"button",onClick:()=>C("details"),className:`flex-1 px-4 py-3 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${v==="details"?"border-primary text-primary dark:text-indigo-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,children:"1. Detalhes"}),e.jsxs("button",{type:"button",onClick:()=>C("sessions"),className:`flex-1 px-4 py-3 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${v==="sessions"?"border-primary text-primary dark:text-indigo-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,children:["2. Sess√µes (",((J=s.sessions)==null?void 0:J.length)||0,")"]}),e.jsx("button",{type:"button",onClick:()=>C("dedicated"),className:`flex-1 px-4 py-3 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${v==="dedicated"?"border-primary text-primary dark:text-indigo-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,children:"3. P√°g. Dedicada"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-1 pb-4",children:[v==="details"&&e.jsxs("div",{className:"space-y-4 animate-fade-in",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Nome do Evento *"}),e.jsx("input",{type:"text",required:!0,placeholder:"Ex: Feira de Ci√™ncias",className:"w-full border border-gray-300 dark:border-gray-600 rounded-md p-2 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-primary focus:border-primary",value:s.name,onChange:r=>n({...s,name:r.target.value})})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2 p-3 bg-gray-50 dark:bg-gray-800/50 rounded-md border border-gray-200 dark:border-gray-700",children:[e.jsx("input",{type:"checkbox",id:"isTeamEvent",className:"h-5 w-5 text-primary focus:ring-primary border-gray-300 rounded",checked:s.isTeamEvent,onChange:r=>n(a=>({...a,isTeamEvent:r.target.checked}))}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:"isTeamEvent",className:"text-sm font-bold text-gray-900 dark:text-white",children:"Habilitar Inscri√ß√£o por Equipes"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Os usu√°rios formar√£o grupos com c√≥digo de acesso."})]})]}),s.isTeamEvent&&e.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 text-indigo-800 dark:text-indigo-300 p-3 rounded-md text-sm mb-4 border border-indigo-200 dark:border-indigo-800 flex items-start gap-2",children:[e.jsx("span",{className:"text-lg",children:"üë•"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Modo Evento por Equipe Ativo:"}),e.jsx("br",{}),"O sistema gerenciar√° a cria√ß√£o de times, capit√£es e c√≥digos de convite automaticamente."]})]}),N&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 text-blue-800 dark:text-blue-300 p-3 rounded-md text-sm mb-4",children:["Vinculado ao evento pai: ",e.jsx("strong",{children:N})]}),e.jsxs("div",{className:N?"opacity-50 pointer-events-none":"",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Visibilidade"}),e.jsxs("select",{value:s.visibility,onChange:r=>n({...s,visibility:r.target.value}),className:"w-full border border-gray-300 dark:border-gray-600 rounded-md p-2 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-primary focus:border-primary",disabled:!!N,children:[e.jsx("option",{value:"public",children:"P√∫blico (Todos podem ver)"}),e.jsx("option",{value:"course",children:"Restrito a Cursos"}),e.jsx("option",{value:"class",children:"Restrito a Turmas"})]}),s.visibility==="course"&&e.jsxs("div",{className:"mt-2 p-3 border border-gray-200 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-800/50 max-h-40 overflow-y-auto",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 dark:text-gray-400 mb-2 uppercase",children:"Selecione os cursos permitidos:"}),R.map(r=>{var a;return e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx("input",{type:"checkbox",id:`c_${r.id}`,checked:(a=s.allowedCourses)==null?void 0:a.includes(r.id),onChange:()=>B(r.id),className:"h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded"}),e.jsx("label",{htmlFor:`c_${r.id}`,className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:r.name})]},r.id)})]}),s.visibility==="class"&&e.jsxs("div",{className:"mt-2 p-3 border border-gray-200 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-800/50 max-h-40 overflow-y-auto",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 dark:text-gray-400 mb-2 uppercase",children:"Selecione as turmas permitidas:"}),R.map(r=>e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{className:"text-xs text-gray-900 dark:text-gray-200 block mb-1",children:r.name}),e.jsx("div",{className:"pl-2",children:A.filter(a=>a.courseId===r.id).map(a=>{var d;return e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx("input",{type:"checkbox",id:`cl_${a.id}`,checked:(d=s.allowedClasses)==null?void 0:d.includes(a.id),onChange:()=>Y(a.id),className:"h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded"}),e.jsx("label",{htmlFor:`cl_${a.id}`,className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:a.name})]},a.id)})})]},r.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Local"}),e.jsx("input",{type:"text",placeholder:"Ex: Audit√≥rio Principal",className:"w-full border border-gray-300 dark:border-gray-600 rounded-md p-2 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-primary focus:border-primary",value:s.location,onChange:r=>n({...s,location:r.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Descri√ß√£o"}),e.jsx("textarea",{placeholder:"Detalhes do evento...",className:"w-full border border-gray-300 dark:border-gray-600 rounded-md p-2 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-primary focus:border-primary",rows:3,value:s.description,onChange:r=>n({...s,description:r.target.value})})]})]}),v==="sessions"&&e.jsxs("div",{className:"space-y-4 animate-fade-in",children:[o&&e.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 border-l-4 border-amber-400 p-3 text-sm text-amber-800 dark:text-amber-300",children:["üìÖ ",e.jsx("strong",{children:"Restri√ß√£o de Data:"})," Este sub-evento deve ocorrer entre ",w(o.min)," e ",w(o.max),"."]}),e.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-md overflow-hidden",children:[e.jsxs("div",{className:"flex bg-gray-100 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-600",children:[e.jsx("button",{type:"button",onClick:()=>j("manual"),className:`flex-1 py-2 text-sm font-medium ${P==="manual"?"bg-white dark:bg-darkcard text-primary dark:text-indigo-400 border-t-2 border-primary":"text-gray-500 dark:text-gray-400"}`,children:"Adicionar Manual"}),e.jsx("button",{type:"button",onClick:()=>j("recurring"),className:`flex-1 py-2 text-sm font-medium ${P==="recurring"?"bg-white dark:bg-darkcard text-primary dark:text-indigo-400 border-t-2 border-primary":"text-gray-500 dark:text-gray-400"}`,children:"Gerar Recorr√™ncia"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800/50",children:[P==="manual"&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Data"}),e.jsx("input",{type:"date",className:"w-full border border-gray-300 dark:border-gray-600 p-1.5 rounded text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",value:l.date,min:o==null?void 0:o.min,max:o==null?void 0:o.max,onChange:r=>u({...l,date:r.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 dark:text-gray-400",children:"In√≠cio"}),e.jsx("input",{type:"time",className:"w-full border border-gray-300 dark:border-gray-600 p-1.5 rounded text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",value:l.startTime,onChange:r=>u({...l,startTime:r.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Fim"}),e.jsx("input",{type:"time",className:"w-full border border-gray-300 dark:border-gray-600 p-1.5 rounded text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",value:l.endTime,onChange:r=>u({...l,endTime:r.target.value})})]}),e.jsxs("div",{className:"sm:col-span-2 flex items-end gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs text-gray-500 dark:text-gray-400",children:s.isTeamEvent?"N¬∫ de Equipes":"Vagas"}),e.jsx("input",{type:"number",className:"w-full border border-gray-300 dark:border-gray-600 p-1.5 rounded text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",value:l.capacity,onChange:r=>u({...l,capacity:parseInt(r.target.value)})})]}),e.jsx("button",{type:"button",onClick:t,className:"bg-white dark:bg-gray-700 border border-primary dark:border-indigo-500 text-primary dark:text-indigo-300 hover:bg-indigo-50 dark:hover:bg-gray-600 px-4 py-1.5 rounded text-sm font-medium h-[34px]",children:"+ Adicionar"})]})]}),P==="recurring"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 dark:text-gray-400",children:"De"}),e.jsx("input",{type:"date",className:"w-full border dark:border-gray-600 p-1.5 rounded text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",value:x.startDate,min:o==null?void 0:o.min,max:h,onChange:r=>p({...x,startDate:r.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 dark:text-gray-400",children:"At√©"}),e.jsx("input",{type:"date",className:"w-full border dark:border-gray-600 p-1.5 rounded text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",value:x.endDate,min:o==null?void 0:o.min,max:h,onChange:r=>p({...x,endDate:r.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("input",{type:"time",className:"w-full border dark:border-gray-600 p-1.5 rounded text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",value:x.startTime,onChange:r=>p({...x,startTime:r.target.value})}),e.jsx("input",{type:"time",className:"w-full border dark:border-gray-600 p-1.5 rounded text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",value:x.endTime,onChange:r=>p({...x,endTime:r.target.value})}),e.jsx("input",{type:"number",placeholder:s.isTeamEvent?"Qtd Equipes":"Cap.",className:"w-full border dark:border-gray-600 p-1.5 rounded text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",value:x.capacity,onChange:r=>p({...x,capacity:parseInt(r.target.value)})})]}),e.jsx("div",{className:"flex flex-wrap gap-2 justify-center",children:["Dom","Seg","Ter","Qua","Qui","Sex","Sab"].map((r,a)=>e.jsx("button",{type:"button",onClick:()=>Q(a),className:`text-xs w-8 h-8 rounded-full border flex items-center justify-center transition ${x.daysOfWeek.includes(a)?"bg-primary text-white border-primary":"bg-white dark:bg-gray-700 text-gray-600 dark:text-gray-300 border-gray-300 dark:border-gray-600"}`,children:r.charAt(0)},r))}),e.jsx("button",{type:"button",onClick:m,className:"w-full bg-primary text-white py-2 rounded text-sm hover:bg-indigo-700",children:"Gerar Sess√µes"})]}),T&&e.jsx("div",{className:"mt-2 text-xs text-red-600 dark:text-red-400 font-medium bg-red-50 dark:bg-red-900/20 p-2 rounded",children:T})]})]}),e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-bold text-gray-800 dark:text-gray-200 mb-2 flex justify-between items-center",children:["Sess√µes Geradas",e.jsx("span",{className:"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 px-2 py-0.5 rounded-full text-xs",children:((K=s.sessions)==null?void 0:K.length)||0})]}),e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-md max-h-48 overflow-y-auto bg-white dark:bg-gray-800 divide-y divide-gray-100 dark:divide-gray-700",children:[((Z=s.sessions)==null?void 0:Z.length)===0&&e.jsx("p",{className:"text-sm text-gray-400 text-center py-6 italic",children:"Nenhuma sess√£o adicionada ainda."}),(L=s.sessions)==null?void 0:L.slice().sort((r,a)=>r.date.localeCompare(a.date)).map((r,a)=>e.jsxs("div",{className:"p-2.5 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-gray-700/50 text-sm",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-200",children:w(r.date)}),e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[r.startTime," - ",r.endTime," ‚Ä¢ ",r.capacity," ",s.isTeamEvent?"equipes":"vagas"]})]}),e.jsx("button",{type:"button",onClick:()=>F(a),className:"text-red-500 hover:text-red-700 dark:hover:text-red-400 p-1",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]},a))]})]})]}),v==="dedicated"&&e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("input",{type:"checkbox",id:"hasDedicatedPage",className:"h-5 w-5 text-primary focus:ring-primary border-gray-300 rounded",checked:s.hasDedicatedPage,onChange:r=>n(a=>({...a,hasDedicatedPage:r.target.checked}))}),e.jsx("label",{htmlFor:"hasDedicatedPage",className:"text-sm font-bold text-gray-900 dark:text-white",children:"Habilitar P√°gina Exclusiva"})]}),s.hasDedicatedPage&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-gray-500 dark:text-gray-400 mb-1",children:"Cor do Tema"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",className:"h-9 w-14 rounded cursor-pointer border border-gray-300 dark:border-gray-600",value:((ee=s.dedicatedPageConfig)==null?void 0:ee.themeColor)||"#4F46E5",onChange:r=>n(a=>({...a,dedicatedPageConfig:{...a.dedicatedPageConfig,themeColor:r.target.value}}))}),e.jsx("input",{type:"text",className:"flex-1 border border-gray-300 dark:border-gray-600 rounded-md p-1.5 text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:(re=s.dedicatedPageConfig)==null?void 0:re.themeColor,onChange:r=>n(a=>({...a,dedicatedPageConfig:{...a.dedicatedPageConfig,themeColor:r.target.value}}))})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-gray-500 dark:text-gray-400 mb-1",children:"Texto de Apresenta√ß√£o"}),e.jsx("textarea",{className:"w-full border border-gray-300 dark:border-gray-600 rounded-md p-2 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-primary focus:border-primary text-sm",rows:4,placeholder:"Descri√ß√£o detalhada para a p√°gina do evento...",value:(ae=s.dedicatedPageConfig)==null?void 0:ae.presentationText,onChange:r=>n(a=>({...a,dedicatedPageConfig:{...a.dedicatedPageConfig,presentationText:r.target.value}}))})]}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[e.jsx("label",{className:"block text-sm font-bold text-gray-900 dark:text-white mb-2",children:"Galeria de Imagens (URLs)"}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"url",placeholder:"https://exemplo.com/imagem.jpg",className:"flex-1 border border-gray-300 dark:border-gray-600 rounded-md p-1.5 text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:y,onChange:r=>E(r.target.value)}),e.jsx("input",{type:"text",placeholder:"Legenda (opcional)",className:"w-1/3 border border-gray-300 dark:border-gray-600 rounded-md p-1.5 text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:O,onChange:r=>G(r.target.value)}),e.jsx("button",{type:"button",onClick:ge,className:"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-3 py-1.5 rounded-md text-sm font-bold hover:bg-gray-300 dark:hover:bg-gray-600",children:"+"})]}),e.jsx("div",{className:"space-y-2",children:(te=s.dedicatedPageConfig)==null?void 0:te.gallery.map((r,a)=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 dark:bg-gray-800/50 p-2 rounded text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[e.jsx("img",{src:r.url,alt:"",className:"w-8 h-8 object-cover rounded"}),e.jsx("span",{className:"truncate text-gray-600 dark:text-gray-300 max-w-[200px]",children:r.caption||"Sem legenda"})]}),e.jsx("button",{type:"button",onClick:()=>xe(r.id),className:"text-red-500 hover:text-red-700",children:"√ó"})]},r.id))})]}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[e.jsx("label",{className:"block text-sm font-bold text-gray-900 dark:text-white mb-2",children:"Cronograma Customizado"}),e.jsxs("div",{className:"grid grid-cols-12 gap-2 mb-2",children:[e.jsx("input",{type:"date",className:"col-span-3 border border-gray-300 dark:border-gray-600 rounded-md p-1.5 text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:c.date||"",onChange:r=>k({...c,date:r.target.value})}),e.jsx("input",{type:"time",className:"col-span-2 border border-gray-300 dark:border-gray-600 rounded-md p-1.5 text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:c.time,onChange:r=>k({...c,time:r.target.value})}),e.jsx("input",{type:"text",placeholder:"T√≠tulo",className:"col-span-3 border border-gray-300 dark:border-gray-600 rounded-md p-1.5 text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:c.title,onChange:r=>k({...c,title:r.target.value})}),e.jsx("input",{type:"text",placeholder:"Descri√ß√£o",className:"col-span-3 border border-gray-300 dark:border-gray-600 rounded-md p-1.5 text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:c.description,onChange:r=>k({...c,description:r.target.value})}),e.jsx("button",{type:"button",onClick:_,className:"col-span-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md font-bold hover:bg-gray-300 dark:hover:bg-gray-600",children:"+"})]}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:(se=s.dedicatedPageConfig)==null?void 0:se.schedule.map(r=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 dark:bg-gray-800/50 p-2 rounded text-xs",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"font-bold text-gray-700 dark:text-gray-300",children:[r.time," - ",r.title]}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400 truncate max-w-xs",children:r.description})]}),e.jsx("button",{type:"button",onClick:()=>U(r.id),className:"text-red-500 hover:text-red-700 text-lg font-bold px-2",children:"√ó"})]},r.id))})]})]})]})]}),e.jsxs("div",{className:"pt-4 mt-auto border-t border-gray-200 dark:border-gray-600 flex justify-between gap-3",children:[e.jsx("button",{type:"button",onClick:q,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 text-sm font-medium",children:"Cancelar"}),e.jsx(me,{type:"submit",isLoading:W,className:"px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-md text-sm font-medium shadow-sm",children:"Salvar Evento"})]})]})},je=()=>{const[f,R]=i.useState([]),[A,N]=i.useState(!0),[o,S]=i.useState(!1),[q,W]=i.useState([]),[z,v]=i.useState([]),[C,P]=i.useState(""),j=be(C,300),[T,g]=i.useState(1),[M,h]=i.useState([void 0]),[V,s]=i.useState(!1),n=10,[l,u]=i.useState(!1),[x,p]=i.useState(void 0),[c,k]=i.useState(null),{addToast:y}=ce();i.useEffect(()=>{Promise.all([I.getCourses(),I.getClasses()]).then(([t,m])=>{W(t),v(m)})},[]);const E=i.useCallback(async t=>{N(!0);try{const m=M[t-1],{data:F,nextCursor:_}=await I.getEvents({limit:n,cursor:m,filters:{searchTerm:j}});R(F),s(!!_),_&&M.length<=t&&h(U=>[...U,_])}catch(m){console.error(m),y("error","Erro ao carregar eventos")}finally{N(!1)}},[M,j,y]);i.useEffect(()=>{h([void 0]),g(1),E(1)},[j]);const O=t=>{g(t),E(t)},G=()=>{p(void 0),u(!0)},H=t=>{p(t),u(!0)},B=t=>{k(t)},Y=async()=>{if(c){S(!0);try{await I.deleteEvent(c),y("success","Evento exclu√≠do com sucesso"),k(null),h([void 0]),g(1),E(1)}catch{y("error","Erro ao excluir evento")}finally{S(!1)}}},Q=async t=>{S(!0);try{if(x)await I.updateEvent({...x,...t}),y("success","Evento atualizado");else{const m={...t,id:`evt_${Date.now()}`,createdAt:new Date().toISOString(),sessions:t.sessions||[],filled:0};await I.createEvent(m),y("success","Evento criado")}u(!1),h([void 0]),g(1),E(1)}catch(m){console.error(m),y("error","Erro ao salvar evento")}finally{S(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Gerenciar Eventos"}),e.jsx("button",{onClick:G,className:"bg-primary text-white px-4 py-2 rounded-lg font-medium hover:bg-indigo-700 transition-colors shadow-sm",children:"+ Novo Evento"})]}),e.jsx("div",{className:"bg-white dark:bg-darkcard p-4 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"w-full relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400 dark:text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",placeholder:"Buscar evento por nome ou descri√ß√£o...",className:"w-full pl-10 py-2 border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-primary focus:border-primary transition-colors",value:C,onChange:t=>P(t.target.value)})]})}),A?e.jsx("div",{className:"bg-white dark:bg-darkcard shadow rounded-md",children:e.jsx("ul",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:[1,2,3].map(t=>e.jsx(ue,{},t))})}):f.length===0?e.jsx(ye,{title:"Nenhum evento encontrado",description:j?"Tente buscar com outro termo.":"Crie o primeiro evento da escola.",action:j?void 0:{label:"Criar Evento",onClick:G}}):e.jsx("div",{className:"bg-white dark:bg-darkcard shadow rounded-md overflow-hidden border border-gray-200 dark:border-gray-700",children:e.jsx("ul",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:f.map(t=>e.jsx("li",{className:"p-4 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:t.name}),e.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full font-bold uppercase tracking-wide border ${t.visibility==="public"?"bg-indigo-50 text-indigo-700 border-indigo-100 dark:bg-indigo-900/30 dark:text-indigo-300 dark:border-indigo-800":t.visibility==="course"?"bg-emerald-50 text-emerald-700 border-emerald-100 dark:bg-emerald-900/30 dark:text-emerald-300 dark:border-emerald-800":"bg-purple-50 text-purple-700 border-purple-100 dark:bg-purple-900/30 dark:text-purple-300 dark:border-purple-800"}`,children:t.visibility==="public"?"P√∫blico":t.visibility==="course"?"Curso":"Turma"}),t.isTeamEvent&&e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full font-bold uppercase tracking-wide bg-amber-50 text-amber-700 border border-amber-100 dark:bg-amber-900/30 dark:text-amber-300 dark:border-amber-800",children:"Equipe"})]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2 line-clamp-1",children:t.description}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 flex flex-wrap gap-4",children:[e.jsxs("span",{children:["üìç ",t.location]}),e.jsxs("span",{children:["üìÖ ",t.sessions.length," Sess√µes"]}),e.jsxs("span",{children:["üë• ",t.sessions.reduce((m,F)=>m+F.filled,0)," Inscritos"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{to:`/admin/events/${t.id}/enrollments`,className:"px-3 py-1.5 text-sm font-medium text-blue-600 bg-blue-50 hover:bg-blue-100 dark:bg-blue-900/20 dark:text-blue-400 dark:hover:bg-blue-900/40 rounded-md transition-colors",children:"Inscritos"}),e.jsx("button",{onClick:()=>H(t),className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600 rounded-md transition-colors",children:"Editar"}),e.jsx("button",{onClick:()=>B(t.id),className:"px-3 py-1.5 text-sm font-medium text-red-600 bg-red-50 hover:bg-red-100 dark:bg-red-900/20 dark:text-red-400 dark:hover:bg-red-900/40 rounded-md transition-colors",children:"Excluir"})]})]})},t.id))})}),e.jsxs("div",{className:"flex justify-between items-center mt-4 border-t border-gray-200 dark:border-gray-700 pt-4",children:[e.jsx("button",{onClick:()=>O(T-1),disabled:T===1||A,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 disabled:opacity-50 transition-colors",children:"Anterior"}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["P√°gina ",T]}),e.jsx("button",{onClick:()=>O(T+1),disabled:!V||A,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 disabled:opacity-50 transition-colors",children:"Pr√≥ximo"})]}),e.jsx(pe,{isOpen:l,onClose:()=>u(!1),title:x?"Editar Evento":"Novo Evento",children:e.jsx(fe,{initialData:x||{},courses:q,classes:z,onSubmit:Q,onCancel:()=>u(!1),isLoading:o})}),e.jsx(ke,{isOpen:!!c,onClose:()=>k(null),onConfirm:Y,title:"Excluir Evento",message:"Tem certeza que deseja excluir este evento? Todas as inscri√ß√µes, equipes e dados relacionados ser√£o perdidos permanentemente.",confirmText:"Excluir Evento",isProcessing:o})]})};export{je as AdminEvents};
