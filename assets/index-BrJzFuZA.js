const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AdminEvents-Bw-GMvbp.js","assets/react-vendor-D244Vx8q.js","assets/vendor-kkeqS5Xn.js","assets/qr-utils-B8AONaXL.js","assets/firebase-CUKyr0uK.js","assets/AdminUsers-DwpqqZNT.js","assets/AdminCourses-BX24vh1W.js","assets/AdminEventEnrollments-C9wNYpP0.js","assets/xlsx-SQR8kOWN.js","assets/AdminScanner-QTR-y27Q.js","assets/DevTools-BhgqNFP9.js"])))=>i.map(i=>d[i]);
import{r as p,j as e,L as q,u as Ne,a as _e,R as oe,b as st,c as kt,Q as Et,H as St,d as It,e as K,N as Se,f as Ct}from"./react-vendor-D244Vx8q.js";import{E as Tt,f as pe}from"./vendor-kkeqS5Xn.js";import{i as At,g as Mt,a as Lt,b as Dt,c as Rt,s as Ke,d as Ye,e as Ot,G as Pt,f as $t,h as D,j as le,k as Ut,o as Ft,l as F,q as z,w as P,m as B,n as rt,p as ne,r as he,t as _t,u as je,v as Pe,x as fe,y as $e,z as qt,A as at,B as zt,C as nt,D as ge}from"./firebase-CUKyr0uK.js";import"./qr-utils-B8AONaXL.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function s(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(r){if(r.ep)return;r.ep=!0;const n=s(r);fetch(r.href,n)}})();var H=(o=>(o.ADMIN="admin",o.USER="user",o))(H||{}),J=(o=>(o.CONFIRMED="confirmed",o.CANCELED="canceled",o.WAITLIST="waitlist",o))(J||{});const X=o=>{if(!o)return"";if(o.match(/^\d{4}-\d{2}-\d{2}$/)){const[t,s,a]=o.split("-");return`${a}/${s}/${t}`}try{const t=new Date(o);return isNaN(t.getTime())?o:new Intl.DateTimeFormat("pt-BR").format(t)}catch{return o}},Xe=o=>{if(!o)return"";try{let t;if(o.match(/^\d{4}-\d{2}-\d{2}$/)){const[s,a,r]=o.split("-").map(Number);t=new Date(s,a-1,r)}else t=new Date(o);return isNaN(t.getTime())?o:new Intl.DateTimeFormat("pt-BR",{weekday:"short",day:"2-digit",month:"2-digit"}).format(t)}catch{return o}},Oe={},Bt=o=>o&&o.apiKey&&o.projectId&&o.appId,Ze={apiKey:"AIzaSyBOUAqkPhqFhsIkZVh97OJau-SzQug1PBE",authDomain:"eduevent-e50f4.firebaseapp.com",projectId:"eduevent-e50f4",storageBucket:"eduevent-e50f4.appspot.com",messagingSenderId:"964945250582",appId:"1:964945250582:web:3ce9fcdad019132561a837",measurementId:"G-KCLHFXEEML",vapidKey:(Oe==null?void 0:Oe.VITE_FIREBASE_VAPID_KEY)||""},se={useFirebase:Bt(Ze),firebase:Ze},Ie=se.firebase;let Ee,W,f,et;const it=o=>o&&o.apiKey&&o.projectId&&o.appId,Vt=async()=>{if("serviceWorker"in navigator&&it(Ie))try{const t=`/EduEvent/firebase-messaging-sw.js?${new URLSearchParams(Ie).toString()}`;return await navigator.serviceWorker.register(t,{scope:"/EduEvent/"})}catch(o){console.error("Service Worker registration failed:",o)}};try{se.useFirebase&&it(Ie)?(Ee=At(Ie),W=Mt(Ee),f=Lt(Ee),typeof window<"u"&&Vt().then(o=>{try{et=Dt(Ee),o&&se.firebase.vapidKey&&Rt(et,{vapidKey:se.firebase.vapidKey,serviceWorkerRegistration:o}).catch(t=>console.log("Push token flow needs user interaction.")),console.log("Firebase Messaging initialized.")}catch(t){console.warn("Failed to initialize Firebase Messaging:",t)}}),console.log("Firebase initialized successfully.")):se.useFirebase?console.warn("Firebase `useFirebase` is true, but config keys are missing. Please check your .env.local file. Skipping Firebase Init."):console.log("`useFirebase` is false. Skipping Firebase Init.")}catch(o){console.error("Error initializing Firebase:",o)}class Wt{mapAuthError(t){switch(t){case"auth/invalid-credential":case"auth/user-not-found":case"auth/wrong-password":return"E-mail ou senha incorretos.";case"auth/email-already-in-use":return"Este e-mail jÃ¡ estÃ¡ em uso.";case"auth/weak-password":return"A senha Ã© muito fraca.";case"auth/invalid-email":return"E-mail invÃ¡lido.";case"auth/popup-closed-by-user":return"Login cancelado.";default:return"Erro na autenticaÃ§Ã£o. Tente novamente."}}async login(t,s){if(!W)throw new Error("ServiÃ§o de autenticaÃ§Ã£o nÃ£o inicializado.");if(!s)throw new Error("A senha Ã© obrigatÃ³ria.");try{await Ke(W,Ye);const a=await Ot(W,t,s);return this._fetchUserProfile(a.user)}catch(a){throw console.error("Erro no Login Firebase:",a),new Error(this.mapAuthError(a.code))}}async loginWithGoogle(){if(!W)throw new Error("ServiÃ§o de autenticaÃ§Ã£o nÃ£o inicializado.");try{await Ke(W,Ye);const t=new Pt;await $t(W,t)}catch(t){throw console.error("Erro ao iniciar Login com Google:",t),new Error(this.mapAuthError(t.code))}}async _fetchUserProfile(t){if(!f)throw new Error("Banco de dados nÃ£o inicializado.");const s=D(f,"users",t.uid);let a;try{a=await le(s)}catch(r){if(console.error("Erro ao acessar Firestore:",r),r.code==="permission-denied")return{uid:t.uid,email:t.email||"",role:H.USER,isOnboarded:!1};throw new Error("Erro de conexÃ£o ao buscar perfil do usuÃ¡rio.")}if(a.exists()){const r=a.data();return{uid:t.uid,email:t.email||"",name:r.name||t.displayName,role:r.role||H.USER,rm:r.rm,courseId:r.courseId,classId:r.classId,isOnboarded:r.isOnboarded||!1}}else return{uid:t.uid,email:t.email||"",name:t.displayName||"",role:H.USER,isOnboarded:!1}}async logout(){W&&await Ut(W)}onAuthStateChanged(t){return W?Ft(W,async s=>{if(s)try{const a=await this._fetchUserProfile(s);t(a)}catch{t({uid:s.uid,email:s.email||"",role:H.USER,isOnboarded:!1})}else t(null)}):(console.warn("Firebase Auth not initialized correctly. Defaulting to logged out state."),t(null),()=>{})}async updateUserProfile(t,s){if(!f)throw new Error("Banco de dados nÃ£o inicializado.");if(s.rm)try{const n=F(f,"users"),i=z(n,P("rm","==",s.rm));if((await B(i)).docs.find(l=>l.id!==t))throw new Error("Este RM jÃ¡ estÃ¡ cadastrado para outro usuÃ¡rio.")}catch(n){if(n.code!=="permission-denied")throw n}const a=D(f,"users",t),r={...s,updatedAt:new Date().toISOString()};s.name&&s.rm&&(r.isOnboarded=!0);try{await rt(a,r,{merge:!0})}catch{throw new Error("NÃ£o foi possÃ­vel salvar seus dados.")}return{...s,uid:t,email:"",role:H.USER,isOnboarded:!0}}async getUserProfile(t){if(!f)throw new Error("ServiÃ§o nÃ£o inicializado.");try{const s=D(f,"users",t),a=await le(s);if(a.exists()){const r=a.data();return{uid:t,email:r.email||"",name:r.name||"UsuÃ¡rio",role:r.role||H.USER,rm:r.rm,courseId:r.courseId,classId:r.classId,isOnboarded:r.isOnboarded}}}catch{console.warn(`Could not fetch profile for ${t} from DB.`)}return W&&W.currentUser&&W.currentUser.uid===t?this._fetchUserProfile(W.currentUser):null}async getUsers(t){if(!f)return{data:[],nextCursor:void 0};const{limit:s,cursor:a,filters:r}=t,{searchTerm:n,role:i,courseId:d,classId:c}=r;try{const l=[ne("email"),he(s)];i&&l.push(P("role","==",i)),d&&l.push(P("courseId","==",d)),c&&l.push(P("classId","==",c)),a&&l.push(_t(a));const m=z(F(f,"users"),...l),x=await B(m);let u=x.docs.map(y=>({uid:y.id,...y.data()}));if(n){const y=n.toLowerCase();u=u.filter(v=>{var E,w;return((E=v.name)==null?void 0:E.toLowerCase().includes(y))||v.email.toLowerCase().includes(y)||((w=v.rm)==null?void 0:w.includes(y))})}const g=x.docs.length===s?x.docs[x.docs.length-1]:void 0;return{data:u,nextCursor:g}}catch(l){return console.error("Erro ao buscar usuÃ¡rios:",l),l.code==="failed-precondition"&&console.warn("Falta Ã­ndice composto. Crie no link do console."),{data:[],nextCursor:void 0}}}async deleteUser(t){if(!f)return;const s=je(f),a=z(F(f,"enrollments"),P("userId","==",t)),n=(await B(a)).docs.map(u=>({id:u.id,...u.data()})),i=Array.from(new Set(n.map(u=>u.eventId))),c=await(async u=>{const g=[];for(let y=0;y<u.length;y+=30){const v=u.slice(y,y+30),E=z(F(f,"events"),P(at(),"in",v)),w=await B(E);g.push(...w.docs.map(A=>({id:A.id,...A.data()})))}return g})(i),l=new Map(c.map(u=>[u.id,u]));n.forEach(u=>{if(u.status===J.CONFIRMED){const g=l.get(u.eventId);if(g){const y=g.sessions.findIndex(v=>v.id===u.sessionId);if(y!==-1&&g.sessions[y].filled>0){const v=[...g.sessions];v[y]={...v[y],filled:Math.max(0,v[y].filled-1)},g.sessions=v,s.update(D(f,"events",g.id),{sessions:v})}}}s.delete(D(f,"enrollments",u.id))});const m=z(F(f,"teams"),P("members","array-contains",t));(await B(m)).forEach(u=>{u.data().captainId===t?s.delete(u.ref):s.update(u.ref,{members:Pe(t)})}),s.delete(D(f,"users",t)),await s.commit()}async updateUserRole(t,s){f&&await fe(D(f,"users",t),{role:s})}}class Gt{async getCourses(){return f?(await B(F(f,"courses"))).docs.map(s=>({id:s.id,...s.data()})):[]}async addCourse(t){if(!f)throw new Error("DB not init");return{id:(await $e(F(f,"courses"),{name:t})).id,name:t}}async updateCourse(t,s){f&&await fe(D(f,"courses",t),{name:s})}async deleteCourse(t){if(!f)return;const s=je(f);s.delete(D(f,"courses",t));const a=z(F(f,"classes"),P("courseId","==",t));(await B(a)).forEach(d=>s.delete(d.ref));const n=z(F(f,"users"),P("courseId","==",t));(await B(n)).forEach(d=>s.update(d.ref,{courseId:""})),await s.commit()}async getClasses(t){if(!f)return[];let s=t?z(F(f,"classes"),P("courseId","==",t)):F(f,"classes");return(await B(s)).docs.map(r=>({id:r.id,...r.data()}))}async addClass(t,s){if(!f)throw new Error("DB not init");return{id:(await $e(F(f,"classes"),{courseId:t,name:s})).id,courseId:t,name:s}}async updateClass(t,s){f&&await fe(D(f,"classes",t),{name:s})}async deleteClass(t){if(!f)return;const s=je(f);await qt(D(f,"classes",t));const a=z(F(f,"users"),P("classId","==",t));(await B(a)).forEach(n=>s.update(n.ref,{classId:""})),await s.commit()}async getEvents(t){if(!f)return{data:[],nextCursor:void 0};const{limit:s,cursor:a,filters:r}=t,{searchTerm:n,visibility:i,course:d}=r,c=50;try{const l=z(F(f,"events"),ne("createdAt","desc"),he(c)),x=(await B(l)).docs.map(w=>({id:w.id,...w.data()}));let u=[];i==="class"&&d&&(u=(await B(F(f,"classes"))).docs.map(A=>({id:A.id,...A.data()})));const g=x.filter(w=>{var k,I;const A=n?w.name.toLowerCase().includes(n.toLowerCase())||w.description.toLowerCase().includes(n.toLowerCase()):!0,j=i?w.visibility===i:!0;let N=!0;return d&&(w.visibility==="public"?N=!1:w.visibility==="course"?N=((k=w.allowedCourses)==null?void 0:k.includes(d))||!1:w.visibility==="class"&&(u.length>0?N=((I=w.allowedClasses)==null?void 0:I.some(T=>{const S=u.find(M=>M.id===T);return(S==null?void 0:S.courseId)===d}))||!1:N=!1)),A&&j&&N}),y=typeof a=="number"?a:0,v=g.slice(y,y+s),E=y+v.length<g.length?y+v.length:void 0;return{data:v,nextCursor:E}}catch{return{data:[],nextCursor:void 0}}}async getEventById(t){if(!f)return;const s=D(f,"events",t),a=await le(s);return a.exists()?{id:a.id,...a.data()}:void 0}async getEventsByIds(t){if(!f||t.length===0)return[];const s=30,a=[];for(let r=0;r<t.length;r+=s){const n=t.slice(r,r+s),i=z(F(f,"events"),P(at(),"in",n)),d=await B(i);a.push(...d.docs.map(c=>({id:c.id,...c.data()})))}return a}async getEventsByParentId(t){if(!f)return[];const s=z(F(f,"events"),P("parentId","==",t));return(await B(s)).docs.map(r=>({id:r.id,...r.data()}))}async getAvailableEventsForUser(t){if(!f)return[];try{const s=F(f,"events"),a=he(50),n=[z(s,P("visibility","==","public"),ne("createdAt","desc"),a)];if(t.courseId){const c=z(s,P("allowedCourses","array-contains",t.courseId),ne("createdAt","desc"),a);n.push(c)}if(t.classId){const c=z(s,P("allowedClasses","array-contains",t.classId),ne("createdAt","desc"),a);n.push(c)}const i=await Promise.all(n.map(c=>B(c).catch(l=>(console.warn("Query falhou (verifique Ã­ndices):",l.message),{docs:[]})))),d=new Map;return i.forEach(c=>{c.docs.forEach(l=>{d.has(l.id)||d.set(l.id,{id:l.id,...l.data()})})}),Array.from(d.values()).sort((c,l)=>(l.createdAt||"").localeCompare(c.createdAt||""))}catch(s){return console.error("Erro crÃ­tico ao buscar eventos:",s),[]}}async getPublicEvents(){if(!f)return[];const t=z(F(f,"events"),P("visibility","==","public"),ne("createdAt","desc"),he(10));return(await B(t)).docs.map(a=>({id:a.id,...a.data()}))}async createEvent(t){if(!f)return;const{id:s,...a}=t;await rt(D(f,"events",s),JSON.parse(JSON.stringify(a)))}async updateEvent(t){if(!f)return;const{id:s,...a}=t;await fe(D(f,"events",s),JSON.parse(JSON.stringify(a)))}async deleteEvent(t){if(!f)return;const s=je(f),a=[t],r=z(F(f,"events"),P("parentId","==",t));(await B(r)).forEach(c=>a.push(c.id));const i=[],d=[];for(let c=0;c<a.length;c+=10)d.push(a.slice(c,c+10));for(const c of d){const l=z(F(f,"enrollments"),P("eventId","in",c));(await B(l)).forEach(g=>i.push(g.ref));const x=z(F(f,"teams"),P("eventId","in",c));(await B(x)).forEach(g=>s.delete(g.ref))}a.forEach(c=>s.delete(D(f,"events",c))),i.forEach(c=>s.delete(c)),await s.commit()}}class Ht{constructor(t,s){this.notificationService=t,this.eventService=s}async getTeamsForEvent(t){if(!f)return[];const s=z(F(f,"teams"),P("eventId","==",t));return(await B(s)).docs.map(r=>({id:r.id,...r.data()}))}async createTeam(t,s,a){if(!f)throw new Error("DB not init");const r=Math.random().toString(36).substring(2,6).toUpperCase(),n=`Equipe #${Math.floor(Math.random()*1e3)}`,i=`team_${Date.now()}`,d={id:i,eventId:t,sessionId:s,name:n,code:r,captainId:a.uid,members:[a.uid],createdAt:new Date().toISOString()};return await ge(f,async c=>{const l=D(f,"events",t),m=await c.get(l);if(!m.exists())throw new Error("Evento nÃ£o encontrado.");const x=`${a.uid}_${t}`,u=D(f,"enrollments",x),g=await c.get(u);if(g.exists()&&g.data().status===J.CONFIRMED)throw new Error("VocÃª jÃ¡ estÃ¡ inscrito neste evento.");const y=m.data(),v=y.sessions.findIndex(A=>A.id===s);if(v===-1)throw new Error("SessÃ£o invÃ¡lida.");if(y.sessions[v].filled>=y.sessions[v].capacity)throw new Error("A sessÃ£o estÃ¡ lotada (limite de equipes atingido).");const E=[...y.sessions];E[v]={...E[v],filled:E[v].filled+1},c.update(l,{sessions:E}),c.set(u,{userId:a.uid,eventId:t,sessionId:s,teamId:i,status:J.CONFIRMED,enrolledAt:new Date().toISOString(),attended:!1});const w=D(f,"teams",i);c.set(w,d)}),d}async joinTeam(t,s,a){if(!f)throw new Error("DB not init");const r=D(f,"teams",t);await ge(f,async n=>{const i=await n.get(r);if(!i.exists())throw new Error("Equipe nÃ£o encontrada.");const d=i.data();if(d.code!==a)throw new Error("CÃ³digo da equipe invÃ¡lido.");if(d.members.includes(s.uid))throw new Error("VocÃª jÃ¡ faz parte desta equipe.");const c=`${s.uid}_${d.eventId}`,l=D(f,"enrollments",c),m=await n.get(l);if(m.exists()&&m.data().status===J.CONFIRMED)throw new Error("VocÃª jÃ¡ estÃ¡ inscrito neste evento.");n.set(l,{userId:s.uid,eventId:d.eventId,sessionId:d.sessionId,teamId:t,status:J.CONFIRMED,enrolledAt:new Date().toISOString(),attended:!1}),n.update(r,{members:nt(s.uid)})});try{const n=await le(r);if(n.exists()){const i=n.data();i.captainId!==s.uid&&await this.notificationService.createNotification({userId:i.captainId,title:"Novo membro na equipe! ðŸ›¡ï¸",message:`${s.name||"Um usuÃ¡rio"} entrou na sua equipe ${i.name}.`,type:"success",createdAt:new Date().toISOString(),read:!1,link:`/event/${i.eventId}`})}}catch(n){console.error("Error creating notification",n)}}async leaveTeam(t,s){if(!f||!W||!W.currentUser)return;const a=W.currentUser.uid,r=D(f,"teams",t);let n=null,i=null,d=!1,c=!1;try{const l=await le(D(f,"users",s));l.exists()&&(i=l.data())}catch{}if(await ge(f,async l=>{const m=await l.get(r);if(!m.exists())throw new Error("Equipe nÃ£o encontrada.");n=m.data();const x=D(f,"events",n.eventId),u=await l.get(x);if(n.captainId===s){d=!0;for(const g of n.members){const y=`${g}_${n.eventId}`,v=D(f,"enrollments",y);l.delete(v)}if(u.exists()){const g=u.data(),y=g.sessions.findIndex(v=>v.id===n.sessionId);if(y!==-1){const v=[...g.sessions];v[y].filled=Math.max(0,v[y].filled-1),l.update(x,{sessions:v})}}l.delete(r)}else{a!==s&&(c=!0),l.update(r,{members:Pe(s)});const g=`${s}_${n.eventId}`,y=D(f,"enrollments",g);l.delete(y)}}),n){const l=n.name,m=(i==null?void 0:i.name)||"Um membro";if(d){const x=n.members.filter(u=>u!==(n==null?void 0:n.captainId));for(const u of x)await this.notificationService.createNotification({userId:u,title:"Equipe Desfeita âš ï¸",message:`A equipe "${l}" foi desfeita pelo capitÃ£o. Sua inscriÃ§Ã£o foi cancelada.`,type:"warning",read:!1,createdAt:new Date().toISOString(),link:"/dashboard"})}else c?await this.notificationService.createNotification({userId:s,title:"Removido da Equipe ðŸš«",message:`VocÃª foi removido da equipe "${l}" pelo capitÃ£o.`,type:"warning",read:!1,createdAt:new Date().toISOString(),link:"/dashboard"}):n.captainId!==s&&await this.notificationService.createNotification({userId:n.captainId,title:"Membro Saiu ðŸƒ",message:`${m} saiu da sua equipe "${l}".`,type:"info",read:!1,createdAt:new Date().toISOString(),link:`/event/${n.eventId}`})}}async kickMember(t,s){return this.leaveTeam(t,s)}async getEnrollmentsForUser(t){if(!f)return[];try{const s=z(F(f,"enrollments"),P("userId","==",t));return(await B(s)).docs.map(n=>({id:n.id,...n.data()})).filter(n=>n.status!==J.CANCELED)}catch(s){return console.error("Error fetching enrollments",s),[]}}async getUserEnrollmentsDetails(t){if(!f)return[];try{const s=z(F(f,"enrollments"),P("userId","==",t),P("status","==",J.CONFIRMED)),r=(await B(s)).docs.map(c=>({id:c.id,...c.data()}));if(r.length===0)return[];const n=Array.from(new Set(r.map(c=>c.eventId))),i=await this.eventService.getEventsByIds(n),d=new Map(i.map(c=>[c.id,c]));return r.map(c=>{const l=d.get(c.eventId);if(!l)return null;const m=l.sessions.find(x=>x.id===c.sessionId);return m?{enrollmentId:c.id,eventName:l.name,eventLocation:l.location,sessionDate:m.date,sessionTime:`${m.startTime} - ${m.endTime}`,enrolledAt:c.enrolledAt}:null}).filter(Boolean)}catch{return[]}}async getEnrichedEnrollments(t){if(!f)return[];const s=z(F(f,"enrollments"),P("eventId","==",t),P("status","==",J.CONFIRMED)),r=(await B(s)).docs.map(l=>({id:l.id,...l.data()}));if(r.length===0)return[];const n=r.map(l=>le(D(f,"users",l.userId))),d=(await Promise.all(n)).map(l=>l.exists()?{uid:l.id,...l.data()}:null),c=await this.eventService.getEventById(t);return c?r.map((l,m)=>{const x=d[m],u=c.sessions.find(g=>g.id===l.sessionId);return{id:l.id,user:{uid:(x==null?void 0:x.uid)||l.userId,name:(x==null?void 0:x.name)||"Desconhecido",email:(x==null?void 0:x.email)||"",rm:(x==null?void 0:x.rm)||"",courseId:x==null?void 0:x.courseId,classId:x==null?void 0:x.classId},session:{id:u.id,date:u.date,startTime:u.startTime,endTime:u.endTime},status:l.status,enrolledAt:l.enrolledAt,teamId:l.teamId,attended:l.attended,checkInAt:l.checkInAt}}):[]}async getEnrollmentDetailsForEvent(t){return(await this.getEnrichedEnrollments(t)).map(a=>({Nome:a.user.name,Email:a.user.email,RM:a.user.rm,SessaoData:X(a.session.date),SessaoHora:`${a.session.startTime}`,Status:a.status,DataInscricao:new Date(a.enrolledAt).toLocaleString("pt-BR"),Presenca:a.attended?"Sim":"NÃ£o"}))}async createEnrollment(t,s,a,r=!1){if(!f)throw new Error("DB not init");const n=await le(D(f,"events",s));if(!n.exists())throw new Error("Evento nÃ£o encontrado");const d=n.data().sessions.find(g=>g.id===a);if(!d)throw new Error("SessÃ£o nÃ£o encontrada");const c=z(F(f,"enrollments"),P("userId","==",t),P("status","==",J.CONFIRMED)),m=(await B(c)).docs.map(g=>g.data());if(m.some(g=>g.eventId===s))throw new Error("VocÃª jÃ¡ estÃ¡ inscrito neste evento");if(m.length>0){const g=[...new Set(m.map(v=>v.eventId))],y=await this.eventService.getEventsByIds(g);for(const v of m){const E=y.find(A=>A.id===v.eventId),w=E==null?void 0:E.sessions.find(A=>A.id===v.sessionId);if(E&&w&&w.date===d.date&&d.startTime<w.endTime&&d.endTime>w.startTime)throw new Error(`CONFLICT|${E.name}|${w.startTime}|${w.endTime}`)}}const x=`enr_${Date.now()}_${t}`,u={id:x,userId:t,eventId:s,sessionId:a,status:J.CONFIRMED,enrolledAt:new Date().toISOString(),attended:!1};return await ge(f,async g=>{const y=D(f,"events",s),v=await g.get(y);if(!v.exists())throw new Error("Evento nÃ£o encontrado");const E=v.data(),w=E.sessions.findIndex(j=>j.id===a);if(w===-1)throw new Error("SessÃ£o nÃ£o encontrada");if(!r){if(E.sessions[w].filled>=E.sessions[w].capacity)throw new Error("A sessÃ£o estÃ¡ lotada");const j=[...E.sessions];j[w].filled+=1,g.update(y,{sessions:j})}const A=D(f,"enrollments",x);g.set(A,u)}),u}async cancelEnrollment(t){if(!f||!W||!W.currentUser)return;const s=W.currentUser.uid;let a=null,r="um evento";await ge(f,async n=>{const i=D(f,"enrollments",t),d=await n.get(i);if(!d.exists())throw new Error("InscriÃ§Ã£o nÃ£o encontrada");a=d.data();const c=D(f,"events",a.eventId),l=await n.get(c);let m=null,x=null;a.teamId&&(m=D(f,"teams",a.teamId),x=await n.get(m));let u=!0;if(a.teamId&&x&&x.exists()&&(x.data().captainId===a.userId?(n.delete(m),u=!0):(n.update(m,{members:Pe(a.userId)}),u=!1)),l.exists()){const g=l.data();if(r=g.name,u){const y=g.sessions.findIndex(v=>v.id===a.sessionId);if(y!==-1){const v=[...g.sessions];v[y].filled=Math.max(0,v[y].filled-1),n.update(c,{sessions:v})}}}n.delete(i)}),a&&a.userId!==s&&await this.notificationService.createNotification({userId:a.userId,title:"InscriÃ§Ã£o Cancelada âš ï¸",message:`Sua inscriÃ§Ã£o no evento "${r}" foi cancelada pela administraÃ§Ã£o.`,type:"warning",read:!1,createdAt:new Date().toISOString(),link:"/dashboard"})}async markAttendance(t){if(!f)throw new Error("DB not init");return await ge(f,async s=>{const a=D(f,"enrollments",t),r=await s.get(a);if(!r.exists())return{success:!1,message:"InscriÃ§Ã£o nÃ£o encontrada."};const n=r.data(),i=await s.get(D(f,"users",n.userId)),d=await s.get(D(f,"events",n.eventId)),c=i.exists()?i.data().name:"Desconhecido",l=d.exists()?d.data().name:"Evento";return n.attended?{success:!1,message:"Check-in jÃ¡ realizado anteriormente.",alreadyAttended:!0,userName:c,eventName:l}:(s.update(a,{attended:!0,checkInAt:new Date().toISOString()}),{success:!0,message:"Check-in realizado com sucesso!",userName:c,eventName:l})})}}class Jt{async getNotifications(t){if(!f)return[];const s=z(F(f,"notifications"),P("userId","==",t),ne("createdAt","desc"),he(20));return(await B(s)).docs.map(r=>({id:r.id,...r.data()}))}subscribeToNotifications(t,s){if(!f)return()=>{};const a=z(F(f,"notifications"),P("userId","==",t),ne("createdAt","desc"),he(20));return zt(a,n=>{const i=n.docs.map(d=>({id:d.id,...d.data()}));s(i)})}async markNotificationAsRead(t){f&&await fe(D(f,"notifications",t),{read:!0})}async markAllNotificationsAsRead(t){if(!f)return;const s=z(F(f,"notifications"),P("userId","==",t),P("read","==",!1)),a=await B(s),r=je(f);a.forEach(n=>r.update(n.ref,{read:!0})),await r.commit()}async createNotification(t){f&&await $e(F(f,"notifications"),t)}async saveDeviceToken(t,s){if(!f)return;const a=D(f,"users",t);await fe(a,{pushTokens:nt(s)})}}class Qt{async resetAndSeedData(){console.log("Reset not supported in Firebase from client.")}async exportData(){return"{}"}async importData(t){}}class Kt{constructor(){this.authService=new Wt,this.eventService=new Gt,this.notificationService=new Jt,this.enrollmentService=new Ht(this.notificationService,this.eventService),this.devService=new Qt}login(t,s){return this.authService.login(t,s)}loginWithGoogle(){return this.authService.loginWithGoogle()}logout(){return this.authService.logout()}onAuthStateChanged(t){return this.authService.onAuthStateChanged(t)}updateUserProfile(t,s){return this.authService.updateUserProfile(t,s)}getUserProfile(t){return this.authService.getUserProfile(t)}getUsers(t){return this.authService.getUsers(t)}deleteUser(t){return this.authService.deleteUser(t)}updateUserRole(t,s){return this.authService.updateUserRole(t,s)}getCourses(){return this.eventService.getCourses()}addCourse(t){return this.eventService.addCourse(t)}updateCourse(t,s){return this.eventService.updateCourse(t,s)}deleteCourse(t){return this.eventService.deleteCourse(t)}getClasses(t){return this.eventService.getClasses(t)}addClass(t,s){return this.eventService.addClass(t,s)}updateClass(t,s){return this.eventService.updateClass(t,s)}deleteClass(t){return this.eventService.deleteClass(t)}getEvents(t){return this.eventService.getEvents(t)}getEventById(t){return this.eventService.getEventById(t)}getEventsByIds(t){return this.eventService.getEventsByIds(t)}getAvailableEventsForUser(t){return this.eventService.getAvailableEventsForUser(t)}getPublicEvents(){return this.eventService.getPublicEvents()}getEventsByParentId(t){return this.eventService.getEventsByParentId(t)}createEvent(t){return this.eventService.createEvent(t)}updateEvent(t){return this.eventService.updateEvent(t)}deleteEvent(t){return this.eventService.deleteEvent(t)}getTeamsForEvent(t){return this.enrollmentService.getTeamsForEvent(t)}createTeam(t,s,a){return this.enrollmentService.createTeam(t,s,a)}joinTeam(t,s,a){return this.enrollmentService.joinTeam(t,s,a)}leaveTeam(t,s){return this.enrollmentService.leaveTeam(t,s)}kickMember(t,s){return this.enrollmentService.kickMember(t,s)}getEnrollmentsForUser(t){return this.enrollmentService.getEnrollmentsForUser(t)}getUserEnrollmentsDetails(t){return this.enrollmentService.getUserEnrollmentsDetails(t)}getEnrichedEnrollments(t){return this.enrollmentService.getEnrichedEnrollments(t)}getEnrollmentDetailsForEvent(t){return this.enrollmentService.getEnrollmentDetailsForEvent(t)}createEnrollment(t,s,a,r){return this.enrollmentService.createEnrollment(t,s,a,r)}cancelEnrollment(t){return this.enrollmentService.cancelEnrollment(t)}markAttendance(t){return this.enrollmentService.markAttendance(t)}getNotifications(t){return this.notificationService.getNotifications(t)}subscribeToNotifications(t,s){return this.notificationService.subscribeToNotifications(t,s)}markNotificationAsRead(t){return this.notificationService.markNotificationAsRead(t)}markAllNotificationsAsRead(t){return this.notificationService.markAllNotificationsAsRead(t)}createNotification(t){return this.notificationService.createNotification(t)}saveDeviceToken(t,s){return this.notificationService.saveDeviceToken(t,s)}resetAndSeedData(){return this.devService.resetAndSeedData()}exportData(){return this.devService.exportData()}importData(t){return this.devService.importData(t)}}const Yt=[{id:"c1",name:"CiÃªncia da ComputaÃ§Ã£o"},{id:"c2",name:"Design Digital"},{id:"c3",name:"AdministraÃ§Ã£o"}],Xt=[{id:"t1",courseId:"c1",name:"CC-2024-A"},{id:"t2",courseId:"c1",name:"CC-2024-B"},{id:"t3",courseId:"c2",name:"DD-2024-A"},{id:"t4",courseId:"c3",name:"ADM-2024-A"}],h={USERS:"eduevent_users",EVENTS:"eduevent_events",ENROLLMENTS:"eduevent_enrollments",TEAMS:"eduevent_teams",NOTIFICATIONS:"eduevent_notifications",CURRENT_USER:"eduevent_current_user",COURSES:"eduevent_courses",CLASSES:"eduevent_classes"},V=o=>new Promise(t=>setTimeout(t,o));class ke{getItems(t){const s=localStorage.getItem(t);return s?JSON.parse(s):[]}saveItems(t,s){localStorage.setItem(t,JSON.stringify(s))}addItem(t,s){const a=this.getItems(t);a.push(s),this.saveItems(t,a)}}class Ue extends ke{constructor(){super(...arguments),this.authListeners=[]}notifyAuthListeners(t){this.authListeners.forEach(s=>s(t))}async login(t,s){await V(500);let r=this.getItems(h.USERS).find(n=>n.email===t);return r||(r={uid:`user_${Date.now()}`,email:t,role:t.includes("admin")?H.ADMIN:H.USER,isOnboarded:!1},this.addItem(h.USERS,r)),localStorage.setItem(h.CURRENT_USER,JSON.stringify(r)),this.notifyAuthListeners(r),r}async loginWithGoogle(){await V(800);const t="google.mock@example.com";let a=this.getItems(h.USERS).find(r=>r.email===t);a||(a={uid:`user_google_${Date.now()}`,email:t,name:"Google Mock User",role:H.USER,isOnboarded:!1},this.addItem(h.USERS,a)),localStorage.setItem(h.CURRENT_USER,JSON.stringify(a)),this.notifyAuthListeners(a)}async logout(){localStorage.removeItem(h.CURRENT_USER),this.notifyAuthListeners(null)}onAuthStateChanged(t){this.authListeners.push(t);const s=localStorage.getItem(h.CURRENT_USER),a=s?JSON.parse(s):null;return t(a),()=>{this.authListeners=this.authListeners.filter(r=>r!==t)}}async updateUserProfile(t,s){await V(600);const a=this.getItems(h.USERS),r=a.findIndex(c=>c.uid===t);if(r===-1)throw new Error("UsuÃ¡rio nÃ£o encontrado");if(s.rm&&a.some(l=>l.rm===s.rm&&l.uid!==t))throw new Error("Este RM jÃ¡ estÃ¡ cadastrado para outro usuÃ¡rio.");const n={...a[r],...s,isOnboarded:!0};a[r]=n,this.saveItems(h.USERS,a);const i=localStorage.getItem(h.CURRENT_USER),d=i?JSON.parse(i):null;return d&&d.uid===t&&(localStorage.setItem(h.CURRENT_USER,JSON.stringify(n)),this.notifyAuthListeners(n)),n}async getUserProfile(t){return await V(100),this.getItems(h.USERS).find(r=>r.uid===t)||null}async getUsers(t){await V(500);const s=this.getItems(h.USERS),{searchTerm:a,role:r,courseId:n,classId:i}=t.filters,d=s.filter(x=>{var E,w;const u=a?((E=x.name)==null?void 0:E.toLowerCase().includes(a.toLowerCase()))||x.email.toLowerCase().includes(a.toLowerCase())||((w=x.rm)==null?void 0:w.includes(a)):!0,g=r?x.role===r:!0,y=n?x.courseId===n:!0,v=i?x.classId===i:!0;return u&&g&&y&&v}),c=t.cursor||0,l=d.slice(c,c+t.limit),m=c+l.length;return{data:l,nextCursor:m<d.length?m:void 0}}async deleteUser(t){await V(500);let s=this.getItems(h.USERS);s=s.filter(a=>a.uid!==t),this.saveItems(h.USERS,s)}async updateUserRole(t,s){await V(300);const a=this.getItems(h.USERS),r=a.findIndex(n=>n.uid===t);r!==-1&&(a[r].role=s,this.saveItems(h.USERS,a))}}class Fe extends ke{constructor(){super(),localStorage.getItem(h.COURSES)||localStorage.setItem(h.COURSES,JSON.stringify(Yt)),localStorage.getItem(h.CLASSES)||localStorage.setItem(h.CLASSES,JSON.stringify(Xt))}async getCourses(){return this.getItems(h.COURSES)}async addCourse(t){const s=this.getItems(h.COURSES),a={id:`c_${Date.now()}`,name:t};return s.push(a),this.saveItems(h.COURSES,s),a}async updateCourse(t,s){const a=this.getItems(h.COURSES),r=a.findIndex(n=>n.id===t);r!==-1&&(a[r].name=s,this.saveItems(h.COURSES,a))}async deleteCourse(t){let s=this.getItems(h.COURSES);s=s.filter(r=>r.id!==t),this.saveItems(h.COURSES,s);let a=this.getItems(h.CLASSES);a=a.filter(r=>r.courseId!==t),this.saveItems(h.CLASSES,a)}async getClasses(t){const s=this.getItems(h.CLASSES);return t?s.filter(a=>a.courseId===t):s}async addClass(t,s){const a=this.getItems(h.CLASSES),r={id:`t_${Date.now()}`,courseId:t,name:s};return a.push(r),this.saveItems(h.CLASSES,a),r}async updateClass(t,s){const a=this.getItems(h.CLASSES),r=a.findIndex(n=>n.id===t);r!==-1&&(a[r].name=s,this.saveItems(h.CLASSES,a))}async deleteClass(t){let s=this.getItems(h.CLASSES);s=s.filter(a=>a.id!==t),this.saveItems(h.CLASSES,s)}async getEvents(t){await V(400);const s=this.getItems(h.EVENTS),{searchTerm:a,visibility:r,course:n}=t.filters,i=this.getItems(h.CLASSES),d=s.filter(x=>{var v,E;const u=a?x.name.toLowerCase().includes(a.toLowerCase())||x.description.toLowerCase().includes(a.toLowerCase()):!0,g=r?x.visibility===r:!0;let y=!0;return n&&(x.visibility==="public"?y=!1:x.visibility==="course"?y=((v=x.allowedCourses)==null?void 0:v.includes(n))||!1:x.visibility==="class"&&(y=((E=x.allowedClasses)==null?void 0:E.some(w=>{const A=i.find(j=>j.id===w);return(A==null?void 0:A.courseId)===n}))||!1)),u&&g&&y}),c=t.cursor||0,l=d.slice(c,c+t.limit),m=c+l.length;return{data:l,nextCursor:m<d.length?m:void 0}}async getEventById(t){return await V(200),this.getItems(h.EVENTS).find(a=>a.id===t)}async getEventsByIds(t){return await V(200),this.getItems(h.EVENTS).filter(a=>t.includes(a.id))}async getEventsByParentId(t){return await V(200),this.getItems(h.EVENTS).filter(a=>a.parentId===t)}async getAvailableEventsForUser(t){return await V(400),this.getItems(h.EVENTS).filter(a=>{var r,n;return a.visibility==="public"?!0:a.visibility==="course"?t.courseId?(r=a.allowedCourses)==null?void 0:r.includes(t.courseId):!1:a.visibility==="class"&&t.classId?(n=a.allowedClasses)==null?void 0:n.includes(t.classId):!1})}async getPublicEvents(){return await V(400),this.getItems(h.EVENTS).filter(s=>s.visibility==="public")}async createEvent(t){await V(600),this.addItem(h.EVENTS,t)}async updateEvent(t){await V(500);const s=this.getItems(h.EVENTS),a=s.findIndex(r=>r.id===t.id);if(a!==-1)s[a]=t,this.saveItems(h.EVENTS,s);else throw new Error("Evento nÃ£o encontrado para atualizaÃ§Ã£o")}async deleteEvent(t){await V(400);let s=this.getItems(h.EVENTS);const a=s.filter(i=>i.id===t||i.parentId===t).map(i=>i.id);s=s.filter(i=>!a.includes(i.id)),this.saveItems(h.EVENTS,s);let r=this.getItems(h.ENROLLMENTS);r=r.filter(i=>!a.includes(i.eventId)),this.saveItems(h.ENROLLMENTS,r);let n=this.getItems(h.TEAMS);n=n.filter(i=>!a.includes(i.eventId)),this.saveItems(h.TEAMS,n)}}class Zt extends ke{constructor(t){super(),this.notificationService=t}async getTeamsForEvent(t){return await V(300),this.getItems(h.TEAMS).filter(a=>a.eventId===t)}async createTeam(t,s,a){await V(500);const r=this.getItems(h.EVENTS),n=r.findIndex(v=>v.id===t);if(n===-1)throw new Error("Evento nÃ£o encontrado.");const i=r[n].sessions.findIndex(v=>v.id===s);if(i===-1)throw new Error("SessÃ£o nÃ£o encontrada.");const d=r[n].sessions[i];if(d.filled>=d.capacity)throw new Error("A sessÃ£o estÃ¡ lotada.");const c=this.getItems(h.TEAMS),l=`team_${Date.now()}`,m=Math.random().toString(36).substring(2,6).toUpperCase(),x=`Equipe #${Math.floor(Math.random()*1e3)}`,u={id:l,eventId:t,sessionId:s,name:x,code:m,captainId:a.uid,members:[a.uid],createdAt:new Date().toISOString()};await this.createEnrollment(a.uid,t,s,!0);const g=this.getItems(h.ENROLLMENTS),y=g.findIndex(v=>v.userId===a.uid&&v.eventId===t);return y!==-1&&(g[y].teamId=l,this.saveItems(h.ENROLLMENTS,g)),r[n].sessions[i].filled+=1,this.saveItems(h.EVENTS,r),c.push(u),this.saveItems(h.TEAMS,c),u}async joinTeam(t,s,a){await V(500);const r=this.getItems(h.TEAMS),n=r.findIndex(c=>c.id===t);if(n===-1)throw new Error("Equipe nÃ£o encontrada.");if(r[n].code!==a)throw new Error("CÃ³digo de equipe invÃ¡lido.");if(r[n].members.includes(s.uid))throw new Error("VocÃª jÃ¡ faz parte desta equipe.");await this.createEnrollment(s.uid,r[n].eventId,r[n].sessionId,!0);const i=this.getItems(h.ENROLLMENTS),d=i.findIndex(c=>c.userId===s.uid&&c.eventId===r[n].eventId);d!==-1&&(i[d].teamId=t,this.saveItems(h.ENROLLMENTS,i)),r[n].members.push(s.uid),this.saveItems(h.TEAMS,r),await this.notificationService.createNotification({userId:r[n].captainId,title:"Novo membro na equipe! ðŸ›¡ï¸",message:`${s.name||"Um usuÃ¡rio"} entrou na sua equipe ${r[n].name}.`,type:"success",createdAt:new Date().toISOString(),read:!1,link:`/event/${r[n].eventId}`})}async leaveTeam(t,s){var x;await V(500);const a=this.getItems(h.TEAMS),r=a.findIndex(u=>u.id===t);if(r===-1)throw new Error("Equipe nÃ£o encontrada.");const n=a[r],i=this.getItems(h.EVENTS),d=i.findIndex(u=>u.id===n.eventId),c=localStorage.getItem(h.CURRENT_USER),l=c?JSON.parse(c):null,m=l==null?void 0:l.uid;if(n.captainId===s){for(const u of n.members){const y=this.getItems(h.ENROLLMENTS).find(v=>v.userId===u&&v.eventId===n.eventId);y&&await this.cancelEnrollment(y.id),u!==s&&await this.notificationService.createNotification({userId:u,title:"Equipe Desfeita âš ï¸",message:`A equipe "${n.name}" foi desfeita pelo capitÃ£o. Sua inscriÃ§Ã£o foi cancelada.`,type:"warning",read:!1,createdAt:new Date().toISOString(),link:"/dashboard"})}if(a.splice(r,1),d!==-1){const u=i[d].sessions.findIndex(g=>g.id===n.sessionId);u!==-1&&(i[d].sessions[u].filled=Math.max(0,i[d].sessions[u].filled-1),this.saveItems(h.EVENTS,i))}}else{n.members=n.members.filter(E=>E!==s);const g=this.getItems(h.ENROLLMENTS).find(E=>E.userId===s&&E.eventId===n.eventId);g&&await this.cancelEnrollment(g.id);const v=((x=this.getItems(h.USERS).find(E=>E.uid===s))==null?void 0:x.name)||"Um membro";m!==s?await this.notificationService.createNotification({userId:s,title:"Removido da Equipe ðŸš«",message:`VocÃª foi removido da equipe "${n.name}" pelo capitÃ£o.`,type:"warning",read:!1,createdAt:new Date().toISOString(),link:"/dashboard"}):await this.notificationService.createNotification({userId:n.captainId,title:"Membro Saiu ðŸƒ",message:`${v} saiu da sua equipe "${n.name}".`,type:"info",read:!1,createdAt:new Date().toISOString(),link:`/event/${n.eventId}`})}this.saveItems(h.TEAMS,a)}async kickMember(t,s){return this.leaveTeam(t,s)}async getEnrollmentsForUser(t){return await V(300),this.getItems(h.ENROLLMENTS).filter(a=>a.userId===t&&a.status!==J.CANCELED)}async getUserEnrollmentsDetails(t){const s=this.getItems(h.ENROLLMENTS).filter(r=>r.userId===t&&r.status===J.CONFIRMED),a=this.getItems(h.EVENTS);return s.map(r=>{const n=a.find(d=>d.id===r.eventId),i=n==null?void 0:n.sessions.find(d=>d.id===r.sessionId);return!n||!i?null:{enrollmentId:r.id,eventName:n.name,eventLocation:n.location,sessionDate:i.date,sessionTime:`${i.startTime} - ${i.endTime}`,enrolledAt:r.enrolledAt}}).filter(Boolean)}async getEnrichedEnrollments(t){const s=this.getItems(h.ENROLLMENTS).filter(n=>n.eventId===t&&n.status===J.CONFIRMED),a=this.getItems(h.USERS),r=this.getItems(h.EVENTS).find(n=>n.id===t);return s.map(n=>{const i=a.find(c=>c.uid===n.userId),d=r==null?void 0:r.sessions.find(c=>c.id===n.sessionId);return{id:n.id,user:{uid:i==null?void 0:i.uid,name:(i==null?void 0:i.name)||"Desconhecido",email:(i==null?void 0:i.email)||"",rm:(i==null?void 0:i.rm)||"",courseId:i==null?void 0:i.courseId,classId:i==null?void 0:i.classId},session:{id:d==null?void 0:d.id,date:d==null?void 0:d.date,startTime:d==null?void 0:d.startTime,endTime:d==null?void 0:d.endTime},status:n.status,enrolledAt:n.enrolledAt,teamId:n.teamId,attended:n.attended,checkInAt:n.checkInAt}})}async getEnrollmentDetailsForEvent(t){const s=this.getItems(h.ENROLLMENTS).filter(n=>n.eventId===t&&n.status===J.CONFIRMED),a=this.getItems(h.USERS),r=this.getItems(h.EVENTS).find(n=>n.id===t);return s.map(n=>{const i=a.find(c=>c.uid===n.userId),d=r==null?void 0:r.sessions.find(c=>c.id===n.sessionId);return{Nome:(i==null?void 0:i.name)||"Desconhecido",Email:(i==null?void 0:i.email)||"",RM:(i==null?void 0:i.rm)||"",SessaoData:X(d==null?void 0:d.date),SessaoHora:(d==null?void 0:d.startTime)||"",Status:n.status,DataInscricao:new Date(n.enrolledAt).toLocaleString("pt-BR"),Presenca:n.attended?"Sim":"NÃ£o"}})}async createEnrollment(t,s,a,r=!1){await V(800);const n=this.getItems(h.EVENTS),i=n.findIndex(g=>g.id===s);if(i===-1)throw new Error("Evento nÃ£o encontrado");const d=n[i].sessions.findIndex(g=>g.id===a);if(d===-1)throw new Error("SessÃ£o nÃ£o encontrada");const c=n[i].sessions[d];if(!r&&c.filled>=c.capacity)throw new Error("A sessÃ£o estÃ¡ lotada");const l=this.getItems(h.ENROLLMENTS),m=l.filter(g=>g.userId===t&&g.status===J.CONFIRMED);if(m.find(g=>g.eventId===s))throw new Error("VocÃª jÃ¡ estÃ¡ inscrito neste evento");for(const g of m){const y=n.find(E=>E.id===g.eventId),v=y==null?void 0:y.sessions.find(E=>E.id===g.sessionId);if(y&&v&&v.date===c.date&&c.startTime<v.endTime&&c.endTime>v.startTime)throw new Error(`CONFLICT|${y.name}|${v.startTime}|${v.endTime}`)}const u={id:`enr_${Date.now()}`,userId:t,eventId:s,sessionId:a,status:J.CONFIRMED,enrolledAt:new Date().toISOString(),attended:!1};return l.push(u),this.saveItems(h.ENROLLMENTS,l),r||(n[i].sessions[d].filled+=1,this.saveItems(h.EVENTS,n)),u}async cancelEnrollment(t){await V(500);const s=localStorage.getItem(h.CURRENT_USER),a=s?JSON.parse(s):null,r=a==null?void 0:a.uid,n=this.getItems(h.ENROLLMENTS),i=n.findIndex(l=>l.id===t);if(i===-1)throw new Error("InscriÃ§Ã£o nÃ£o encontrada");const d=n[i];let c=!0;if(d.teamId){const l=this.getItems(h.TEAMS),m=l.findIndex(x=>x.id===d.teamId);if(m!==-1){const x=l[m];x.members=x.members.filter(u=>u!==d.userId),x.captainId===d.userId?(l.splice(m,1),c=!0):c=!1,this.saveItems(h.TEAMS,l)}}if(c){const l=this.getItems(h.EVENTS),m=l.findIndex(x=>x.id===d.eventId);if(m!==-1){const x=l[m].sessions.findIndex(u=>u.id===d.sessionId);x!==-1&&(l[m].sessions[x].filled=Math.max(0,l[m].sessions[x].filled-1),this.saveItems(h.EVENTS,l))}}n.splice(i,1),this.saveItems(h.ENROLLMENTS,n),r&&d.userId!==r&&await this.notificationService.createNotification({userId:d.userId,title:"InscriÃ§Ã£o Cancelada âš ï¸",message:"Sua inscriÃ§Ã£o foi cancelada pela administraÃ§Ã£o.",type:"warning",read:!1,createdAt:new Date().toISOString(),link:"/dashboard"})}async markAttendance(t){await V(500);const s=this.getItems(h.ENROLLMENTS),a=s.findIndex(i=>i.id===t);if(a===-1)return{success:!1,message:"InscriÃ§Ã£o nÃ£o encontrada."};if(s[a].attended){const i=await new Ue().getUserProfile(s[a].userId),d=await new Fe().getEventById(s[a].eventId);return{success:!1,message:"Check-in jÃ¡ realizado anteriormente.",alreadyAttended:!0,userName:(i==null?void 0:i.name)||"Desconhecido",eventName:(d==null?void 0:d.name)||"Evento"}}s[a].attended=!0,s[a].checkInAt=new Date().toISOString(),this.saveItems(h.ENROLLMENTS,s);const r=await new Ue().getUserProfile(s[a].userId),n=await new Fe().getEventById(s[a].eventId);return{success:!0,message:"Check-in realizado com sucesso!",userName:r==null?void 0:r.name,eventName:n==null?void 0:n.name}}}class es extends ke{async getNotifications(t){return this.getItems(h.NOTIFICATIONS).filter(a=>a.userId===t).sort((a,r)=>r.createdAt.localeCompare(a.createdAt))}subscribeToNotifications(t,s){s(this.getItems(h.NOTIFICATIONS).filter(r=>r.userId===t).sort((r,n)=>n.createdAt.localeCompare(r.createdAt)));const a=setInterval(()=>{const r=this.getItems(h.NOTIFICATIONS).filter(n=>n.userId===t).sort((n,i)=>i.createdAt.localeCompare(n.createdAt));s(r)},3e3);return()=>clearInterval(a)}async markNotificationAsRead(t){const s=this.getItems(h.NOTIFICATIONS),a=s.findIndex(r=>r.id===t);a!==-1&&(s[a].read=!0,this.saveItems(h.NOTIFICATIONS,s))}async markAllNotificationsAsRead(t){const s=this.getItems(h.NOTIFICATIONS);s.forEach(a=>{a.userId===t&&(a.read=!0)}),this.saveItems(h.NOTIFICATIONS,s)}async createNotification(t){const s=this.getItems(h.NOTIFICATIONS),a={...t,id:`notif_${Date.now()}`};s.push(a),this.saveItems(h.NOTIFICATIONS,s)}async saveDeviceToken(t,s){console.log(`[Mock] Saving device token for user ${t}: ${s}`)}}class ts extends ke{async resetAndSeedData(){localStorage.clear(),await V(500);const t=[{id:"c1",name:"CiÃªncia da ComputaÃ§Ã£o"},{id:"c2",name:"Direito"},{id:"c3",name:"Medicina"}];this.saveItems(h.COURSES,t);const s=[{id:"t1",courseId:"c1",name:"CC-2024-A"}];this.saveItems(h.CLASSES,s);const a=[{uid:"u_admin",email:"admin@school.com",name:"Admin",role:H.ADMIN,isOnboarded:!0}];this.saveItems(h.USERS,a)}async exportData(){const t={};return[h.USERS,h.EVENTS,h.ENROLLMENTS,h.COURSES,h.CLASSES,h.TEAMS,h.NOTIFICATIONS].forEach(a=>{t[a]=this.getItems(a)}),JSON.stringify(t,null,2)}async importData(t){try{const s=JSON.parse(t);localStorage.clear();const a={users:h.USERS,events:h.EVENTS,enrollments:h.ENROLLMENTS,courses:h.COURSES,classes:h.CLASSES,teams:h.TEAMS,notifications:h.NOTIFICATIONS,[h.TEAMS]:h.TEAMS};Object.keys(s).forEach(r=>{const n=a[r]||r;if(Array.isArray(s[r])){const i=s[r].map(d=>{const{_id:c,...l}=d;return l});this.saveItems(n,i)}})}catch{throw new Error("Formato de JSON invÃ¡lido.")}}}class ss{constructor(){this.authService=new Ue,this.eventService=new Fe,this.notificationService=new es,this.enrollmentService=new Zt(this.notificationService),this.devService=new ts}login(t,s){return this.authService.login(t,s)}loginWithGoogle(){return this.authService.loginWithGoogle()}logout(){return this.authService.logout()}onAuthStateChanged(t){return this.authService.onAuthStateChanged(t)}updateUserProfile(t,s){return this.authService.updateUserProfile(t,s)}getUserProfile(t){return this.authService.getUserProfile(t)}getUsers(t){return this.authService.getUsers(t)}deleteUser(t){return this.authService.deleteUser(t)}updateUserRole(t,s){return this.authService.updateUserRole(t,s)}getCourses(){return this.eventService.getCourses()}addCourse(t){return this.eventService.addCourse(t)}updateCourse(t,s){return this.eventService.updateCourse(t,s)}deleteCourse(t){return this.eventService.deleteCourse(t)}getClasses(t){return this.eventService.getClasses(t)}addClass(t,s){return this.eventService.addClass(t,s)}updateClass(t,s){return this.eventService.updateClass(t,s)}deleteClass(t){return this.eventService.deleteClass(t)}getEvents(t){return this.eventService.getEvents(t)}getEventById(t){return this.eventService.getEventById(t)}getEventsByIds(t){return this.eventService.getEventsByIds(t)}getAvailableEventsForUser(t){return this.eventService.getAvailableEventsForUser(t)}getPublicEvents(){return this.eventService.getPublicEvents()}getEventsByParentId(t){return this.eventService.getEventsByParentId(t)}createEvent(t){return this.eventService.createEvent(t)}updateEvent(t){return this.eventService.updateEvent(t)}deleteEvent(t){return this.eventService.deleteEvent(t)}getTeamsForEvent(t){return this.enrollmentService.getTeamsForEvent(t)}createTeam(t,s,a){return this.enrollmentService.createTeam(t,s,a)}joinTeam(t,s,a){return this.enrollmentService.joinTeam(t,s,a)}leaveTeam(t,s){return this.enrollmentService.leaveTeam(t,s)}kickMember(t,s){return this.enrollmentService.kickMember(t,s)}getEnrollmentsForUser(t){return this.enrollmentService.getEnrollmentsForUser(t)}getUserEnrollmentsDetails(t){return this.enrollmentService.getUserEnrollmentsDetails(t)}getEnrichedEnrollments(t){return this.enrollmentService.getEnrichedEnrollments(t)}getEnrollmentDetailsForEvent(t){return this.enrollmentService.getEnrollmentDetailsForEvent(t)}createEnrollment(t,s,a,r){return this.enrollmentService.createEnrollment(t,s,a,r)}cancelEnrollment(t){return this.enrollmentService.cancelEnrollment(t)}markAttendance(t){return this.enrollmentService.markAttendance(t)}getNotifications(t){return this.notificationService.getNotifications(t)}subscribeToNotifications(t,s){return this.notificationService.subscribeToNotifications(t,s)}markNotificationAsRead(t){return this.notificationService.markNotificationAsRead(t)}markAllNotificationsAsRead(t){return this.notificationService.markAllNotificationsAsRead(t)}createNotification(t){return this.notificationService.createNotification(t)}saveDeviceToken(t,s){return this.notificationService.saveDeviceToken(t,s)}resetAndSeedData(){return this.devService.resetAndSeedData()}exportData(){return this.devService.exportData()}importData(t){return this.devService.importData(t)}}const rs=()=>se.useFirebase?new Kt:new ss,R=rs(),ot=p.createContext(void 0),as=({children:o})=>{const[t,s]=p.useState(null),[a,r]=p.useState(!0);p.useEffect(()=>{const l=R.onAuthStateChanged(m=>{s(m),r(!1)});return()=>l()},[]);const n=async(l,m)=>{r(!0);try{await R.login(l,m)}catch(x){throw console.error(x),r(!1),x}},i=async()=>{r(!0);try{await R.loginWithGoogle()}catch(l){throw console.error(l),r(!1),l}},d=async()=>{r(!0),await R.logout()},c=async()=>{if(t){r(!0);try{const l=await R.getUserProfile(t.uid);s(l)}catch(l){console.error("Falha ao atualizar o perfil",l)}finally{r(!1)}}};return e.jsx(ot.Provider,{value:{user:t,loading:a,login:n,loginWithGoogle:i,logout:d,refreshProfile:c},children:o})},re=()=>{const o=p.useContext(ot);if(!o)throw new Error("useAuth must be used within an AuthProvider");return o},dt=p.createContext(void 0),ns=({children:o})=>{const[t,s]=p.useState([]),a=p.useCallback(n=>{s(i=>i.filter(d=>d.id!==n))},[]),r=p.useCallback((n,i)=>{const d=Math.random().toString(36).substr(2,9);s(c=>[...c,{id:d,type:n,message:i}]),setTimeout(()=>{a(d)},4e3)},[a]);return e.jsxs(dt.Provider,{value:{addToast:r,removeToast:a},children:[o,e.jsx("div",{className:"fixed bottom-4 right-4 z-[9999] flex flex-col gap-2 pointer-events-none",children:t.map(n=>e.jsxs("div",{className:`pointer-events-auto transform transition-all duration-300 ease-in-out translate-y-0 opacity-100 min-w-[300px] max-w-md p-4 rounded-lg shadow-lg border-l-4 flex items-start justify-between bg-white dark:bg-darkcard dark:border-gray-600
              ${n.type==="success"?"border-green-500":""}
              ${n.type==="error"?"border-red-500":""}
              ${n.type==="warning"?"border-amber-500":""}
              ${n.type==="info"?"border-blue-500":""}
            `,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("span",{className:"text-xl mr-3",children:[n.type==="success"&&"âœ…",n.type==="error"&&"âŒ",n.type==="warning"&&"âš ï¸",n.type==="info"&&"â„¹ï¸"]}),e.jsx("p",{className:"text-sm font-medium text-gray-800 dark:text-gray-200",children:n.message})]}),e.jsx("button",{onClick:()=>a(n.id),className:"ml-4 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 focus:outline-none",children:"Ã—"})]},n.id))})]})},ve=()=>{const o=p.useContext(dt);if(!o)throw new Error("useToast must be used within a ToastProvider");return o},lt=p.createContext(void 0),is=({children:o})=>{const[t,s]=p.useState(()=>{const r=localStorage.getItem("eduevent_theme");return r==="dark"||r==="light"?r:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"});p.useEffect(()=>{const r=window.document.documentElement;t==="dark"?r.classList.add("dark"):r.classList.remove("dark"),localStorage.setItem("eduevent_theme",t)},[t]);const a=()=>{s(r=>r==="light"?"dark":"light")};return e.jsx(lt.Provider,{value:{theme:t,toggleTheme:a},children:o})},os=()=>{const o=p.useContext(lt);if(!o)throw new Error("useTheme must be used within a ThemeProvider");return o},ds=()=>{const{user:o}=re(),[t,s]=p.useState([]),[a,r]=p.useState(0),[n,i]=p.useState(!1),[d,c]=p.useState(!0),[l,m]=p.useState(typeof Notification<"u"?Notification.permission:"denied"),x=p.useCallback(async()=>{if(!(typeof Notification>"u"))try{const v=await Notification.requestPermission();m(v),v==="granted"&&new Notification("EduEvent",{body:"NotificaÃ§Ãµes ativadas com sucesso!",icon:"https://cdn-icons-png.flaticon.com/512/2995/2995458.png"})}catch(v){console.error("Error requesting notification permission:",v)}},[]);p.useEffect(()=>{if(!o)return;const v=R.subscribeToNotifications(o.uid,E=>{if(E.length>0&&t.length>0){const w=E[0],A=t[0];w.id!==A.id&&!w.read&&Notification.permission==="granted"&&new Notification(w.title,{body:w.message,icon:"https://cdn-icons-png.flaticon.com/512/2995/2995458.png"})}s(E),r(E.filter(w=>!w.read).length),c(!1)});return()=>v()},[o]);const u=p.useCallback(async()=>{if(!o)return;const v=localStorage.getItem(`last_event_check_${o.uid}`),w=new Date().toISOString().split("T")[0];if(v!==w)try{const A=await R.getEnrollmentsForUser(o.uid);if(A.length===0)return;const j=[...new Set(A.map(T=>T.eventId))],N=await R.getEventsByIds(j),k=new Date;k.setDate(k.getDate()+1);const I=k.toISOString().split("T")[0];for(const T of A){const S=N.find($=>$.id===T.eventId);if(!S)continue;const M=S.sessions.find($=>$.id===T.sessionId);if(M&&(M.date===w||M.date===I)){const $=M.date===w,L=$?"Evento Hoje! ðŸ“…":"Evento AmanhÃ£! â³",_=`NÃ£o esqueÃ§a: "${S.name}" acontece ${$?"hoje":"amanhÃ£"} Ã s ${M.startTime}.`;t.some(ae=>ae.type==="reminder"&&ae.message===_)||await R.createNotification({userId:o.uid,title:L,message:_,type:"reminder",read:!1,createdAt:new Date().toISOString(),link:`/event/${S.id}`})}}localStorage.setItem(`last_event_check_${o.uid}`,w)}catch(A){console.error("Error checking upcoming events",A)}},[o,t]);return p.useEffect(()=>{u()},[u]),{notifications:t,unreadCount:a,isOpen:n,setIsOpen:i,markAsRead:async v=>{s(E=>E.map(w=>w.id===v?{...w,read:!0}:w)),r(E=>Math.max(0,E-1)),await R.markNotificationAsRead(v)},markAllAsRead:async()=>{o&&(s(v=>v.map(E=>({...E,read:!0}))),r(0),await R.markAllNotificationsAsRead(o.uid))},loading:d,permission:l,requestPermission:x}},tt=()=>{const{notifications:o,unreadCount:t,isOpen:s,setIsOpen:a,markAsRead:r,markAllAsRead:n,permission:i,requestPermission:d}=ds(),c=p.useRef(null);p.useEffect(()=>{const m=x=>{c.current&&!c.current.contains(x.target)&&a(!1)};return document.addEventListener("mousedown",m),()=>document.removeEventListener("mousedown",m)},[a]);const l=m=>{switch(m){case"success":return"âœ…";case"warning":return"âš ï¸";case"reminder":return"â°";default:return"â„¹ï¸"}};return e.jsxs("div",{className:"relative",ref:c,children:[e.jsxs("button",{onClick:()=>a(!s),className:"relative p-2 text-gray-400 hover:text-gray-500 dark:text-gray-400 dark:hover:text-gray-300 focus:outline-none",children:[e.jsx("span",{className:"sr-only",children:"NotificaÃ§Ãµes"}),e.jsx("svg",{className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),t>0&&e.jsx("span",{className:"absolute top-1.5 right-1.5 block h-2.5 w-2.5 rounded-full ring-2 ring-white dark:ring-gray-800 bg-red-500 animate-pulse"})]}),s&&e.jsxs("div",{className:"origin-top-right absolute right-0 mt-2 w-80 rounded-md shadow-lg bg-white dark:bg-darkcard ring-1 ring-black ring-opacity-5 focus:outline-none z-50 overflow-hidden border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"py-2 px-4 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-gray-800",children:[e.jsx("span",{className:"text-sm font-bold text-gray-700 dark:text-gray-200",children:"NotificaÃ§Ãµes"}),t>0&&e.jsx("button",{onClick:n,className:"text-xs text-primary hover:text-indigo-600 dark:text-indigo-400",children:"Marcar todas como lidas"})]}),i==="default"&&e.jsxs("div",{className:"p-3 bg-indigo-50 dark:bg-indigo-900/20 border-b border-indigo-100 dark:border-indigo-800/30",children:[e.jsx("p",{className:"text-xs text-indigo-700 dark:text-indigo-300 mb-2",children:"Receba alertas sobre eventos e mudanÃ§as na sua equipe."}),e.jsx("button",{onClick:d,className:"w-full py-1.5 px-3 bg-white dark:bg-indigo-700 border border-indigo-200 dark:border-indigo-600 rounded text-xs font-bold text-indigo-600 dark:text-white hover:bg-indigo-50 dark:hover:bg-indigo-600 transition-colors shadow-sm",children:"Ativar notificaÃ§Ãµes no desktop ðŸ””"})]}),e.jsx("div",{className:"max-h-80 overflow-y-auto",children:o.length===0?e.jsx("div",{className:"py-8 text-center text-gray-500 dark:text-gray-400 text-sm",children:"Nenhuma notificaÃ§Ã£o."}):e.jsx("ul",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:o.map(m=>e.jsx("li",{className:`p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors ${m.read?"":"bg-indigo-50/50 dark:bg-indigo-900/10"}`,onClick:()=>r(m.id),children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-shrink-0 text-xl pt-1",children:l(m.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`text-sm font-medium ${m.read?"text-gray-600 dark:text-gray-400":"text-gray-900 dark:text-white"}`,children:m.title}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:m.message}),e.jsxs("div",{className:"mt-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] text-gray-400",children:new Date(m.createdAt).toLocaleDateString()}),m.link&&e.jsx(q,{to:m.link,className:"text-xs text-primary font-bold hover:underline",onClick:()=>a(!1),children:"Ver Detalhes"})]})]}),!m.read&&e.jsx("div",{className:"flex-shrink-0 self-center",children:e.jsx("span",{className:"block h-2 w-2 rounded-full bg-primary"})})]})},m.id))})})]})]})},te=({children:o})=>{const{user:t,logout:s}=re(),{theme:a,toggleTheme:r}=os(),n=Ne(),i=_e(),[d,c]=p.useState(!1),l=async()=>{await s(),n("/")},m=u=>i.pathname===u?"bg-indigo-50 border-primary text-primary dark:bg-indigo-900/50 dark:text-indigo-200":"border-transparent text-gray-500 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-gray-200",x=u=>i.pathname===u?"border-primary text-gray-900 dark:text-white dark:border-indigo-400":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200";return t?e.jsxs("div",{className:"min-h-screen flex flex-col bg-gray-50 dark:bg-darkbg transition-colors duration-200",children:[e.jsxs("nav",{className:"bg-white dark:bg-darkcard shadow-sm sticky top-0 z-50 transition-colors duration-200",children:[e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between h-16",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0 flex items-center",children:e.jsx(q,{to:"/dashboard",className:"text-primary font-bold text-xl tracking-tight dark:text-indigo-400",children:"EduEvent"})}),e.jsxs("div",{className:"hidden sm:ml-6 sm:flex sm:space-x-8",children:[e.jsx(q,{to:"/dashboard",className:`inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium transition-colors ${x("/dashboard")}`,children:"Eventos"}),e.jsx(q,{to:"/my-enrollments",className:`inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium transition-colors ${x("/my-enrollments")}`,children:"Minhas InscriÃ§Ãµes"}),t.role===H.ADMIN&&e.jsxs(e.Fragment,{children:[e.jsx(q,{to:"/admin/scanner",className:`inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium transition-colors ${x("/admin/scanner")}`,children:"Scanner"}),e.jsx(q,{to:"/admin/events",className:`inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium transition-colors ${x("/admin/events")}`,children:"Admin Eventos"}),e.jsx(q,{to:"/admin/courses",className:`inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium transition-colors ${x("/admin/courses")}`,children:"Admin Cursos"}),e.jsx(q,{to:"/admin/users",className:`inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium transition-colors ${x("/admin/users")}`,children:"Admin UsuÃ¡rios"}),e.jsx(q,{to:"/admin/dev",className:`inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium text-amber-600 dark:text-amber-400 ${x("/admin/dev")}`,children:"Dev"})]})]})]}),e.jsxs("div",{className:"hidden sm:flex items-center gap-4",children:[e.jsx(tt,{}),e.jsx("button",{onClick:r,className:"p-2 rounded-full text-gray-500 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700 transition-colors",title:a==="dark"?"Mudar para modo claro":"Mudar para modo escuro",children:a==="dark"?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}),e.jsxs("div",{className:"flex-shrink-0 flex items-center",children:[e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400 mr-4",children:t.name||t.email}),e.jsx("button",{onClick:l,className:"relative inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary hover:bg-indigo-700 shadow-sm focus:outline-none transition-colors",children:"Sair"})]})]}),e.jsxs("div",{className:"-mr-2 flex items-center sm:hidden gap-2",children:[e.jsx(tt,{}),e.jsx("button",{onClick:r,className:"p-3 rounded-full text-gray-500 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700 transition-colors",children:a==="dark"?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}),e.jsxs("button",{onClick:()=>c(!d),type:"button",className:"bg-white dark:bg-gray-800 inline-flex items-center justify-center p-3 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary","aria-controls":"mobile-menu","aria-expanded":"false",children:[e.jsx("span",{className:"sr-only",children:"Abrir menu principal"}),d?e.jsx("svg",{className:"block h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}):e.jsx("svg",{className:"block h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})]})]})]})}),d&&e.jsxs("div",{className:"sm:hidden border-t border-gray-200 dark:border-gray-700",id:"mobile-menu",children:[e.jsxs("div",{className:"pt-2 pb-3 space-y-1",children:[e.jsx(q,{to:"/dashboard",onClick:()=>c(!1),className:`block pl-3 pr-4 py-3 border-l-4 text-base font-medium transition-colors ${m("/dashboard")}`,children:"Eventos"}),e.jsx(q,{to:"/my-enrollments",onClick:()=>c(!1),className:`block pl-3 pr-4 py-3 border-l-4 text-base font-medium transition-colors ${m("/my-enrollments")}`,children:"Minhas InscriÃ§Ãµes"}),t.role===H.ADMIN&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pt-4 pb-2",children:e.jsx("span",{className:"px-4 text-xs font-bold text-gray-400 uppercase tracking-wider",children:"AdministraÃ§Ã£o"})}),e.jsx(q,{to:"/admin/scanner",onClick:()=>c(!1),className:`block pl-3 pr-4 py-3 border-l-4 text-base font-medium transition-colors ${m("/admin/scanner")}`,children:"Scanner Check-in"}),e.jsx(q,{to:"/admin/events",onClick:()=>c(!1),className:`block pl-3 pr-4 py-3 border-l-4 text-base font-medium transition-colors ${m("/admin/events")}`,children:"Gerenciar Eventos"}),e.jsx(q,{to:"/admin/courses",onClick:()=>c(!1),className:`block pl-3 pr-4 py-3 border-l-4 text-base font-medium transition-colors ${m("/admin/courses")}`,children:"Gerenciar Cursos"}),e.jsx(q,{to:"/admin/users",onClick:()=>c(!1),className:`block pl-3 pr-4 py-3 border-l-4 text-base font-medium transition-colors ${m("/admin/users")}`,children:"Gerenciar UsuÃ¡rios"}),e.jsx(q,{to:"/admin/dev",onClick:()=>c(!1),className:"block pl-3 pr-4 py-3 border-l-4 text-base font-medium text-amber-600 bg-amber-50 border-amber-300 dark:bg-amber-900/20 dark:border-amber-700 dark:text-amber-500",children:"Dev"})]})]}),e.jsxs("div",{className:"pt-4 pb-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center px-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center text-primary dark:text-indigo-200 font-bold text-lg",children:t.name?t.name.charAt(0):t.email.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("div",{className:"text-base font-medium text-gray-800 dark:text-gray-200",children:t.name||"UsuÃ¡rio"}),e.jsx("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:t.email})]})]}),e.jsx("div",{className:"mt-3 space-y-1",children:e.jsx("button",{onClick:l,className:"block w-full text-left px-4 py-3 text-base font-medium text-gray-500 hover:text-gray-800 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-200 dark:hover:bg-gray-700",children:"Sair do Sistema"})})]})]})]}),e.jsx("main",{className:"flex-1 py-6",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o})})]}):e.jsx(e.Fragment,{children:o})},ie=({children:o,isLoading:t=!1,variant:s="primary",className:a="",disabled:r,...n})=>{const i="relative inline-flex items-center justify-center px-4 py-2 border text-sm font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",d={primary:"border-transparent text-white bg-primary hover:bg-indigo-700 focus:ring-primary",secondary:"border-transparent text-white bg-secondary hover:bg-emerald-700 focus:ring-secondary",danger:"border-transparent text-white bg-red-600 hover:bg-red-700 focus:ring-red-500",outline:"border-gray-300 text-gray-700 bg-white hover:bg-gray-50 focus:ring-primary"};return e.jsxs("button",{disabled:t||r,className:`${i} ${d[s]} ${a}`,...n,children:[e.jsx("span",{className:t?"invisible":"",children:o}),t&&e.jsx("span",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})]})},Ce=o=>{const t=(o==null?void 0:o.code)||"",s=(o==null?void 0:o.message)||"";if(typeof s=="string"&&s.startsWith("CONFLICT|")){const a=s.split("|");return a.length>=4?`Conflito de horÃ¡rio! VocÃª jÃ¡ possui o evento "${a[1]}" agendado entre ${a[2]} e ${a[3]}.`:"Conflito de horÃ¡rio com outro evento jÃ¡ agendado."}if(s==="A sessÃ£o estÃ¡ lotada"||s.includes("capacidade mÃ¡xima"))return"Que pena! Esta sessÃ£o acabou de lotar.";if(s.includes("jÃ¡ estÃ¡ inscrito"))return"VocÃª jÃ¡ garantiu sua vaga neste evento!";if(s.includes("Evento nÃ£o encontrado"))return"O evento que vocÃª procura nÃ£o estÃ¡ mais disponÃ­vel.";switch(t){case"auth/invalid-credential":case"auth/user-not-found":case"auth/wrong-password":return"E-mail ou senha incorretos. Verifique e tente novamente.";case"auth/email-already-in-use":return"Este e-mail jÃ¡ estÃ¡ sendo usado por outra conta.";case"auth/weak-password":return"Sua senha Ã© muito fraca. Escolha uma senha mais forte.";case"auth/invalid-email":return"O formato do e-mail Ã© invÃ¡lido.";case"auth/user-disabled":return"Esta conta foi desativada. Contate o administrador.";case"auth/too-many-requests":return"Muitas tentativas consecutivas. Aguarde alguns instantes.";case"auth/network-request-failed":return"Erro de conexÃ£o. Verifique sua internet.";case"auth/popup-closed-by-user":return"O login foi cancelado.";case"permission-denied":return"VocÃª nÃ£o tem permissÃ£o para realizar esta aÃ§Ã£o.";default:return s||"Ocorreu um erro inesperado. Tente novamente mais tarde."}},ce=({label:o,error:t,helperText:s,as:a="input",className:r="",children:n,id:i,...d})=>{const c=i||d.name||Math.random().toString(36).substr(2,9),l=`${c}-error`,m=`${c}-helper`,x=`
    appearance-none 
    block 
    w-full 
    px-4 
    py-3 
    text-base 
    rounded-lg 
    border 
    bg-white dark:bg-gray-800 
    text-gray-900 dark:text-white 
    placeholder-gray-400 
    focus:outline-none 
    focus:ring-2 
    focus:ring-offset-0
    transition-shadow 
    duration-200
  `,u=t?"border-red-300 focus:border-red-500 focus:ring-red-200 dark:border-red-800 dark:focus:ring-red-900/30":"border-gray-300 dark:border-gray-600 focus:border-primary focus:ring-indigo-100 dark:focus:ring-indigo-900/30",g=[t?l:void 0,s?m:void 0].filter(Boolean).join(" ")||void 0;return e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:c,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5 ml-1",children:o}),e.jsx("div",{className:"relative",children:a==="select"?e.jsx("select",{id:c,className:`${x} ${u} ${r} pr-10`,"aria-invalid":!!t,"aria-describedby":g,...d,children:n}):e.jsx("input",{id:c,className:`${x} ${u} ${r}`,"aria-invalid":!!t,"aria-describedby":g,...d})}),t?e.jsxs("p",{id:l,className:"mt-1.5 text-sm text-red-600 dark:text-red-400 flex items-center animate-fade-in ml-1",role:"alert",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),t]}):s?e.jsx("p",{id:m,className:"mt-1.5 text-sm text-gray-500 dark:text-gray-400 ml-1",children:s}):null]})},ls=()=>{var E,w;const[o,t]=p.useState(""),[s,a]=p.useState(""),{user:r,loading:n,login:i,loginWithGoogle:d}=re(),c=Ne(),l=_e(),{addToast:m}=ve(),[x,u]=p.useState(!1),g=(w=(E=l.state)==null?void 0:E.from)!=null&&w.pathname?l.state.from.pathname+(l.state.from.search||""):"/dashboard";p.useEffect(()=>{!n&&r&&c(g,{replace:!0})},[r,n,c,g]);const y=async A=>{A.preventDefault(),u(!0);try{await i(o,s),m("success","Login realizado com sucesso!")}catch(j){const N=Ce(j);m("error",N)}finally{u(!1)}},v=async()=>{u(!0);try{await d(),m("success","Autenticado com Google!")}catch(A){const j=Ce(A);m("error",j),u(!1)}};return n||!n&&r?e.jsx("div",{className:"h-screen flex items-center justify-center bg-gray-50 dark:bg-darkbg text-primary font-medium",children:"Verificando sessÃ£o..."}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-darkbg py-12 px-4 sm:px-6 lg:px-8 transition-colors duration-300",children:e.jsxs("div",{className:"max-w-md w-full space-y-8 text-center",children:[e.jsx("div",{className:"flex justify-start",children:e.jsxs(q,{to:"/",className:"flex items-center text-sm text-gray-500 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors font-medium p-2 -ml-2 rounded-lg active:bg-gray-100 dark:active:bg-gray-800",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Voltar para o inÃ­cio"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-primary dark:text-indigo-400",children:"EduEvent"}),e.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900 dark:text-white",children:"Acesse sua conta"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:se.useFirebase?"Gerencie suas inscriÃ§Ãµes e eventos em um sÃ³ lugar.":"Ambiente de DemonstraÃ§Ã£o (Mock)"})]}),e.jsxs("form",{className:"mt-8 space-y-2",onSubmit:y,children:[e.jsx(ce,{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,label:"E-mail",placeholder:"seu@email.com",value:o,onChange:A=>t(A.target.value),inputMode:"email"}),e.jsx(ce,{id:"password",name:"password",type:"password",autoComplete:"current-password",required:se.useFirebase,label:"Senha",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",value:s,onChange:A=>a(A.target.value),enterKeyHint:"go"}),e.jsx("div",{className:"pt-4",children:e.jsx(ie,{type:"submit",isLoading:x,className:"w-full h-12 text-base shadow-lg shadow-indigo-200 dark:shadow-none",children:"Acessar Plataforma"})}),e.jsxs("div",{className:"relative my-6",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-700"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-gray-50 dark:bg-darkbg text-gray-500 dark:text-gray-400",children:"Ou entre rapidamente com"})})]}),e.jsxs("button",{type:"button",onClick:v,disabled:x,className:"w-full h-12 flex items-center justify-center px-4 border border-gray-300 dark:border-gray-600 shadow-sm text-base font-medium rounded-lg text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-70 transition-colors active:scale-[0.98]",children:[e.jsxs("svg",{className:"h-5 w-5 mr-3","aria-hidden":"true",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),e.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),e.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.84z",fill:"#FBBC05"}),e.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Google"]})]}),!se.useFirebase&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-4 p-4 border border-dashed border-gray-300 dark:border-gray-700 rounded-lg",children:[e.jsx("p",{className:"font-bold mb-2",children:"Ambiente de Teste (Mock):"}),e.jsxs("ul",{className:"space-y-2",children:[e.jsx("li",{onClick:()=>t("student@school.com"),className:"cursor-pointer hover:text-primary transition-colors p-2 bg-white dark:bg-gray-800 rounded shadow-sm border border-gray-100 dark:border-gray-700",children:"ðŸ‘¤ student@school.com"}),e.jsx("li",{onClick:()=>t("admin@school.com"),className:"cursor-pointer hover:text-primary transition-colors p-2 bg-white dark:bg-gray-800 rounded shadow-sm border border-gray-100 dark:border-gray-700",children:"ðŸ›¡ï¸ admin@school.com"})]})]})]})})},cs=()=>{const{user:o,refreshProfile:t}=re(),s=Ne(),{addToast:a}=ve(),[r,n]=p.useState([]),[i,d]=p.useState([]),[c,l]=p.useState(!1),[m,x]=p.useState({name:(o==null?void 0:o.name)||"",rm:"",courseId:"",classId:""});p.useEffect(()=>{if(o!=null&&o.isOnboarded){s("/dashboard");return}R.getCourses().then(n)},[o,s]),p.useEffect(()=>{m.courseId&&(R.getClasses(m.courseId).then(d),x(g=>({...g,classId:""})))},[m.courseId]);const u=async g=>{if(g.preventDefault(),!!o){l(!0);try{const y={...m,email:o.email,role:o.role};await R.updateUserProfile(o.uid,y),await t(),a("success","Perfil completado com sucesso! Bem-vindo."),s("/dashboard")}catch(y){const v=Ce(y);a("error",v)}finally{l(!1)}}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-darkbg py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900 dark:text-white",children:"Complete seu perfil"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600 dark:text-gray-400",children:"Precisamos de mais alguns detalhes antes de comeÃ§ar."})]}),e.jsxs("form",{className:"mt-8 space-y-4",onSubmit:u,children:[e.jsx(ce,{id:"name",name:"name",type:"text",required:!0,label:"Nome Completo",placeholder:"Ex: JoÃ£o da Silva",value:m.name,onChange:g=>x({...m,name:g.target.value}),autoComplete:"name"}),e.jsx(ce,{id:"rm",name:"rm",type:"text",required:!0,label:"Registro de MatrÃ­cula (RM)",placeholder:"Ex: 12345",value:m.rm,onChange:g=>x({...m,rm:g.target.value}),inputMode:"numeric"}),e.jsxs(ce,{as:"select",label:"Curso",required:!0,value:m.courseId,onChange:g=>x({...m,courseId:g.target.value}),children:[e.jsx("option",{value:"",children:"Selecione o Curso"}),r.map(g=>e.jsx("option",{value:g.id,children:g.name},g.id))]}),e.jsxs(ce,{as:"select",label:"Turma",required:!0,disabled:!m.courseId,value:m.classId,onChange:g=>x({...m,classId:g.target.value}),className:"disabled:opacity-50",children:[e.jsx("option",{value:"",children:"Selecione a Turma"}),i.map(g=>e.jsx("option",{value:g.id,children:g.name},g.id))]}),e.jsx("div",{className:"pt-4",children:e.jsx(ie,{type:"submit",isLoading:c,className:"w-full h-12 text-base shadow-lg",children:"Concluir Cadastro"})})]})]})})},ms=(o,t={})=>{const[s,a]=p.useState(null),[r,n]=p.useState(null),i=t.minSwipeDistance||50;return{onTouchStart:m=>{n(null),a({x:m.targetTouches[0].clientX,y:m.targetTouches[0].clientY})},onTouchMove:m=>{n({x:m.targetTouches[0].clientX,y:m.targetTouches[0].clientY})},onTouchEnd:()=>{if(!s||!r)return;const m=s.x-r.x,x=s.y-r.y;if(Math.abs(m)>Math.abs(x)){if(Math.abs(m)<i)return;m>0?o.onSwipeLeft&&o.onSwipeLeft():o.onSwipeRight&&o.onSwipeRight()}else{if(Math.abs(x)<i)return;x>0?o.onSwipeUp&&o.onSwipeUp():o.onSwipeDown&&o.onSwipeDown()}}}},me=({isOpen:o,onClose:t,title:s,children:a})=>{const r=p.useRef(null),n=p.useRef(null),i=ms({onSwipeDown:t});return p.useEffect(()=>(o?(n.current=document.activeElement,document.body.style.overflow="hidden",setTimeout(()=>{r.current&&r.current.focus()},50)):(document.body.style.overflow="unset",n.current&&n.current.focus()),()=>{document.body.style.overflow="unset"}),[o]),p.useEffect(()=>{const d=c=>{c.key==="Escape"&&t()};return o&&window.addEventListener("keydown",d),()=>{window.removeEventListener("keydown",d)}},[o,t]),o?e.jsx("div",{className:"fixed inset-0 z-[100] overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 dark:bg-gray-900 bg-opacity-75 dark:bg-opacity-80 transition-opacity animate-fade-in","aria-hidden":"true",onClick:t}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"â€‹"}),e.jsxs("div",{ref:r,tabIndex:-1,className:`
              inline-block align-bottom bg-white dark:bg-darkcard 
              rounded-t-2xl sm:rounded-lg 
              text-left overflow-hidden shadow-xl 
              transform transition-all 
              w-full sm:my-8 sm:align-middle sm:max-w-lg 
              animate-slide-in outline-none
              relative
            `,...i,children:[e.jsx("div",{className:"sm:hidden w-full flex justify-center pt-3 pb-1",onClick:t,children:e.jsx("div",{className:"w-12 h-1.5 bg-gray-300 dark:bg-gray-600 rounded-full"})}),e.jsx("div",{className:"bg-white dark:bg-darkcard px-4 pt-2 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 text-center sm:mt-0 sm:text-left w-full",children:[e.jsx("h3",{className:"text-lg leading-6 font-bold text-gray-900 dark:text-white",id:"modal-title",children:s}),e.jsx("div",{className:"mt-4 text-gray-600 dark:text-gray-300",children:a})]})})}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800/50 px-4 py-4 sm:px-6 sm:flex sm:flex-row-reverse border-t border-gray-100 dark:border-gray-700",children:e.jsx("button",{type:"button",className:"w-full inline-flex justify-center rounded-lg border border-gray-300 dark:border-gray-600 shadow-sm px-4 py-3 bg-white dark:bg-gray-700 text-base font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm sm:py-2 transition-colors active:scale-[0.98]",onClick:t,children:"Fechar"})})]})]})}):null},xs=({currentPage:o,totalItems:t,itemsPerPage:s,onPageChange:a})=>{const r=Math.ceil(t/s);if(r<=1)return null;const n=()=>{const i=[];if(r<=7)for(let d=1;d<=r;d++)i.push(d);else o<=4?i.push(1,2,3,4,5,"...",r):o>=r-3?i.push(1,"...",r-4,r-3,r-2,r-1,r):i.push(1,"...",o-1,o,o+1,"...",r);return i};return e.jsxs("div",{className:"flex items-center justify-between border-t border-gray-200 bg-white px-4 py-3 sm:px-6 mt-4 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex flex-1 justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>a(Math.max(1,o-1)),disabled:o===1,className:"relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Anterior"}),e.jsx("button",{onClick:()=>a(Math.min(r,o+1)),disabled:o===r,className:"relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"PrÃ³ximo"})]}),e.jsxs("div",{className:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Mostrando ",e.jsx("span",{className:"font-medium",children:(o-1)*s+1})," a ",e.jsx("span",{className:"font-medium",children:Math.min(o*s,t)})," de ",e.jsx("span",{className:"font-medium",children:t})," resultados"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination",children:[e.jsxs("button",{onClick:()=>a(Math.max(1,o-1)),disabled:o===1,className:"relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50",children:[e.jsx("span",{className:"sr-only",children:"Anterior"}),e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z",clipRule:"evenodd"})})]}),n().map((i,d)=>typeof i=="number"?e.jsx("button",{onClick:()=>a(i),"aria-current":o===i?"page":void 0,className:`relative inline-flex items-center px-4 py-2 text-sm font-semibold ${o===i?"z-10 bg-primary text-white focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0"}`,children:i},d):e.jsx("span",{className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700 ring-1 ring-inset ring-gray-300 focus:outline-offset-0",children:"..."},d)),e.jsxs("button",{onClick:()=>a(Math.min(r,o+1)),disabled:o===r,className:"relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50",children:[e.jsx("span",{className:"sr-only",children:"PrÃ³ximo"}),e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z",clipRule:"evenodd"})})]})]})})]})]})},ct=(o,t)=>{const[s,a]=p.useState(null),[r,n]=p.useState(!1),{addToast:i}=ve(),d=p.useCallback(()=>{a(null)},[]),c=p.useCallback(async(m,x)=>{if(o){d(),n(!0);try{await R.createEnrollment(o.uid,m.id,x),i("success",`InscriÃ§Ã£o confirmada em ${m.name}!`),setTimeout(()=>t(),500)}catch(u){const g=u.message||"";if(g.startsWith("CONFLICT|")){const[y,v,E,w]=g.split("|");a({name:v,time:`${E} - ${w}`}),i("warning","Conflito de horÃ¡rio detectado.")}else{const y=Ce(u);i("error",y)}}finally{n(!1)}}},[o,t,d,i]),l=p.useCallback(async m=>{if(o){n(!0);try{await R.cancelEnrollment(m),i("success","InscriÃ§Ã£o cancelada com sucesso."),setTimeout(()=>t(),500)}catch(x){i("error","Erro ao cancelar inscriÃ§Ã£o."),console.error(x)}finally{n(!1)}}},[o,t,i]);return{handleEnroll:c,handleCancel:l,isProcessing:r,isEnrolling:r,conflictData:s,clearState:d}};function us(o,t=300){const[s,a]=p.useState(o);return p.useEffect(()=>{const r=setTimeout(()=>{a(o)},t);return()=>{clearTimeout(r)}},[o,t]),s}const gs=o=>{const[t,s]=p.useState([]),[a,r]=p.useState([]),[n,i]=p.useState(!0),[d,c]=p.useState(""),[l,m]=p.useState(""),[x,u]=p.useState(!1),[g,y]=p.useState(1),v=9,E=us(d,300),w=p.useCallback(async(I=!0)=>{if(o){I&&i(!0);try{const[T,S]=await Promise.all([R.getAvailableEventsForUser(o),R.getEnrollmentsForUser(o.uid)]);s(T),r(S)}catch(T){console.error(T)}finally{I&&i(!1)}}},[o]);p.useEffect(()=>{w()},[w]);const A=p.useMemo(()=>{const I=new Set;return t.forEach(T=>{T.parentId&&I.add(T.parentId)}),I},[t]),j=p.useMemo(()=>{const I=new Date().toISOString().split("T")[0];return t.filter(T=>{if(T.parentId)return!1;const S=T.name.toLowerCase().includes(E.toLowerCase())||T.description.toLowerCase().includes(E.toLowerCase()),M=t.filter(U=>U.parentId===T.id),$=[...T.sessions,...M.flatMap(U=>U.sessions)],L=l?$.some(U=>U.date===l):!0,_=x||$.some(U=>U.date>=I);return S&&L&&_})},[t,E,l,x]);p.useEffect(()=>{y(1)},[E,l,x]);const N=p.useMemo(()=>{const I=(g-1)*v;return j.slice(I,I+v)},[j,g]),k=(I,T)=>a.find(S=>S.eventId===I&&S.sessionId===T);return{events:t,filteredEvents:j,paginatedEvents:N,parentIds:A,loading:n,filters:{searchTerm:d,setSearchTerm:c,filterDate:l,setFilterDate:m,showPastEvents:x,setShowPastEvents:u},pagination:{currentPage:g,setCurrentPage:y,totalItems:j.length,itemsPerPage:v},helpers:{getEnrollment:k},refresh:()=>w(!1)}},hs=()=>e.jsx("li",{className:"px-6 py-4 animate-pulse",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/5"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/5"})]}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-24"})]})}),fs=()=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 flex flex-col h-full animate-pulse",children:[e.jsxs("div",{className:"p-5 flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded-full w-1/3"})]}),e.jsx("div",{className:"h-5 bg-gray-200 rounded w-4/5 mb-2"}),e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-5/6"})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/3"})]}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"h-2 bg-gray-200 rounded-full"})})]}),e.jsx("div",{className:"w-full h-12 bg-gray-100 border-t border-gray-200"})]}),zs=()=>e.jsxs("tr",{className:"animate-pulse",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200"}),e.jsxs("div",{className:"ml-4 space-y-2",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-24"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-32"})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap space-y-2",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-20"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-16"})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"h-3 bg-gray-200 rounded w-12"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"h-5 bg-gray-200 rounded-full w-16"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2",children:e.jsx("div",{className:"h-5 bg-gray-200 rounded w-36 inline-block"})})]}),Bs=()=>e.jsxs("div",{className:"bg-white shadow rounded-lg p-4 flex flex-col space-y-3 animate-pulse",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-24"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-32"})]})]}),e.jsx("div",{className:"h-5 bg-gray-200 rounded-full w-16"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 border-t border-b border-gray-100 py-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"h-2 bg-gray-200 rounded w-10"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-20"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"h-2 bg-gray-200 rounded w-10"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-16"})]})]}),e.jsx("div",{className:"flex justify-end pt-1",children:e.jsx("div",{className:"h-6 bg-gray-200 rounded w-48"})})]}),mt=({icon:o,title:t,description:s,action:a})=>e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 text-center bg-white dark:bg-darkcard rounded-lg border-2 border-dashed border-gray-200 dark:border-gray-700 transition-colors duration-200",children:[e.jsx("div",{className:"text-5xl text-gray-300 dark:text-gray-600 mb-4 transition-colors duration-200",children:o||"ðŸ“­"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-1",children:t}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 max-w-sm mb-6",children:s}),a&&e.jsx("button",{onClick:a.onClick,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-primary dark:text-indigo-300 bg-indigo-50 dark:bg-indigo-900/30 hover:bg-indigo-100 dark:hover:bg-indigo-900/50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition-colors duration-200",children:a.label})]}),qe=({isOpen:o,onClose:t,onConfirm:s,title:a,message:r,confirmText:n="Confirmar",cancelText:i="Cancelar",isProcessing:d=!1,variant:c="danger"})=>e.jsx(me,{isOpen:o,onClose:()=>!d&&t(),title:a,children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-gray-700",children:r}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:t,disabled:d,className:"px-4 py-2 bg-gray-100 rounded-md hover:bg-gray-200 text-gray-800 text-sm font-medium disabled:opacity-50",children:i}),e.jsx(ie,{onClick:s,isLoading:d,variant:c,children:n})]})]})}),ps=({isOpen:o,onClose:t})=>{const[s,a]=p.useState(0),[r,n]=p.useState(!1);if(!o)return null;const i=[{title:"Bem-vindo ao EduEvent! ðŸŽ“",description:"Sua nova central para descobrir, gerenciar e participar dos melhores eventos acadÃªmicos e escolares da sua instituiÃ§Ã£o.",color:"bg-indigo-500",image:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",className:"w-32 h-32 text-indigo-600 dark:text-indigo-400",children:[e.jsx("path",{d:"M22 10v6M2 10l10-5 10 5-10 5z"}),e.jsx("path",{d:"M6 12v5c3 3 9 3 12 0v-5"})]})},{title:"Explore Eventos IncrÃ­veis ðŸŒ",description:"Navegue pelo Dashboard para encontrar eventos. Use os filtros inteligentes para buscar por data, nome ou ver apenas o que Ã© relevante para seu curso.",color:"bg-emerald-500",image:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",className:"w-32 h-32 text-emerald-600 dark:text-emerald-400",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}),e.jsx("path",{d:"M11 8v6M8 11h6"})]})},{title:"InscriÃ§Ã£o em 1 Clique ðŸ‘†",description:"Gostou de um evento? Clique em 'Garantir Vaga' ou 'Inscrever'. O sistema verifica conflitos de horÃ¡rio automaticamente para vocÃª.",color:"bg-amber-500",image:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",className:"w-32 h-32 text-amber-600 dark:text-amber-400",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("path",{d:"M9 15l2 2 4-4"})]})},{title:"Sua Agenda Organizada ðŸ“…",description:"Acesse 'Minhas InscriÃ§Ãµes' para ver todos os seus compromissos confirmados. VocÃª pode cancelar inscriÃ§Ãµes se mudar de ideia.",color:"bg-purple-500",image:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",className:"w-32 h-32 text-purple-600 dark:text-purple-400",children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),e.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),e.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"}),e.jsx("path",{d:"M8 14h.01"}),e.jsx("path",{d:"M12 14h.01"}),e.jsx("path",{d:"M16 14h.01"}),e.jsx("path",{d:"M8 18h.01"}),e.jsx("path",{d:"M12 18h.01"}),e.jsx("path",{d:"M16 18h.01"})]})},{title:"Tudo Pronto! ðŸš€",description:"VocÃª jÃ¡ sabe o bÃ¡sico. Agora Ã© com vocÃª! Explore, aprenda e aproveite ao mÃ¡ximo os eventos da sua escola.",color:"bg-primary",image:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",className:"w-32 h-32 text-primary dark:text-indigo-400",children:[e.jsx("path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"}),e.jsx("path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"}),e.jsx("path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"}),e.jsx("path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"})]})}],d=()=>{s<i.length-1?(n(!0),setTimeout(()=>{a(m=>m+1),n(!1)},300)):t()},c=()=>{t()},l=i[s];return e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-gray-900/60 backdrop-blur-sm transition-opacity",onClick:c}),e.jsxs("div",{className:"relative bg-white dark:bg-darkcard w-full max-w-md rounded-2xl shadow-2xl overflow-hidden flex flex-col min-h-[500px] animate-fade-in border border-gray-100 dark:border-gray-700",children:[e.jsx("div",{className:`h-2 w-full ${l.color} transition-colors duration-500`}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-8 text-center",children:[e.jsx("div",{className:`mb-8 p-6 bg-gray-50 dark:bg-gray-800 rounded-full transition-all duration-300 transform ${r?"opacity-0 scale-90 translate-x-4":"opacity-100 scale-100 translate-x-0"}`,children:l.image}),e.jsxs("div",{className:`transition-all duration-300 ${r?"opacity-0 translate-y-4":"opacity-100 translate-y-0"}`,children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-3",children:l.title}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 leading-relaxed",children:l.description})]})]}),e.jsxs("div",{className:"p-6 bg-gray-50 dark:bg-gray-800/50 border-t border-gray-100 dark:border-gray-700",children:[e.jsx("div",{className:"flex justify-center space-x-2 mb-6",children:i.map((m,x)=>e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${x===s?`w-6 ${l.color}`:"w-2 bg-gray-300 dark:bg-gray-600"}`},x))}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:c,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 font-medium text-sm px-4 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:"Pular Tutorial"}),e.jsxs("button",{onClick:d,className:`px-6 py-2.5 rounded-xl text-white font-bold shadow-lg shadow-indigo-500/20 transform transition active:scale-95 flex items-center ${l.color} hover:brightness-110`,children:[s===i.length-1?"ComeÃ§ar Agora":"PrÃ³ximo",s<i.length-1&&e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})]})]})},vs=oe.memo(({event:o,hasChildren:t,onAction:s})=>{const a=!t&&o.sessions.length===1?o.sessions[0]:null,r=a?a.capacity:0,n=a?a.filled:0,i=r>0?n/r*100:0,d=r>0&&n>=r;let c="bg-indigo-500",l="PÃºblico";return o.visibility==="course"&&(c="bg-emerald-500",l="Meu Curso"),o.visibility==="class"&&(c="bg-purple-500",l="Minha Turma"),e.jsxs("div",{className:"group bg-white dark:bg-darkcard rounded-xl shadow-sm hover:shadow-xl transition-all duration-300 overflow-hidden border border-gray-100 dark:border-gray-700 flex flex-col h-full relative animate-fade-in hover:-translate-y-1",children:[e.jsx("div",{className:`absolute top-0 left-0 w-1.5 h-full ${c} opacity-80`}),e.jsxs("div",{className:"p-5 flex-1 flex flex-col ml-2",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx("span",{className:`text-[10px] uppercase tracking-wider font-bold px-2 py-1 rounded-md ${c} bg-opacity-10 dark:bg-opacity-20 text-gray-700 dark:text-gray-200`,children:l}),o.isTeamEvent&&e.jsxs("span",{className:"text-[10px] uppercase tracking-wider font-bold px-2 py-1 rounded-md bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 border border-purple-200 dark:border-purple-800 flex items-center gap-1",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"})}),"Equipe"]})]}),t?e.jsx("span",{className:"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 text-xs px-2 py-1 rounded-full font-medium border border-gray-200 dark:border-gray-600",children:"Evento Principal"}):d&&a?e.jsxs("span",{className:"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 text-xs px-2 py-1 rounded-full font-bold flex items-center",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-red-500 rounded-full mr-1.5"}),"Esgotado"]}):e.jsxs("span",{className:"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 text-xs px-2 py-1 rounded-full font-bold flex items-center",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-green-500 rounded-full mr-1.5"}),"Aberto"]})]}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white leading-tight mb-2 group-hover:text-primary dark:group-hover:text-indigo-400 transition-colors",children:o.name}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm line-clamp-2 mb-4 flex-1",children:o.description}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-300 mt-auto",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 flex justify-center text-gray-400 dark:text-gray-500 mr-2",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),e.jsx("span",{className:"font-medium",children:o.location})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 flex justify-center text-gray-400 dark:text-gray-500 mr-2",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("span",{className:"font-medium",children:t?"Ver programaÃ§Ã£o completa":o.sessions.length>1?`${o.sessions.length} horÃ¡rios disponÃ­veis`:`${X(a==null?void 0:a.date)} â€¢ ${a==null?void 0:a.startTime}`})]})]}),!t&&a&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1 font-medium",children:[e.jsx("span",{className:d?"text-red-600 dark:text-red-400":"text-gray-500 dark:text-gray-400",children:d?"Sem vagas":o.isTeamEvent?`${r-n} equipes restantes`:`${r-n} vagas restantes`}),e.jsxs("span",{className:"text-gray-400 dark:text-gray-500",children:[Math.round(i),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-100 dark:bg-gray-700 rounded-full h-1.5 overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${d?"bg-red-500":i>80?"bg-amber-400":"bg-emerald-500"}`,style:{width:`${i}%`}})})]})]}),e.jsxs("button",{onClick:()=>s(o),className:"w-full py-3 text-sm font-bold text-primary dark:text-indigo-300 bg-indigo-50 dark:bg-gray-800/50 hover:bg-primary hover:text-white dark:hover:bg-indigo-600 dark:hover:text-white transition-colors border-t border-indigo-100 dark:border-gray-700 flex justify-center items-center",children:[t||o.isTeamEvent?"Ver Detalhes":"Ver Detalhes e Inscrever",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})}),bs=({searchTerm:o,onSearchChange:t,filterDate:s,onDateChange:a,showPastEvents:r,onTogglePast:n})=>e.jsxs("div",{className:"bg-white dark:bg-darkcard p-5 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col lg:flex-row gap-4 items-end transition-colors duration-200",children:[e.jsxs("div",{className:"flex-1 w-full",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 mb-1 uppercase tracking-wider",children:"Buscar Evento"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400 dark:text-gray-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})})}),e.jsx("input",{type:"text",placeholder:"Nome, descriÃ§Ã£o, local...",className:"pl-10 w-full border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:ring-primary focus:border-primary sm:text-sm bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white py-2.5 transition-colors",value:o,onChange:i=>t(i.target.value)})]})]}),e.jsxs("div",{className:"w-full lg:w-48",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 mb-1 uppercase tracking-wider",children:"Data EspecÃ­fica"}),e.jsx("input",{type:"date",className:"w-full border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:ring-primary focus:border-primary sm:text-sm bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white py-2.5 transition-colors",value:s,onChange:i=>a(i.target.value)})]}),e.jsx("div",{className:"w-full lg:w-auto pb-2",children:e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsxs("div",{className:"relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in",children:[e.jsx("input",{type:"checkbox",className:"toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer",checked:r,onChange:i=>n(i.target.checked),style:{right:r?"0":"auto",left:r?"auto":"0",borderColor:r?"#4F46E5":"#E5E7EB"}}),e.jsx("label",{className:`toggle-label block overflow-hidden h-6 rounded-full cursor-pointer ${r?"bg-primary":"bg-gray-300 dark:bg-gray-600"}`})]}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Mostrar Passados"})]})})]}),ys=()=>{const{user:o}=re(),t=Ne(),{events:s,paginatedEvents:a,parentIds:r,loading:n,filters:i,pagination:d,helpers:c,refresh:l}=gs(o),[m,x]=p.useState(null),[u,g]=p.useState(null),[y,v]=p.useState(!1);p.useEffect(()=>{if(!localStorage.getItem("eduevent_tutorial_completed")){const M=setTimeout(()=>v(!0),1e3);return()=>clearTimeout(M)}},[]);const E=()=>{v(!1),localStorage.setItem("eduevent_tutorial_completed","true")},w=p.useCallback(()=>{l(),g(null)},[l]),{handleEnroll:A,handleCancel:j,isProcessing:N,conflictData:k,clearState:I}=ct(o,w);p.useEffect(()=>{if(m){const S=s.find(M=>M.id===m.id);S&&JSON.stringify(S)!==JSON.stringify(m)&&x(S)}},[s,m]);const T=p.useCallback(S=>{r.has(S.id)||S.isTeamEvent?t(`/event/${S.id}`):(I(),x(S))},[r,t,I]);return e.jsxs("div",{className:"space-y-8 animate-fade-in relative",children:[e.jsx(ps,{isOpen:y,onClose:E}),e.jsx("header",{className:"flex flex-col md:flex-row md:justify-between md:items-end gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-extrabold text-gray-900 dark:text-white tracking-tight",children:"Dashboard de Eventos"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Explore e inscreva-se nas atividades disponÃ­veis para seu perfil."})]})}),e.jsx(bs,{searchTerm:i.searchTerm,onSearchChange:i.setSearchTerm,filterDate:i.filterDate,onDateChange:i.setFilterDate,showPastEvents:i.showPastEvents,onTogglePast:i.setShowPastEvents}),n?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((S,M)=>e.jsx(fs,{},M))}):a.length===0?e.jsx(mt,{title:"Nenhum evento encontrado",description:s.length===0?"NÃ£o hÃ¡ eventos disponÃ­veis para o seu curso ou turma no momento.":i.showPastEvents?"Nenhum evento corresponde aos filtros de busca.":"NÃ£o hÃ¡ eventos futuros correspondentes. Tente ativar 'Mostrar Passados'.",action:!i.showPastEvents&&s.length>0?{label:"Ver histÃ³rico de eventos",onClick:()=>i.setShowPastEvents(!0)}:void 0}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(S=>e.jsx(vs,{event:S,hasChildren:r.has(S.id),onAction:T},S.id))}),e.jsx(xs,{currentPage:d.currentPage,totalItems:d.totalItems,itemsPerPage:d.itemsPerPage,onPageChange:d.setCurrentPage})]}),e.jsx(me,{isOpen:!!m,onClose:()=>x(null),title:m?m.name:"",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:e.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed",children:m==null?void 0:m.description})}),k&&e.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/30 border-l-4 border-amber-400 p-4 rounded-r-md animate-slide-in",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-amber-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-bold text-amber-800 dark:text-amber-300",children:"Conflito de HorÃ¡rio"}),e.jsxs("div",{className:"mt-2 text-sm text-amber-700 dark:text-amber-200",children:[e.jsx("p",{className:"mb-2",children:"VocÃª jÃ¡ possui compromisso neste horÃ¡rio:"}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 bg-opacity-50 p-2 rounded border border-amber-200 dark:border-amber-700",children:[e.jsx("p",{className:"font-semibold",children:k.name}),e.jsx("p",{className:"text-xs",children:k.time})]})]})]})]})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-bold text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx("span",{className:"bg-primary h-6 w-1 rounded mr-2"}),"Selecione uma SessÃ£o"]}),e.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto pr-1",children:m==null?void 0:m.sessions.map(S=>{const M=c.getEnrollment(m.id,S.id),$=!!M,L=S.filled>=S.capacity,_=S.filled/S.capacity*100,U=S.date<new Date().toISOString().split("T")[0];return e.jsx("div",{className:`relative border rounded-lg p-4 transition-all duration-200 
                                ${$?"border-green-500 bg-green-50 dark:bg-green-900/20 ring-1 ring-green-500":L||U?"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 opacity-70":"border-gray-200 dark:border-gray-700 hover:border-primary hover:shadow-md bg-white dark:bg-darkcard"}`,children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-bold text-gray-900 dark:text-white text-lg",children:X(S.date)}),$&&e.jsx("span",{className:"bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200 text-[10px] font-bold px-2 py-0.5 rounded-full uppercase",children:"Inscrito"}),U&&!$&&e.jsx("span",{className:"bg-gray-200 dark:bg-gray-600 text-gray-600 dark:text-gray-300 text-[10px] font-bold px-2 py-0.5 rounded-full uppercase",children:"Encerrado"})]}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 flex items-center gap-4",children:e.jsxs("span",{className:"flex items-center",children:["ðŸ•’ ",S.startTime," - ",S.endTime]})}),e.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${L?"bg-red-500":_>80?"bg-amber-400":"bg-emerald-500"}`,style:{width:`${Math.min(_,100)}%`}})}),e.jsx("span",{className:`text-xs font-bold w-24 text-right ${L?"text-red-600 dark:text-red-400":"text-gray-500 dark:text-gray-400"}`,children:L?"ESGOTADO":m.isTeamEvent?`${S.capacity-S.filled} equipes`:`${S.capacity-S.filled} vagas`})]})]}),e.jsx("div",{className:"flex items-center",children:$?e.jsx("button",{onClick:()=>M&&g(M.id),className:"w-full sm:w-auto bg-white dark:bg-gray-800 border border-red-300 text-red-600 dark:text-red-400 font-bold py-2 px-4 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/30 transition-colors text-sm",children:"Cancelar"}):e.jsx(ie,{onClick:()=>m&&A(m,S.id),isLoading:N,disabled:L||U,className:`w-full sm:w-auto ${L||U?"bg-gray-300 dark:bg-gray-700 text-gray-500 dark:text-gray-400 cursor-not-allowed hover:bg-gray-300":""}`,children:U?"Encerrado":L?"Lotado":"Garantir Vaga"})})]})},S.id)})})]})]})}),e.jsx(qe,{isOpen:!!u,onClose:()=>g(null),onConfirm:()=>u&&j(u),title:"Cancelar InscriÃ§Ã£o",message:"Tem certeza que deseja cancelar sua inscriÃ§Ã£o? A vaga serÃ¡ liberada imediatamente.",confirmText:"Sim, Cancelar",isProcessing:N})]})},ws=()=>{const[o,t]=p.useState([]),[s,a]=p.useState([]),[r,n]=p.useState(!0);return p.useEffect(()=>{(async()=>{n(!0);const d=await R.getPublicEvents(),c=d.filter(m=>m.hasDedicatedPage).slice(0,3),l=d.filter(m=>!m.hasDedicatedPage).slice(0,8);t(c),a(l),n(!1)})()},[]),e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-darkbg flex flex-col font-sans transition-colors duration-300",children:[e.jsx("nav",{className:"bg-white/80 dark:bg-darkcard/80 backdrop-blur-md border-b border-gray-100 dark:border-gray-700 sticky top-0 z-50 transition-colors",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between h-20 items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-primary/10 dark:bg-primary/20 p-2 rounded-lg",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-primary dark:text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("span",{className:"text-gray-900 dark:text-white font-extrabold text-2xl tracking-tight",children:"EduEvent"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(q,{to:"/login",className:"text-gray-500 dark:text-gray-300 hover:text-primary dark:hover:text-indigo-400 font-medium px-3 py-2 transition-colors",children:"Acessar Painel"})})]})})}),e.jsxs("main",{className:"flex-1 max-w-7xl w-full mx-auto px-4 sm:px-6 lg:px-8 py-12 space-y-16",children:[o.length>0&&e.jsxs("section",{className:"animate-fade-in",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 dark:text-white",children:"Eventos em Destaque"}),e.jsx("p",{className:"mt-2 text-gray-500 dark:text-gray-400",children:"Confira as pÃ¡ginas exclusivas dos nossos principais eventos."})]}),e.jsx("div",{className:"grid gap-8 lg:grid-cols-2",children:o.map(i=>{var d,c,l,m,x;return e.jsxs(q,{to:`/special/${i.id}`,className:"group relative bg-white dark:bg-darkcard rounded-2xl shadow-md hover:shadow-2xl transition-all duration-300 overflow-hidden flex flex-col min-h-[300px] border border-gray-100 dark:border-gray-700",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 to-transparent dark:from-primary/20 opacity-50"}),((l=(c=(d=i.dedicatedPageConfig)==null?void 0:d.gallery)==null?void 0:c[0])==null?void 0:l.url)&&e.jsxs("div",{className:"h-48 w-full overflow-hidden relative",children:[e.jsx("img",{src:i.dedicatedPageConfig.gallery[0].url,alt:i.name,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"}),e.jsx("div",{className:"absolute inset-0 bg-black/20 group-hover:bg-black/10 transition-colors"})]}),e.jsxs("div",{className:"p-8 relative z-10 flex flex-col flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-bold bg-amber-100 text-amber-800 dark:bg-amber-900/30 dark:text-amber-300 uppercase tracking-wide",children:"â­ Especial"}),e.jsx("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:X((m=i.sessions[0])==null?void 0:m.date)})]}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2 group-hover:text-primary dark:group-hover:text-indigo-400 transition-colors",children:i.name}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 line-clamp-2 mb-6",children:((x=i.dedicatedPageConfig)==null?void 0:x.presentationText)||i.description}),e.jsxs("div",{className:"mt-auto flex items-center font-bold text-primary dark:text-indigo-400 group-hover:translate-x-1 transition-transform",children:["Ver PÃ¡gina Exclusiva ",e.jsx("span",{className:"ml-2",children:"â†’"})]})]})]},i.id)})})]}),e.jsxs("section",{children:[e.jsxs("div",{className:"mb-6 flex items-end justify-between border-b border-gray-200 dark:border-gray-700 pb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Agenda PÃºblica"}),e.jsx("p",{className:"mt-1 text-gray-500 dark:text-gray-400",children:"PrÃ³ximas atividades abertas Ã  comunidade."})]}),e.jsx(q,{to:"/login",className:"hidden sm:block text-primary dark:text-indigo-400 hover:text-indigo-600 font-medium text-sm",children:"Ver todos no painel â†’"})]}),r?e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(i=>e.jsx("div",{className:"bg-white dark:bg-darkcard h-40 rounded-xl animate-pulse"},i))}):s.length===0?e.jsx("div",{className:"text-center py-16 bg-white dark:bg-darkcard rounded-xl border border-dashed border-gray-300 dark:border-gray-700",children:e.jsx("p",{className:"text-gray-400",children:"Nenhum outro evento pÃºblico agendado no momento."})}):e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:s.map(i=>{var m,x;const d=(m=i.sessions[0])!=null&&m.date?new Date(i.sessions[0].date):new Date,c=d.getDate(),l=d.toLocaleString("pt-BR",{month:"short"}).toUpperCase();return e.jsxs("div",{className:"bg-white dark:bg-darkcard rounded-xl shadow-sm hover:shadow-md transition-shadow p-5 border border-gray-100 dark:border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 rounded-lg p-2 text-center min-w-[50px]",children:[e.jsx("span",{className:"block text-xs font-bold",children:l}),e.jsx("span",{className:"block text-lg font-extrabold leading-none",children:c})]}),e.jsx(q,{to:"/login",className:"bg-primary/10 text-primary hover:bg-primary hover:text-white dark:text-indigo-400 dark:hover:bg-indigo-600 dark:hover:text-white px-3 py-1 rounded-full text-xs font-bold transition-colors",children:"Inscrever"})]}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2 line-clamp-2",children:i.name}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm line-clamp-2 mb-4 flex-1",children:i.description}),e.jsxs("div",{className:"text-xs text-gray-400 dark:text-gray-500 flex items-center",children:[e.jsxs("span",{className:"mr-2",children:["ðŸ“ ",i.location]}),e.jsxs("span",{children:["ðŸ•’ ",(x=i.sessions[0])==null?void 0:x.startTime]})]})]},i.id)})})]})]}),e.jsx("footer",{className:"bg-white dark:bg-darkcard border-t border-gray-200 dark:border-gray-700 mt-auto",children:e.jsxs("div",{className:"max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8 flex flex-col md:flex-row justify-between items-center",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Â© 2024 EduEvent. Todos os direitos reservados."}),e.jsxs("div",{className:"flex space-x-6 mt-4 md:mt-0",children:[e.jsx("a",{href:"#",className:"text-gray-400 hover:text-gray-500",children:"Contato"}),e.jsx("a",{href:"#",className:"text-gray-400 hover:text-gray-500",children:"Privacidade"}),e.jsx(q,{to:"/login",className:"text-gray-400 hover:text-primary",children:"Ãrea do Aluno"})]})]})})]})},js=()=>{var y,v,E,w,A,j,N;const{id:o}=st(),[t,s]=p.useState(null),[a,r]=p.useState([]),[n,i]=p.useState(!0),[d,c]=p.useState("about");p.useEffect(()=>{(async()=>{if(o)try{const[I,T]=await Promise.all([R.getEventById(o),R.getEventsByParentId(o)]);s(I||null),r(T)}catch(I){console.error("Failed to load dedicated page data",I)}finally{i(!1)}})()},[o]);const l=p.useMemo(()=>{var $,L;if(!t)return[];const k=(($=t.dedicatedPageConfig)==null?void 0:$.schedule)||[],I=[];a.forEach(_=>{_.sessions.forEach(U=>{I.push({id:`sub_${_.id}_${U.id}`,time:U.startTime,title:_.name,description:`${_.description||""} â€¢ Local: ${_.location||"NÃ£o informado"}`,dateLabel:Xe(U.date)})})});const T=(L=t.sessions[0])!=null&&L.date?Xe(t.sessions[0].date):"";return[...k.map(_=>({..._,dateLabel:_.id.startsWith("sub_")?void 0:T})),...I].sort((_,U)=>_.dateLabel!==U.dateLabel?(_.dateLabel||"").localeCompare(U.dateLabel||""):_.time.localeCompare(U.time))},[t,a]),m=p.useMemo(()=>{const k={};return l.forEach(I=>{const T=I.dateLabel||"Data a definir";k[T]||(k[T]=[]),k[T].push(I)}),k},[l]);if(n)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-darkbg text-gray-500",children:"Carregando evento..."});if(!t||!t.hasDedicatedPage)return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-50 dark:bg-darkbg px-4 text-center",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-800 dark:text-white mb-4",children:"PÃ¡gina nÃ£o encontrada"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"Este evento nÃ£o possui uma pÃ¡gina dedicada ou nÃ£o existe."}),e.jsx(q,{to:"/",className:"text-primary hover:underline",children:"Voltar para Home"})]});const x=t.dedicatedPageConfig||{gallery:[]},u=x.themeColor||"#4F46E5",g={"--theme-color":u};return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-darkbg text-gray-900 dark:text-gray-100 font-sans selection:bg-opacity-30 selection:bg-[var(--theme-color)]",style:g,children:[e.jsxs("header",{className:"relative bg-darkbg text-white overflow-hidden min-h-[55vh] flex flex-col justify-end pb-12",children:[((v=(y=x.gallery)==null?void 0:y[0])==null?void 0:v.url)&&e.jsxs("div",{className:"absolute inset-0 z-0",children:[e.jsx("img",{src:x.gallery[0].url,alt:"Background",className:"w-full h-full object-cover opacity-40 blur-sm scale-105 transform origin-center animate-fade-in"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-darkbg via-darkbg/60 to-transparent"})]}),e.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-6 w-full animate-slide-in",children:[e.jsxs(q,{to:"/",className:"inline-flex items-center mb-8 text-white/70 hover:text-white transition-colors text-sm font-medium group",children:[e.jsx("span",{className:"mr-2 group-hover:-translate-x-1 transition-transform",children:"â†"})," Voltar para Eventos"]}),e.jsx("div",{className:"flex flex-col lg:flex-row lg:items-end lg:justify-between gap-6",children:e.jsxs("div",{className:"max-w-4xl",children:[e.jsx("span",{className:"inline-block py-1 px-3 rounded text-[10px] font-bold tracking-widest mb-4 uppercase text-white bg-[var(--theme-color)] shadow-lg shadow-[var(--theme-color)]/20",children:"Evento em Destaque"}),e.jsx("h1",{className:"text-4xl md:text-6xl lg:text-7xl font-extrabold tracking-tight mb-4 leading-tight text-white drop-shadow-sm",children:t.name}),e.jsx("p",{className:"text-lg md:text-xl text-white/80 font-light max-w-2xl leading-relaxed",children:t.description})]})})]})]}),e.jsx("div",{className:"sticky top-0 z-40 bg-white/90 dark:bg-darkcard/90 backdrop-blur-md shadow-sm border-b border-gray-200 dark:border-gray-700",children:e.jsx("div",{className:"max-w-7xl mx-auto px-6",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsx("nav",{className:"flex space-x-1 h-full overflow-x-auto no-scrollbar",children:["about","schedule","gallery"].map(k=>e.jsxs("button",{onClick:()=>c(k),className:`relative px-5 inline-flex items-center h-full text-xs font-bold uppercase tracking-widest transition-all whitespace-nowrap
                                        ${d===k?"text-[var(--theme-color)]":"text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200"}`,children:[k==="about"&&"VisÃ£o Geral",k==="schedule"&&"Cronograma",k==="gallery"&&"Galeria",d===k&&e.jsx("span",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-[var(--theme-color)] shadow-[0_0_10px_var(--theme-color)]"})]},k))}),e.jsx("div",{className:"hidden md:flex items-center pl-6 border-l border-gray-200 dark:border-gray-700",children:e.jsx(q,{to:"/login",className:"inline-flex items-center justify-center px-6 py-2 rounded-full font-bold text-white text-sm shadow-lg transform transition hover:-translate-y-0.5 active:translate-y-0 hover:shadow-xl",style:{backgroundColor:u},children:"Garantir Vaga"})})]})})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-6 py-12 animate-fade-in min-h-[40vh]",children:[d==="about"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-12",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-12",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-3xl font-bold mb-6 text-gray-900 dark:text-white",children:"Sobre o Evento"}),e.jsx("div",{className:"prose dark:prose-invert prose-lg max-w-none text-gray-600 dark:text-gray-300 leading-relaxed",children:e.jsx("p",{className:"whitespace-pre-line",children:x.presentationText||"Junte-se a nÃ³s para uma experiÃªncia inesquecÃ­vel. Este evento foi cuidadosamente planejado para oferecer o melhor conteÃºdo e oportunidades de networking."})})]}),a.length>0&&e.jsxs("section",{className:"pt-8 border-t border-gray-100 dark:border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Destaques da ProgramaÃ§Ã£o"}),e.jsx("button",{onClick:()=>c("schedule"),className:"text-sm font-bold text-[var(--theme-color)] hover:underline hidden sm:block",children:"Ver tudo â†’"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:a.map(k=>e.jsxs("div",{className:"group relative bg-white dark:bg-darkcard rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-gray-700 hover:shadow-xl hover:border-transparent transition-all duration-300 flex flex-col justify-between overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-[var(--theme-color)] to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("span",{className:"inline-block px-2 py-1 rounded bg-gray-50 dark:bg-gray-800 text-[10px] font-bold uppercase tracking-wider text-gray-500 dark:text-gray-400",children:"Atividade"}),e.jsx("span",{className:"text-[var(--theme-color)] opacity-0 group-hover:opacity-100 transform translate-x-2 group-hover:translate-x-0 transition-all duration-300",children:"â†—"})]}),e.jsx("h4",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2 leading-tight group-hover:text-[var(--theme-color)] transition-colors",children:k.name}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 line-clamp-3 mb-4 leading-relaxed",children:k.description})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-50 dark:border-gray-800 flex items-center justify-between text-xs font-medium text-gray-400 dark:text-gray-500",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),k.sessions.length>0?k.sessions[0].startTime:"TBA"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("svg",{className:"w-4 h-4 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),k.location]})]})]},k.id))})]})]}),e.jsx("div",{className:"lg:col-span-4 space-y-8",children:e.jsxs("div",{className:"bg-white dark:bg-darkcard rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 p-8 sticky top-24",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-6 pb-4 border-b border-gray-100 dark:border-gray-700",children:"InformaÃ§Ãµes do Evento"}),e.jsxs("ul",{className:"space-y-6",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-gray-50 dark:bg-gray-800 flex items-center justify-center text-xl mr-4",children:"ðŸ“…"}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs font-bold uppercase text-gray-400 mb-0.5",children:"Data Principal"}),e.jsx("span",{className:"block text-gray-900 dark:text-white font-medium",children:X((E=t.sessions[0])==null?void 0:E.date)})]})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-gray-50 dark:bg-gray-800 flex items-center justify-center text-xl mr-4",children:"ðŸ•’"}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs font-bold uppercase text-gray-400 mb-0.5",children:"HorÃ¡rio"}),e.jsxs("span",{className:"block text-gray-900 dark:text-white font-medium",children:[(w=t.sessions[0])==null?void 0:w.startTime," Ã s ",(A=t.sessions[0])==null?void 0:A.endTime]})]})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-gray-50 dark:bg-gray-800 flex items-center justify-center text-xl mr-4",children:"ðŸ“"}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs font-bold uppercase text-gray-400 mb-0.5",children:"LocalizaÃ§Ã£o"}),e.jsx("span",{className:"block text-gray-900 dark:text-white font-medium",children:t.location})]})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-gray-50 dark:bg-gray-800 flex items-center justify-center text-xl mr-4",children:"ðŸ‘¥"}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs font-bold uppercase text-gray-400 mb-0.5",children:"Capacidade"}),e.jsxs("span",{className:"block text-gray-900 dark:text-white font-medium",children:[t.sessions.reduce((k,I)=>k+I.capacity,0)," vagas totais"]})]})]})]}),e.jsx("div",{className:"mt-8 pt-6 border-t border-gray-100 dark:border-gray-700",children:e.jsx(q,{to:"/login",className:"w-full flex items-center justify-center px-4 py-3 rounded-xl font-bold text-white shadow-lg transition transform hover:scale-[1.02]",style:{backgroundColor:u},children:"Inscrever-se"})})]})})]}),d==="schedule"&&e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Cronograma Completo"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"Acompanhe todos os horÃ¡rios e atividades."})]}),Object.keys(m).length===0?e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-12 rounded-2xl text-center border-2 border-dashed border-gray-200 dark:border-gray-700",children:e.jsx("p",{className:"text-gray-500",children:"ProgramaÃ§Ã£o detalhada em breve."})}):e.jsx("div",{className:"space-y-16",children:Object.entries(m).map(([k,I])=>{const T=I;return e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"sticky top-20 z-20 bg-gray-50/95 dark:bg-darkbg/95 backdrop-blur-sm py-4 mb-8 border-b border-gray-200 dark:border-gray-700 flex items-center",children:[e.jsxs("span",{className:"px-3 py-1 rounded bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 text-sm font-bold shadow-sm mr-3",children:[k.split(",")[0]," "]}),e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:[k.split(",")[1]," "]})]}),e.jsx("div",{className:"relative border-l-2 border-gray-200 dark:border-gray-800 ml-4 md:ml-6 space-y-12 pb-4",children:T.map((S,M)=>e.jsxs("div",{className:"relative pl-8 md:pl-12 group",children:[e.jsx("div",{className:"absolute -left-[9px] top-1.5 h-[18px] w-[18px] rounded-full border-4 border-white dark:border-darkbg shadow-sm transition-transform group-hover:scale-125",style:{backgroundColor:u}}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-baseline gap-2 md:gap-8 mb-2",children:[e.jsx("div",{className:"flex-shrink-0 w-20 pt-1",children:e.jsx("span",{className:"text-lg font-black text-gray-900 dark:text-white",children:S.time})}),e.jsxs("div",{className:"flex-1 bg-white dark:bg-darkcard p-5 rounded-xl border border-gray-100 dark:border-gray-800 shadow-sm group-hover:shadow-md transition-shadow",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-1 group-hover:text-[var(--theme-color)] transition-colors",children:S.title}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 leading-relaxed text-sm whitespace-pre-line",children:S.description})]})]})]},M))})]},k)})})]}),d==="gallery"&&e.jsxs("div",{children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Galeria de Fotos"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"Momentos marcantes."})]}),((j=x.gallery)==null?void 0:j.length)===0?e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-12 rounded-2xl text-center border-2 border-dashed border-gray-200 dark:border-gray-700",children:e.jsx("p",{className:"text-gray-500",children:"Imagens indisponÃ­veis no momento."})}):e.jsx("div",{className:"columns-1 md:columns-2 lg:columns-3 gap-6 space-y-6",children:(N=x.gallery)==null?void 0:N.map((k,I)=>e.jsxs("div",{className:"break-inside-avoid group relative rounded-2xl overflow-hidden shadow-md cursor-zoom-in",children:[e.jsx("img",{src:k.url,alt:k.caption||`Imagem ${I+1}`,className:"w-full h-auto object-cover transition-transform duration-700 group-hover:scale-105"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-6",children:k.caption&&e.jsx("p",{className:"text-white font-medium transform translate-y-4 group-hover:translate-y-0 transition-transform duration-300",children:k.caption})})]},I))})]})]}),e.jsx("div",{className:"md:hidden fixed bottom-6 right-6 z-50 animate-bounce-slow",children:e.jsx(q,{to:"/login",className:"flex items-center justify-center w-14 h-14 rounded-full text-white shadow-xl shadow-indigo-900/20 hover:scale-110 transition-transform",style:{backgroundColor:u},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})})]})},Ns=(o,t)=>{const{addToast:s}=ve(),[a,r]=p.useState([]),[n,i]=p.useState(null),[d,c]=p.useState(!1),[l,m]=p.useState({}),[x,u]=p.useState({}),g=p.useRef(new Set),y=p.useCallback(async j=>{if(o){c(!0);try{const[N,k]=await Promise.all([R.getTeamsForEvent(j),R.getEnrollmentsForUser(o.uid)]);r(N),t&&t();const T=[...new Set(N.map(M=>M.captainId))].filter(M=>!g.current.has(M));if(T.length>0){const M={};await Promise.all(T.map(async $=>{try{const L=await R.getUserProfile($);L&&(M[$]=L,g.current.add($))}catch{console.error("Error fetching captain",$)}})),Object.keys(M).length>0&&m($=>({...$,...M}))}const S=k.find(M=>M.eventId===j&&M.status===J.CONFIRMED);if(S&&S.teamId){const M=N.find($=>$.id===S.teamId);i(M||null)}else i(null)}catch(N){console.error(N)}finally{c(!1)}}},[o,t]);return p.useEffect(()=>{(async()=>{if(n&&n.members.length>0){const N={},k=n.members.filter(I=>!g.current.has(I));await Promise.all(k.map(async I=>{if(o&&o.uid===I){N[I]=o,g.current.add(I);return}try{const T=await R.getUserProfile(I);T&&(N[I]=T,g.current.add(I))}catch{console.error("Error fetching member",I)}})),Object.keys(N).length>0&&u(I=>({...I,...N}))}})()},[n,o]),{teams:a,myTeam:n,loading:d,captainProfiles:l,memberProfiles:x,loadTeams:y,createTeam:async(j,N)=>{if(!o)return null;c(!0);try{const k=await R.createTeam(j,N,o);return await y(j),k}catch(k){throw k}finally{c(!1)}},joinTeam:async j=>{if(o){c(!0);try{await R.joinTeam(j.id,o,j.code),await y(j.eventId)}catch(N){throw N}finally{c(!1)}}},leaveTeam:async()=>{if(!(!o||!n)){c(!0);try{const j=n.eventId;await R.leaveTeam(n.id,o.uid),await y(j)}catch(j){throw j}finally{c(!1)}}},kickMember:async j=>{if(n){c(!0);try{await R.kickMember(n.id,j),await y(n.eventId)}catch(N){throw N}finally{c(!1)}}}}},ks=(o,t)=>{switch(t.type){case"CLOSE":return{type:"NONE"};case"OPEN_ENROLL":return{type:"ENROLL",data:t.payload};case"OPEN_TEAM_SUCCESS":return{type:"TEAM_SUCCESS",data:t.payload};case"OPEN_TEAM_INPUT":return{type:"TEAM_INPUT",data:t.payload};case"OPEN_TEAM_CONFIRM":return{type:"TEAM_CONFIRM",data:t.payload};default:return o}},Es=()=>{var Ge,He,Je;const{id:o}=st(),[t,s]=kt(),a=t.get("join_code"),{user:r}=re(),n=Ne(),{addToast:i}=ve(),[d,c]=p.useState(null),[l,m]=p.useState([]),[x,u]=p.useState([]),[g,y]=p.useState([]),[v,E]=p.useState(!0),[w,A]=p.useState(null),[j,N]=p.useReducer(ks,{type:"NONE"}),[k,I]=p.useState(""),[T,S]=p.useState("join"),M=p.useCallback(async(b=!0)=>{if(!(!o||!r)){b&&E(!0);try{const[C,O,G,ee]=await Promise.all([R.getEventById(o),R.getEventsByParentId(o),R.getEnrollmentsForUser(r.uid),R.getClasses()]);if(!C){n("/dashboard");return}c(C),m(O),u(G),y(ee)}catch(C){console.error(C)}finally{b&&E(!1)}}},[o,r,n]),$=p.useCallback(()=>{M(!1),A(null)},[M]),{handleEnroll:L,handleCancel:_,isProcessing:U,conflictData:ae,clearState:Te}=ct(r,$),{teams:be,myTeam:Y,loading:Ae,captainProfiles:xe,memberProfiles:ze,loadTeams:Me,createTeam:ut,joinTeam:gt,leaveTeam:ht,kickMember:ft}=Ns(r,$);p.useEffect(()=>{M()},[M]),p.useEffect(()=>{if(j.type==="ENROLL"&&j.data){const C=[d,...l].filter(Boolean).find(O=>O.id===j.data.id);C&&JSON.stringify(C)!==JSON.stringify(j.data)&&N({type:"OPEN_ENROLL",payload:C})}},[d,l,j.type,j.data]),p.useEffect(()=>{if(a&&d&&!v){let b;d.isTeamEvent?b=d:b=l.find(C=>C.isTeamEvent),b&&j.type==="NONE"&&(N({type:"OPEN_ENROLL",payload:b}),S("join"),Me(b.id))}},[a,d,l,v,Me,j.type]),p.useEffect(()=>{if(a&&be.length>0&&j.type==="ENROLL"){const b=be.find(C=>C.code===a);b&&(x.some(O=>O.eventId===b.eventId&&O.teamId===b.id)||(N({type:"OPEN_TEAM_CONFIRM",payload:b}),s(O=>{const G=new URLSearchParams(O);return G.delete("join_code"),G},{replace:!0})))}},[a,be,j.type,x,s]);const Le=b=>{var C;return b?((C=g.find(O=>O.id===b))==null?void 0:C.name)||"Desconhecida":"N/A"},ye=async b=>{try{await navigator.clipboard.writeText(b),i("success","CÃ³digo copiado!")}catch{i("error","Erro ao copiar.")}},Be=async b=>{const C=`${window.location.origin}/#/event/${o}?join_code=${b.code}`;if(navigator.share)try{await navigator.share({title:`Junte-se Ã  minha equipe: ${b.name}`,text:`Use o cÃ³digo ${b.code} ou clique no link para entrar:`,url:C})}catch{await ye(C),i("success","Link copiado!")}else await ye(C),i("success","Link copiado!")},pt=async b=>{const C=j.type==="ENROLL"?j.data:null;if(C)try{const O=await ut(C.id,b);O&&(N({type:"OPEN_TEAM_SUCCESS",payload:O}),i("success","Equipe criada com sucesso!"))}catch(O){i("error",O.message)}},vt=async()=>{const b=j.type==="TEAM_CONFIRM"?j.data:null;if(b)try{await gt(b),i("success","VocÃª entrou na equipe!"),N({type:"CLOSE"})}catch(C){i("error",C.message)}},bt=async()=>{try{await ht(),i("success","VocÃª saiu da equipe.")}catch(b){i("error",b.message)}},yt=async b=>{try{await ft(b),i("success","Membro removido.")}catch(C){i("error",C.message)}},wt=b=>{I(""),N({type:"OPEN_TEAM_INPUT",payload:b})},jt=()=>{const b=j.type==="TEAM_INPUT"?j.data:null;if(b){if(k.toUpperCase()!==b.code){i("error","CÃ³digo incorreto.");return}N({type:"OPEN_TEAM_CONFIRM",payload:b})}},Ve=b=>{Te(),N({type:"OPEN_ENROLL",payload:b}),b.isTeamEvent&&(S("join"),Me(b.id))},We=(b,C)=>x.find(O=>O.eventId===b&&O.sessionId===C),de=()=>N({type:"CLOSE"});if(v)return e.jsx("div",{className:"p-12 text-center text-gray-500 dark:text-gray-400 font-medium",children:"Carregando detalhes do evento..."});if(!d)return e.jsx("div",{className:"p-12 text-center text-red-500 dark:text-red-400 font-bold",children:"Evento nÃ£o encontrado."});const Q=j.type==="ENROLL"?j.data:null,we=j.type==="TEAM_SUCCESS"?j.data:null,De=j.type==="TEAM_INPUT"?j.data:null,ue=j.type==="TEAM_CONFIRM"?j.data:null;return e.jsxs("div",{className:"space-y-8 pb-12",children:[e.jsx("nav",{className:"flex","aria-label":"Breadcrumb",children:e.jsxs("ol",{className:"flex items-center space-x-2",children:[e.jsx("li",{children:e.jsx(q,{to:"/dashboard",className:"text-gray-500 dark:text-gray-400 hover:text-primary dark:hover:text-indigo-400 font-medium transition",children:"Eventos"})}),e.jsx("li",{children:e.jsx("span",{className:"text-gray-300 dark:text-gray-600",children:"/"})}),e.jsx("li",{className:"text-gray-900 dark:text-white font-semibold","aria-current":"page",children:d.name})]})}),e.jsxs("div",{className:"bg-white dark:bg-darkcard rounded-2xl shadow-md overflow-hidden border border-gray-100 dark:border-gray-700 relative",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-primary to-indigo-400"}),e.jsx("div",{className:"p-8 md:p-10",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-start gap-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("div",{className:"inline-block px-3 py-1 rounded-full bg-indigo-50 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 text-xs font-bold uppercase tracking-wide border border-indigo-100 dark:border-indigo-900/50",children:"Evento Principal"}),d.isTeamEvent&&e.jsx("div",{className:"inline-block px-3 py-1 rounded-full bg-purple-50 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 text-xs font-bold uppercase tracking-wide border border-purple-100 dark:border-purple-900/50",children:"ðŸ† Evento por Equipe"})]}),e.jsx("h1",{className:"text-3xl md:text-4xl font-extrabold text-gray-900 dark:text-white mb-4 leading-tight",children:d.name}),e.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 leading-relaxed mb-6 max-w-4xl",children:d.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-6 text-gray-500 dark:text-gray-400 text-sm font-medium",children:[e.jsxs("div",{className:"flex items-center bg-gray-50 dark:bg-gray-800 px-3 py-1.5 rounded-lg",children:[e.jsx("span",{className:"mr-2 text-xl",children:"ðŸ“"})," ",d.location]}),e.jsxs("div",{className:"flex items-center bg-gray-50 dark:bg-gray-800 px-3 py-1.5 rounded-lg",children:[e.jsx("span",{className:"mr-2 text-xl",children:"ðŸ“…"})," ",d.sessions.length," SessÃµes Principais"]})]})]}),d.sessions.length>0&&e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("button",{onClick:()=>Ve(d),className:"w-full md:w-auto bg-primary hover:bg-indigo-700 text-white px-6 py-3 rounded-xl font-bold shadow-lg shadow-indigo-200 dark:shadow-none transition transform hover:-translate-y-1 flex items-center justify-center",children:["Ver ProgramaÃ§Ã£o",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7 7"})})]})})]})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Atividades & Sub-eventos"}),e.jsx("div",{className:"h-px bg-gray-200 dark:bg-gray-700 flex-1"})]}),l.length===0?e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 border-2 border-dashed border-gray-200 dark:border-gray-700 rounded-xl p-12 text-center",children:[e.jsx("div",{className:"text-4xl mb-3 opacity-30",children:"ðŸ“‚"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"Nenhuma atividade especÃ­fica cadastrada para este evento ainda."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:l.map(b=>{const C=b.sessions.length===1?b.sessions[0]:null,O=C?C.capacity:0,G=C?C.filled:0,ee=O>0?G/O*100:0,Re=O>0&&G>=O,Qe=b.sessions.some(Nt=>We(b.id,Nt.id));return e.jsxs("div",{className:"group bg-white dark:bg-darkcard rounded-xl shadow-sm hover:shadow-xl transition-all duration-300 overflow-hidden border border-gray-100 dark:border-gray-700 flex flex-col relative",children:[e.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-gray-200 dark:bg-gray-700 group-hover:bg-primary transition-colors"}),e.jsxs("div",{className:"p-6 flex-1 flex flex-col ml-1",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white group-hover:text-primary dark:group-hover:text-indigo-400 transition-colors",children:b.name}),b.isTeamEvent&&e.jsx("span",{className:"text-[10px] bg-purple-100 text-purple-800 px-2 py-0.5 rounded-full font-bold",children:"EQUIPE"})]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm line-clamp-3 mb-4 flex-1",children:b.description}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-300 mt-auto pt-4 border-t border-gray-50 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"w-6 text-center mr-2 text-gray-400 dark:text-gray-500",children:"ðŸ“"}),e.jsx("span",{className:"font-medium",children:b.location})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"w-6 text-center mr-2 text-gray-400 dark:text-gray-500",children:"ðŸ“…"}),e.jsx("span",{className:"font-medium",children:b.sessions.length>1?`${b.sessions.length} opÃ§Ãµes de horÃ¡rio`:`${X(C==null?void 0:C.date)} â€¢ ${C==null?void 0:C.startTime}`})]})]}),C&&e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"flex justify-between text-xs mb-1 font-bold",children:e.jsx("span",{className:Re?"text-red-600 dark:text-red-400":"text-gray-500 dark:text-gray-400",children:Re?"LOTADO":b.isTeamEvent?`${O-G} equipes restantes`:`${O-G} vagas`})}),e.jsx("div",{className:"w-full bg-gray-100 dark:bg-gray-700 rounded-full h-1.5",children:e.jsx("div",{className:`h-full rounded-full ${Re?"bg-red-500":"bg-emerald-500"}`,style:{width:`${ee}%`}})})]})]}),e.jsx("button",{onClick:()=>Ve(b),className:`w-full py-3 font-bold text-sm transition-colors border-t border-gray-100 dark:border-gray-700 ${Qe?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400 hover:bg-green-100 dark:hover:bg-green-900/40":"bg-gray-50 dark:bg-gray-800/50 hover:bg-primary hover:text-white dark:hover:bg-indigo-600 dark:hover:text-white text-primary dark:text-indigo-300"}`,children:Qe?"Gerenciar InscriÃ§Ã£o":"Inscrever-se Agora"})]},b.id)})}),e.jsx(me,{isOpen:j.type==="ENROLL",onClose:de,title:Q?Q.name:"",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:e.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed",children:Q==null?void 0:Q.description})}),ae&&e.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/30 border-l-4 border-amber-400 p-4 rounded-r-md",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-amber-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-bold text-amber-800 dark:text-amber-300",children:"Conflito de HorÃ¡rio"}),e.jsxs("div",{className:"mt-2 text-sm text-amber-700 dark:text-amber-200",children:[e.jsx("p",{className:"mb-2",children:"VocÃª jÃ¡ possui compromisso neste horÃ¡rio:"}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 bg-opacity-50 p-2 rounded border border-amber-200 dark:border-amber-700",children:[e.jsx("p",{className:"font-semibold",children:ae.name}),e.jsx("p",{className:"text-xs",children:ae.time})]})]})]})]})}),Q!=null&&Q.isTeamEvent?e.jsx("div",{className:"animate-fade-in",children:Y?e.jsxs("div",{className:"bg-white dark:bg-darkcard border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 p-6 text-white relative",children:[e.jsx("div",{className:"absolute top-4 right-4 bg-white/20 backdrop-blur rounded-full px-3 py-1 text-xs font-bold uppercase tracking-wider",children:"Minha Equipe"}),e.jsx("h3",{className:"text-2xl md:text-3xl font-extrabold mb-1 pr-24 md:pr-0",children:Y.name}),e.jsx("div",{className:"flex items-center gap-2 opacity-90 text-sm",children:e.jsxs("span",{children:["CapitÃ£o: ",Y.captainId===(r==null?void 0:r.uid)?"VocÃª":((Ge=xe[Y.captainId])==null?void 0:Ge.name)||"Desconhecido"]})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1",children:"CÃ³digo de Acesso"}),e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 dark:bg-gray-800 px-3 py-1 rounded border border-gray-200 dark:border-gray-700",children:[e.jsx("code",{className:"text-2xl font-mono font-bold text-primary dark:text-indigo-400 tracking-wide select-all",children:Y.code}),e.jsx("button",{onClick:()=>ye(Y.code),className:"p-1.5 text-gray-500 hover:text-indigo-600 dark:text-gray-400 dark:hover:text-indigo-300 transition-colors",title:"Copiar cÃ³digo",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),e.jsx("div",{className:"h-6 w-px bg-gray-300 dark:bg-gray-600 mx-1"}),e.jsx("button",{onClick:()=>Be(Y),className:"p-1.5 text-gray-500 hover:text-indigo-600 dark:text-gray-400 dark:hover:text-indigo-300 transition-colors",title:"Compartilhar Link",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})})})]})]}),e.jsxs("div",{className:"w-full md:w-auto text-left md:text-right",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1",children:"Membros"}),e.jsx("span",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:Y.members.length})]})]}),e.jsxs("div",{className:"border-t border-gray-100 dark:border-gray-700 pt-4",children:[e.jsx("h4",{className:"font-bold text-gray-900 dark:text-white mb-3 text-sm",children:"Integrantes"}),e.jsx("ul",{className:"space-y-2 mb-6",children:Y.members.map(b=>{var C,O,G,ee;return e.jsxs("li",{className:"flex justify-between items-center text-sm p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center text-primary dark:text-indigo-300 font-bold text-xs",children:(((C=ze[b])==null?void 0:C.name)||((O=xe[b])==null?void 0:O.name)||"U").charAt(0)}),e.jsxs("span",{className:`text-gray-700 dark:text-gray-300 ${b===(r==null?void 0:r.uid)?"font-bold":""}`,children:[b===(r==null?void 0:r.uid)?"VocÃª":((G=ze[b])==null?void 0:G.name)||((ee=xe[b])==null?void 0:ee.name)||"UsuÃ¡rio...",b===Y.captainId&&" ðŸ‘‘"]})]}),Y.captainId===(r==null?void 0:r.uid)&&b!==(r==null?void 0:r.uid)&&e.jsx("button",{onClick:()=>yt(b),className:"text-red-500 hover:text-red-700 text-xs font-bold px-2 py-1 rounded hover:bg-red-50 dark:hover:bg-red-900/20",children:"Remover"})]},b)})}),e.jsx(ie,{onClick:bt,isLoading:Ae,variant:"danger",className:"w-full",children:Y.captainId===(r==null?void 0:r.uid)?"Desfazer Equipe e Sair":"Sair da Equipe"})]})]})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex p-1 bg-gray-100 dark:bg-gray-800 rounded-lg mb-6",children:[e.jsx("button",{onClick:()=>S("join"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-all ${T==="join"?"bg-white dark:bg-darkcard text-primary shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,children:"Entrar em Equipe"}),e.jsx("button",{onClick:()=>S("create"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-all ${T==="create"?"bg-white dark:bg-darkcard text-primary shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,children:"Criar Nova Equipe"})]}),T==="join"&&e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 gap-3 max-h-[300px] overflow-y-auto pr-1",children:be.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[e.jsx("span",{className:"text-2xl block mb-2",children:"ðŸ›¡ï¸"}),e.jsxs("p",{children:["Nenhuma equipe criada ainda.",e.jsx("br",{}),"Seja o primeiro a criar!"]})]}):be.map(b=>{var C;return e.jsxs("div",{className:"group bg-white dark:bg-darkcard border border-gray-200 dark:border-gray-700 rounded-xl p-4 flex flex-col sm:flex-row justify-between items-start sm:items-center hover:shadow-md hover:border-primary/30 transition-all cursor-default gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 flex items-center justify-center text-lg flex-shrink-0",children:"ðŸ›¡ï¸"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("span",{className:"font-bold text-gray-900 dark:text-white block truncate",children:b.name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400 mt-0.5 flex-wrap",children:[e.jsxs("span",{children:["CapitÃ£o: ",((C=xe[b.captainId])==null?void 0:C.name)||"..."]}),e.jsx("span",{className:"w-1 h-1 bg-gray-300 rounded-full hidden sm:block"}),e.jsxs("span",{className:"flex items-center text-primary dark:text-indigo-400 font-bold bg-primary/10 dark:bg-indigo-900/30 px-1.5 py-0.5 rounded",children:[b.members.length," membros"]})]})]})]}),e.jsx("button",{onClick:()=>wt(b),className:"w-full sm:w-auto px-4 py-2 bg-gray-50 dark:bg-gray-800 text-primary dark:text-indigo-400 font-bold text-sm rounded-lg hover:bg-primary hover:text-white dark:hover:bg-indigo-600 dark:hover:text-white transition-colors",children:"Entrar"})]},b.id)})})}),T==="create"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"Escolha um horÃ¡rio disponÃ­vel para registrar sua equipe:"}),e.jsx("div",{className:"space-y-3 max-h-[300px] overflow-y-auto pr-1",children:Q.sessions.map(b=>{const C=b.filled>=b.capacity;return e.jsxs("div",{className:`p-4 border rounded-xl flex flex-col sm:flex-row justify-between items-start sm:items-center transition-all ${C?"bg-gray-50 border-gray-200 opacity-60":"bg-white dark:bg-darkcard border-gray-200 dark:border-gray-700 hover:border-primary/50 hover:shadow-sm"}`,children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx("span",{children:X(b.date)}),e.jsx("span",{className:"text-xs font-normal text-gray-400",children:"|"}),e.jsxs("span",{children:[b.startTime," - ",b.endTime]})]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:C?"Esgotado":`${b.capacity-b.filled} slots disponÃ­veis`})]}),e.jsx(ie,{onClick:()=>pt(b.id),isLoading:Ae,disabled:C,className:`w-full sm:w-auto mt-3 sm:mt-0 ${C?"bg-gray-300 text-gray-500":"bg-primary"}`,variant:C?"outline":"primary",children:C?"Lotado":"Criar Aqui"})]},b.id)})})]})]})}):e.jsxs("div",{children:[e.jsxs("h4",{className:"font-bold text-gray-900 dark:text-white mb-3 flex items-center",children:[e.jsx("span",{className:"bg-primary h-6 w-1 rounded mr-2"}),"Selecione uma SessÃ£o"]}),e.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto pr-1",children:Q==null?void 0:Q.sessions.map(b=>{const C=We(Q.id,b.id),O=!!C,G=b.filled>=b.capacity,ee=b.filled/b.capacity*100;return e.jsx("div",{className:`relative border rounded-lg p-4 transition-all ${O?"border-green-500 bg-green-50 dark:bg-green-900/20 ring-1 ring-green-500":G?"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 opacity-90":"border-gray-200 dark:border-gray-700 hover:border-primary hover:shadow-md bg-white dark:bg-darkcard"}`,children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-bold text-gray-900 dark:text-white text-lg",children:X(b.date)}),O&&e.jsx("span",{className:"bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200 text-[10px] font-bold px-2 py-0.5 rounded-full uppercase",children:"Inscrito"})]}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 flex items-center gap-4",children:e.jsxs("span",{className:"flex items-center",children:["ðŸ•’ ",b.startTime," - ",b.endTime]})}),e.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${G?"bg-red-500":ee>80?"bg-amber-500":"bg-emerald-500"}`,style:{width:`${Math.min(ee,100)}%`}})}),e.jsx("span",{className:`text-xs font-bold w-24 text-right ${G?"text-red-600 dark:text-red-400":"text-gray-500 dark:text-gray-400"}`,children:G?"ESGOTADO":Q.isTeamEvent?`${b.capacity-b.filled} equipes`:`${b.capacity-b.filled} vagas`})]})]}),e.jsx("div",{className:"flex items-center",children:O?e.jsx("button",{onClick:()=>C&&A(C.id),className:"w-full sm:w-auto bg-white dark:bg-gray-800 border border-red-300 dark:border-red-900 text-red-600 dark:text-red-400 font-bold py-2 px-4 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/30 transition-colors text-sm",children:"Cancelar"}):e.jsx(ie,{onClick:()=>Q&&L(Q,b.id),isLoading:U,disabled:G,className:`w-full sm:w-auto ${G?"bg-gray-300 dark:bg-gray-700 text-gray-500 dark:text-gray-400 cursor-not-allowed":""}`,children:G?"Lotado":"Inscrever"})})]})},b.id)})})]})]})}),e.jsx(me,{isOpen:j.type==="TEAM_SUCCESS",onClose:de,title:"Dados da Equipe Criada",children:we&&r&&e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border border-green-200 dark:border-green-900/50 text-center",children:[e.jsx("span",{className:"text-2xl mb-2 block",children:"ðŸŽ‰"}),e.jsx("h3",{className:"text-lg font-bold text-green-800 dark:text-green-300",children:"Equipe criada com sucesso!"}),e.jsx("p",{className:"text-sm text-green-700 dark:text-green-400",children:"Compartilhe o cÃ³digo abaixo com seus colegas."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase",children:"Nome da Equipe"}),e.jsx("div",{className:"p-3 bg-gray-100 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600 text-gray-900 dark:text-white font-medium",children:we.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase",children:"CapitÃ£o (VocÃª)"}),e.jsx("div",{className:"p-3 bg-gray-100 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600 text-gray-900 dark:text-white font-medium",children:r.name})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase",children:"RM"}),e.jsx("div",{className:"p-3 bg-gray-100 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600 text-gray-900 dark:text-white",children:r.rm||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase",children:"Turma"}),e.jsx("div",{className:"p-3 bg-gray-100 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600 text-gray-900 dark:text-white",children:Le(r.classId)})]})]}),e.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 p-4 rounded border border-indigo-200 dark:border-indigo-800 text-center",children:[e.jsx("label",{className:"block text-xs font-bold text-indigo-500 uppercase mb-1",children:"CÃ³digo de Acesso"}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("code",{className:"text-3xl font-mono font-bold text-indigo-700 dark:text-indigo-300 tracking-wider select-all",children:we.code}),e.jsx("button",{onClick:()=>ye(we.code),className:"p-1.5 text-indigo-600 hover:text-indigo-800 dark:text-indigo-400 dark:hover:text-indigo-200 transition-colors",title:"Copiar cÃ³digo",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),e.jsx("div",{className:"h-6 w-px bg-indigo-200 dark:bg-indigo-700 mx-1"}),e.jsx("button",{onClick:()=>Be(we),className:"p-1.5 text-indigo-600 hover:text-indigo-800 dark:text-indigo-400 dark:hover:text-indigo-200 transition-colors",title:"Compartilhar Link",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})})})]})]})]}),e.jsx("button",{onClick:de,className:"w-full bg-primary hover:bg-indigo-700 text-white font-bold py-3 rounded-lg shadow-md transition-colors",children:"Confirmar"})]})}),e.jsx(me,{isOpen:j.type==="TEAM_INPUT",onClose:de,title:"CÃ³digo de Acesso",children:e.jsxs("div",{className:"space-y-6 pt-2",children:[e.jsxs("p",{className:"text-gray-600 dark:text-gray-300",children:["Digite o cÃ³digo fornecido pelo capitÃ£o da equipe ",e.jsx("strong",{children:De==null?void 0:De.name}),"."]}),e.jsx(ce,{label:"CÃ³digo da Equipe",placeholder:"Ex: A1B2",value:k,onChange:b=>I(b.target.value.toUpperCase()),className:"text-center font-mono text-xl tracking-widest uppercase",autoFocus:!0}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:de,className:"px-4 py-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:"Cancelar"}),e.jsx("button",{onClick:jt,className:"px-6 py-2 bg-primary text-white rounded font-bold hover:bg-indigo-700",children:"Verificar"})]})]})}),e.jsx(me,{isOpen:j.type==="TEAM_CONFIRM",onClose:de,title:"Confirmar Entrada",children:ue&&r&&e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-100 dark:border-blue-900/30",children:[e.jsx("h4",{className:"font-bold text-blue-900 dark:text-blue-300 mb-2 border-b border-blue-200 dark:border-blue-800 pb-2",children:"Dados da Equipe"}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700 dark:text-blue-400",children:"Nome:"}),e.jsx("span",{className:"font-medium dark:text-gray-200",children:ue.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700 dark:text-blue-400",children:"CapitÃ£o:"}),e.jsx("span",{className:"font-medium dark:text-gray-200",children:((He=xe[ue.captainId])==null?void 0:He.name)||"..."})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700 dark:text-blue-400",children:"Turma do CapitÃ£o:"}),e.jsx("span",{className:"font-medium dark:text-gray-200",children:Le((Je=xe[ue.captainId])==null?void 0:Je.classId)})]})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("h4",{className:"font-bold text-gray-700 dark:text-gray-300 mb-2 border-b border-gray-200 dark:border-gray-600 pb-2",children:"Seus Dados (Entrando como Membro)"}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Nome:"}),e.jsx("span",{className:"font-medium dark:text-white",children:r.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"RM:"}),e.jsx("span",{className:"font-medium dark:text-white",children:r.rm})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Turma:"}),e.jsx("span",{className:"font-medium dark:text-white",children:Le(r.classId)})]})]})]}),e.jsxs("div",{className:"text-center py-2",children:[e.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase",children:"CÃ³digo Verificado"}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"font-mono font-bold text-xl text-green-600 dark:text-green-400",children:ue.code}),e.jsx("button",{onClick:()=>ye(ue.code),className:"p-1 text-gray-500 hover:text-green-600 dark:text-gray-400 dark:hover:text-green-400 transition-colors",title:"Copiar cÃ³digo",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{onClick:de,className:"flex-1 py-3 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-600 dark:text-gray-300 font-bold hover:bg-gray-50 dark:hover:bg-gray-700",children:"Cancelar"}),e.jsx(ie,{onClick:vt,isLoading:Ae,className:"flex-1 py-3 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow",children:"Confirmar Entrada"})]})]})}),e.jsx(qe,{isOpen:!!w,onClose:()=>A(null),onConfirm:()=>w&&_(w),title:"Cancelar InscriÃ§Ã£o",message:"Tem certeza que deseja cancelar sua inscriÃ§Ã£o? A vaga serÃ¡ liberada imediatamente.",confirmText:"Sim, Cancelar",isProcessing:U})]})},Ss=(o,t,s,a)=>{const r=new Tt({orientation:"landscape",unit:"mm",format:"a4"}),n=r.internal.pageSize.getWidth(),i=r.internal.pageSize.getHeight(),d="#4F46E5",c="#1F2937";r.setDrawColor(d),r.setLineWidth(1.5),r.rect(10,10,n-20,i-20),r.setLineWidth(.5),r.rect(13,13,n-26,i-26),r.setFillColor(d),r.triangle(10,10,40,10,10,40,"F"),r.triangle(n-10,i-10,n-40,i-10,n-10,i-40,"F");const l=n/2,m=40;r.setFillColor(d),r.circle(l,m,12,"F"),r.setTextColor(255,255,255),r.setFont("helvetica","bold"),r.setFontSize(18),r.text("E",l,m+2,{align:"center",baseline:"middle"}),r.setTextColor(d),r.setFont("helvetica","bold"),r.setFontSize(36),r.text("CERTIFICADO DE PARTICIPAÃ‡ÃƒO",l,m+30,{align:"center"}),r.setLineWidth(.5),r.setDrawColor(200,200,200),r.line(l-80,m+35,l+80,m+35);const x=m+55;r.setTextColor(c),r.setFont("helvetica","normal"),r.setFontSize(16),r.text("Certificamos que",l,x,{align:"center"}),r.setFont("helvetica","bold"),r.setFontSize(28),r.setTextColor(d),r.text(o.name||"Aluno(a)",l,x+15,{align:"center"}),r.setFont("helvetica","normal"),r.setFontSize(16),r.setTextColor(c);const u=X(s.date),g=s.startTime.split(":").map(Number),y=s.endTime.split(":").map(Number);let v=0;if(!isNaN(g[0])&&!isNaN(y[0])){const S=g[0]*60+(g[1]||0);v=(y[0]*60+(y[1]||0)-S)/60}v=Math.max(1,Math.round(v));const E=[`participou com Ãªxito do evento "${t.name}"`,`realizado em ${t.location}, no dia ${u}.`,`Carga horÃ¡ria total estimada: ${v} hora(s).`];let w=x+35;E.forEach(S=>{r.text(S,l,w,{align:"center",maxWidth:220}),w+=10});const A=i-50;r.setLineWidth(.5),r.setDrawColor(0,0,0),r.line(60,A,120,A),r.setFontSize(10),r.text("CoordenaÃ§Ã£o EduEvent",90,A+5,{align:"center"}),r.line(n-120,A,n-60,A),r.text("Diretoria AcadÃªmica",n-90,A+5,{align:"center"});const j=i-15;r.setFontSize(8),r.setTextColor(100,100,100);const N=new Date().toLocaleDateString("pt-BR");r.text(`Certificado emitido em: ${N}`,20,j),r.setFont("courier","normal"),r.text(`CÃ³digo de VerificaÃ§Ã£o: ${a}`,n-20,j,{align:"right"});const k=(o.name||"aluno").replace(/[^a-z0-9]/gi,"_").toLowerCase(),I=t.name.replace(/[^a-z0-9]/gi,"_").toLowerCase().substring(0,20),T=`certificado_${k}_${I}.pdf`;r.save(T)},Is=()=>{const{user:o}=re(),{addToast:t}=ve(),[s,a]=p.useState([]),[r,n]=p.useState(null),[i,d]=p.useState(!0),[c,l]=p.useState(!1),[m,x]=p.useState(null),[u,g]=p.useState(null),y=async()=>{if(o){d(!0);try{const N=await R.getEnrollmentsForUser(o.uid);if(N.length===0){a([]),d(!1);return}const k=[...new Set(N.map(L=>L.eventId))],I=await R.getEventsByIds(k),T=new Map(I.map(L=>[L.id,L])),S=I.filter(L=>L.isTeamEvent),M=new Map;await Promise.all(S.map(async L=>{try{(await R.getTeamsForEvent(L.id)).forEach(U=>M.set(U.id,U))}catch(_){console.error(`Error loading teams for event ${L.id}`,_)}}));const $=N.map(L=>{const _=T.get(L.eventId);if(!_)return null;const U=_.sessions.find(Te=>Te.id===L.sessionId);if(!U)return null;const ae=L.teamId?M.get(L.teamId):void 0;return{enrollment:L,event:_,session:U,team:ae}}).filter(L=>L!==null);a($)}catch(N){console.error("Failed to load enrollments data:",N),t("error","Falha ao carregar inscriÃ§Ãµes."),a([])}finally{d(!1)}}};p.useEffect(()=>{y()},[o]);const v=async()=>{if(r){l(!0);try{await R.cancelEnrollment(r),t("success","InscriÃ§Ã£o cancelada com sucesso.")}catch(N){console.error(N),t("error","Erro ao cancelar inscriÃ§Ã£o.")}finally{n(null),l(!1),y()}}},E=async N=>{try{await navigator.clipboard.writeText(N),t("success","CÃ³digo copiado!")}catch{}},w=(N,k,I)=>{o&&g({enrollmentId:N.id,event:k,sessionDate:I.date,sessionTime:`${I.startTime} - ${I.endTime}`,user:o,attended:N.attended})},A=async(N,k,I)=>{if(o){x(N.id);try{await new Promise(T=>setTimeout(T,50)),Ss(o,k,I,N.id),t("success","Certificado gerado com sucesso!")}catch(T){console.error(T),t("error","Erro ao gerar certificado.")}finally{x(null)}}},j=new Date().toISOString().split("T")[0];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Minha Agenda"}),i?e.jsx("div",{className:"bg-white dark:bg-darkcard shadow overflow-hidden sm:rounded-md border border-gray-200 dark:border-gray-700",children:e.jsx("ul",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:Array.from({length:3}).map((N,k)=>e.jsx(hs,{},k))})}):s.length===0?e.jsx(mt,{title:"Agenda Vazia",description:"VocÃª ainda nÃ£o se inscreveu em nenhum evento."}):e.jsx("div",{className:"bg-white dark:bg-darkcard shadow overflow-hidden sm:rounded-md border border-gray-200 dark:border-gray-700",children:e.jsx("ul",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:s.map(({enrollment:N,event:k,session:I,team:T})=>{const S=I.date<j,M=S&&N.attended;return e.jsxs("li",{className:"px-6 py-4 flex flex-col sm:flex-row sm:items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 gap-4 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[k.isTeamEvent&&e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-[10px] font-bold bg-indigo-100 text-indigo-800 dark:bg-indigo-900/40 dark:text-indigo-300 uppercase tracking-wide border border-indigo-200 dark:border-indigo-800",children:"ðŸ›¡ï¸ Equipe"}),N.attended&&e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-[10px] font-bold bg-green-100 text-green-800 dark:bg-green-900/40 dark:text-green-300 uppercase tracking-wide border border-green-200 dark:border-green-800",children:"âœ… PresenÃ§a"}),e.jsx("h3",{className:"text-lg font-medium text-primary dark:text-indigo-400",children:k.name})]}),e.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1 flex flex-wrap gap-x-4 gap-y-1",children:[e.jsxs("span",{children:["ðŸ“… ",X(I.date)]}),e.jsxs("span",{children:["â° ",I.startTime," - ",I.endTime]}),e.jsxs("span",{children:["ðŸ“ ",k.location]})]}),T&&e.jsxs("div",{className:"mt-3 flex flex-col sm:flex-row sm:items-center items-start gap-3 p-3 bg-indigo-50 dark:bg-indigo-900/10 rounded-lg border border-indigo-100 dark:border-indigo-800/30 w-full sm:w-fit",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-200 dark:bg-indigo-800 flex items-center justify-center text-lg flex-shrink-0",children:"ðŸ›¡ï¸"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-bold text-gray-500 dark:text-gray-400 uppercase",children:"Sua Equipe"}),e.jsx("div",{className:"text-sm font-bold text-gray-900 dark:text-white",children:T.name})]})]}),e.jsxs("div",{className:"flex items-center gap-2 pl-0 sm:pl-3 border-t sm:border-t-0 sm:border-l border-indigo-200 dark:border-indigo-700 pt-2 sm:pt-0 w-full sm:w-auto",children:[e.jsx("div",{className:"text-xs font-bold text-gray-500 dark:text-gray-400 uppercase mr-2 sm:mr-0",children:"CÃ³digo:"}),e.jsxs("button",{onClick:()=>E(T.code),className:"text-xs font-mono font-bold text-indigo-600 dark:text-indigo-300 hover:underline flex items-center gap-1",title:"Copiar CÃ³digo",children:[T.code," ðŸ“‹"]})]})]}),S&&!M&&e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 mt-2",children:"Evento Finalizado (Sem PresenÃ§a)"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 flex-shrink-0",children:[M?e.jsx("button",{onClick:()=>A(N,k,I),disabled:m===N.id,className:"w-full sm:w-auto text-sm px-4 py-2 rounded-lg transition border font-bold bg-amber-100 text-amber-800 border-amber-200 dark:bg-amber-900/40 dark:text-amber-300 dark:border-amber-800 hover:bg-amber-200 dark:hover:bg-amber-900/60 flex items-center justify-center gap-2 disabled:opacity-70 disabled:cursor-wait",children:m===N.id?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Gerando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-base",children:"ðŸ…"})," Baixar Certificado"]})}):e.jsxs("button",{onClick:()=>w(N,k,I),className:"w-full sm:w-auto text-sm px-4 py-2 rounded-lg transition border font-medium bg-white dark:bg-darkcard border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-800 flex items-center justify-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4h2v-4zM6 8v4M6 16v4m12-16H6a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2z"})}),"Ver Ticket"]}),!M&&e.jsx("button",{onClick:()=>n(N.id),disabled:S||N.attended,className:`w-full sm:w-auto text-sm px-4 py-2 rounded-lg transition border font-medium
                                                ${S||N.attended?"bg-gray-100 dark:bg-gray-800 text-gray-400 dark:text-gray-500 border-gray-200 dark:border-gray-700 cursor-not-allowed hidden sm:block":"text-red-600 dark:text-red-400 hover:text-white hover:bg-red-600 dark:hover:bg-red-500 border-red-200 dark:border-red-900/30"}`,children:S?"ConcluÃ­do":N.attended?"PresenÃ§a Confirmada":k.isTeamEvent?"Sair da Equipe":"Cancelar InscriÃ§Ã£o"})]})]},N.id)})})}),e.jsx(qe,{isOpen:!!r,onClose:()=>n(null),onConfirm:v,title:"Cancelar InscriÃ§Ã£o",message:"Tem certeza que deseja cancelar sua inscriÃ§Ã£o neste evento? Se for um evento de equipe, vocÃª sairÃ¡ do grupo e a vaga poderÃ¡ ser perdida.",confirmText:"Sim, Cancelar",cancelText:"Manter InscriÃ§Ã£o",isProcessing:c}),e.jsx(me,{isOpen:!!u,onClose:()=>g(null),title:"Seu Ticket de Entrada",children:u&&e.jsxs("div",{className:"flex flex-col items-center justify-center p-4 space-y-6",children:[e.jsx("div",{className:`p-4 bg-white rounded-xl shadow-lg border-2 ${u.attended?"border-green-500":"border-gray-900"}`,children:e.jsx(Et,{value:u.enrollmentId,size:200})}),e.jsxs("div",{className:"text-center space-y-1",children:[u.attended?e.jsx("span",{className:"inline-block px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-bold uppercase mb-2",children:"âœ… Check-in Realizado"}):e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:"Apresente este cÃ³digo na entrada"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:u.event.name}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:[X(u.sessionDate)," â€¢ ",u.sessionTime]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:u.event.location})]}),e.jsxs("div",{className:"w-full border-t border-gray-200 dark:border-gray-700 pt-4 text-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:u.user.name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["RM: ",u.user.rm||"-"]}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-2 font-mono",children:u.enrollmentId})]})]})})]})},Cs=oe.lazy(()=>pe(()=>import("./AdminEvents-Bw-GMvbp.js"),__vite__mapDeps([0,1,2,3,4])).then(o=>({default:o.AdminEvents}))),Ts=oe.lazy(()=>pe(()=>import("./AdminUsers-DwpqqZNT.js"),__vite__mapDeps([5,1,2,3,4])).then(o=>({default:o.AdminUsers}))),As=oe.lazy(()=>pe(()=>import("./AdminCourses-BX24vh1W.js"),__vite__mapDeps([6,1,2,3,4])).then(o=>({default:o.AdminCourses}))),Ms=oe.lazy(()=>pe(()=>import("./AdminEventEnrollments-C9wNYpP0.js"),__vite__mapDeps([7,1,2,3,8,4])).then(o=>({default:o.AdminEventEnrollments}))),Ls=oe.lazy(()=>pe(()=>import("./AdminScanner-QTR-y27Q.js"),__vite__mapDeps([9,1,2,3,4])).then(o=>({default:o.AdminScanner}))),Ds=oe.lazy(()=>pe(()=>import("./DevTools-BhgqNFP9.js"),__vite__mapDeps([10,1,2,3,4])).then(o=>({default:o.DevTools}))),Rs=()=>e.jsx("div",{className:"h-full w-full flex items-center justify-center p-10",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}),Z=({children:o,roleRequired:t})=>{const{user:s,loading:a}=re(),r=_e();return a?e.jsx("div",{className:"h-screen flex items-center justify-center text-primary font-medium dark:bg-darkbg dark:text-gray-200",children:"Carregando EduEvent..."}):s?!s.isOnboarded&&window.location.hash!=="#/complete-profile"?e.jsx(Se,{to:"/complete-profile"}):t&&s.role!==t?e.jsx(Se,{to:"/dashboard"}):e.jsx(e.Fragment,{children:o}):e.jsx(Se,{to:"/login",state:{from:r},replace:!0})},Os=()=>{const{user:o}=re();return e.jsx(p.Suspense,{fallback:e.jsx(Rs,{}),children:e.jsxs(It,{children:[e.jsx(K,{path:"/",element:o?e.jsx(Se,{to:"/dashboard"}):e.jsx(ws,{})}),e.jsx(K,{path:"/special/:id",element:e.jsx(js,{})}),e.jsx(K,{path:"/login",element:e.jsx(ls,{})}),e.jsx(K,{path:"/complete-profile",element:e.jsx(Z,{children:e.jsx(cs,{})})}),e.jsx(K,{path:"/dashboard",element:e.jsx(Z,{children:e.jsx(te,{children:e.jsx(ys,{})})})}),e.jsx(K,{path:"/event/:id",element:e.jsx(Z,{children:e.jsx(te,{children:e.jsx(Es,{})})})}),e.jsx(K,{path:"/my-enrollments",element:e.jsx(Z,{children:e.jsx(te,{children:e.jsx(Is,{})})})}),e.jsx(K,{path:"/admin/events",element:e.jsx(Z,{roleRequired:H.ADMIN,children:e.jsx(te,{children:e.jsx(Cs,{})})})}),e.jsx(K,{path:"/admin/events/:id/enrollments",element:e.jsx(Z,{roleRequired:H.ADMIN,children:e.jsx(te,{children:e.jsx(Ms,{})})})}),e.jsx(K,{path:"/admin/courses",element:e.jsx(Z,{roleRequired:H.ADMIN,children:e.jsx(te,{children:e.jsx(As,{})})})}),e.jsx(K,{path:"/admin/users",element:e.jsx(Z,{roleRequired:H.ADMIN,children:e.jsx(te,{children:e.jsx(Ts,{})})})}),e.jsx(K,{path:"/admin/scanner",element:e.jsx(Z,{roleRequired:H.ADMIN,children:e.jsx(te,{children:e.jsx(Ls,{})})})}),e.jsx(K,{path:"/admin/dev",element:e.jsx(Z,{roleRequired:H.ADMIN,children:e.jsx(te,{children:e.jsx(Ds,{})})})})]})})};function Ps(){return e.jsx(as,{children:e.jsx(is,{children:e.jsx(ns,{children:e.jsx(St,{children:e.jsx(Os,{})})})})})}const xt=document.getElementById("root");if(!xt)throw new Error("Could not find root element to mount to");const $s=Ct.createRoot(xt);$s.render(e.jsx(oe.StrictMode,{children:e.jsx(Ps,{})}));export{qe as C,mt as E,ie as L,me as M,hs as S,H as U,us as a,re as b,zs as c,Bs as d,X as f,Ce as g,R as s,ve as u};
